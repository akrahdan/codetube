{"version":3,"sources":["portal/scenes/Instructor/Courses/Pricing/index.tsx"],"names":["CoursePricing","alert","useAlert","currencies","useFetchPricingCurrencyQuery","data","tiers","useFetchPricingTierQuery","useCreatePricingMutation","createPricing","useUpdatePricingMutation","updatePricing","locationPayload","useAppSelector","selectSections","selectLocationPayload","payload","useFetchSectionsQuery","id","pricing","useFetchPricingQuery","selectPricing","useState","toggleCurrency","setToggleCurrency","toggleTier","setToggleTier","name","display","currency","setCurrency","amount","setAmount","useEffect","className","data-purpose","data-name","style","verticalAlign","classNames","open","onClick","role","aria-haspopup","aria-expanded","type","paddingRight","position","right","aria-labelledby","map","curr","tabIndex","tier","index","course","then","res","show","disabled"],"mappings":"0PAiBaA,EAAgB,WAC3B,IAAMC,EAAQC,cACAC,EAAeC,cAArBC,KACMC,EAAUC,cAAhBF,KAHyB,EAITG,cAAjBC,EAJ0B,sBAKTC,cAAjBC,EAL0B,oBAO3BC,GADmBC,YAAeC,KAChBD,YAAeE,MAEjCC,GAD0BC,YAAsBL,EAAgBM,IAA9Db,KACQQ,YAAeE,MAEzBI,GADyBC,YAAqBJ,EAAQE,IAApDb,KACQQ,YAAeQ,MAXE,EAYWC,oBAAS,GAZpB,mBAY1BC,EAZ0B,KAYVC,EAZU,OAaGF,oBAAS,GAbZ,mBAa1BG,EAb0B,KAadC,EAbc,OAcDJ,mBAAS,CACvCK,KAAM,MACNC,QAAS,QAhBsB,mBAc1BC,EAd0B,KAchBC,EAdgB,OAkBLR,mBAAS,CACnCK,KAAM,MACNC,QAAS,QApBsB,mBAkB1BG,EAlB0B,KAkBlBC,EAlBkB,KAoCjC,OAbAC,qBAAU,WACJd,IACFW,EAAY,CACVH,KAAMR,EAAQU,SACdD,QAAST,EAAQU,WAGnBG,EAAU,CACRL,KAAMR,EAAQY,OACdH,QAAST,EAAQY,YAGpB,CAACZ,IAEF,gCACE,qBAAKe,UAAU,6BAAf,SACE,qBAAKA,UAAU,kCAAf,SACE,oBACEC,eAAa,aACbD,UAAU,iDAFZ,yBAQJ,qBAAKA,UAAU,sCAAf,SAEE,qBAAKC,eAAa,cAAlB,SACE,qBAAKD,UAAU,OAAf,SACE,gCACE,sBAAKE,YAAU,eAAf,UACE,oBAAIF,UAAU,aAAd,+BACA,sBAAKA,UAAU,YAAf,UACE,mBAAGC,eAAa,6DAAhB,kFAKA,sBAAMA,eAAa,kCAGvB,qBAAKD,UAAU,oBAAf,SACE,qBAAKA,UAAU,SAAf,SACE,sBAAKA,UAAU,OAAf,UACE,qBAAKA,UAAU,MAAMG,MAAO,CAAEC,cAAe,OAA7C,SACE,qBACEH,eAAa,eACbD,UAAU,+CAFZ,SAIE,sBAAKA,UAAU,KAAf,UACE,qBAAKA,UAAU,cAAf,SACE,sBACEA,UAAWK,IACT,uCACA,CACEC,KAAMjB,IAJZ,UAQE,yBACEkB,QAAS,kBACPjB,GAAmBD,IAErBL,GAAG,kBACHwB,KAAK,SACLC,gBAAc,OACdC,gBAAc,QACdC,KAAK,SACLX,UAAU,kCACVG,MAAO,CAAES,aAAc,QAVzB,UAYGjB,EAASD,QACV,sBACES,MAAO,CACLU,SAAU,WACVC,MAAO,QAHX,SAME,sBAAMd,UAAU,2CAGpB,oBACEQ,KAAK,OACLR,UAAU,gBACVe,kBAAgB,kBAHlB,SAKG9C,GACCA,EAAW+C,KAAI,SAACC,GAAD,OACb,oBAAoBT,KAAK,eAAzB,SACE,mBACED,QAAS,WACPX,EAAYqB,GACZ3B,GAAmBD,IAErBmB,KAAK,WACLU,UAAW,EANb,SASGD,EAAKvB,WAVDuB,EAAKxB,gBAiBxB,qBAAKO,UAAU,cAAf,SACE,sBACEA,UAAWK,IACT,uCACA,CACEC,KAAMf,IAJZ,UAQE,yBACEgB,QAAS,kBAAMf,GAAeD,IAC9BP,GAAG,gBACHwB,KAAK,SACLC,gBAAc,OACdC,gBAAc,QACdC,KAAK,SACLX,UAAU,kCACVG,MAAO,CAAES,aAAc,QARzB,UAUE,sBAAKZ,UAAU,MAAf,UACE,qBAAKA,UAAU,kDAAf,SACE,yCAAUL,EAASD,QAAnB,YAA8BG,EAAOH,aAFzC,UAIMC,EAASD,QAJf,YAI0BG,EAAOH,YAEjC,sBACES,MAAO,CACLU,SAAU,WACVC,MAAO,QAHX,SAME,sBAAMd,UAAU,2CAGpB,qBACEQ,KAAK,OACLR,UAAU,gBACVe,kBAAgB,gBAHlB,UAKE,oBAAIP,KAAK,eAAeR,UAAU,SAAlC,SACE,mBACEC,eAAa,iBACbO,KAAK,WACLU,UAAW,EAHb,sBASD9C,GACCA,EAAM4C,KAAI,SAACG,EAAMC,GAAP,OACR,oBAAoBZ,KAAK,eAAzB,SACE,oBACED,QAAS,WACPT,EAAUqB,GACV3B,GAAeD,IAEjBiB,KAAK,WACLU,UAAW,EANb,UAQGvB,EAASD,QARZ,IAQsByB,EAAKzB,QACzB,uBAAMM,UAAU,wBAAhB,mBACSoB,EAAQ,EADjB,WAVKD,EAAK1B,wBAsB9B,qBAAKO,UAAU,MAAf,SACE,wBACEO,QAAS,YACP,OAAItB,QAAJ,IAAIA,OAAJ,EAAIA,EAASY,QACXpB,EAAc,CACZ4C,OAAQvC,EAAQE,GAChBa,OAAQA,EAAOJ,KACfE,SAAUA,EAASF,OAClB6B,MAAK,SAACC,GAA4B,IAAD,GAClC,OAAIA,QAAJ,IAAIA,GAAJ,UAAIA,EAAKpD,YAAT,aAAI,EAAW0B,SACb9B,EAAMyD,KAAK,mCAKfjD,EAAc,CACZ8C,OAAQvC,EAAQE,GAChBa,OAAQA,EAAOJ,KACfE,SAAUA,EAASF,OAClB6B,MAAK,SAACC,GAA4B,IAAD,GAClC,OAAIA,QAAJ,IAAIA,GAAJ,UAAIA,EAAKpD,YAAT,aAAI,EAAW0B,SACb9B,EAAMyD,KAAK,oCAMnBC,UAAW9B,IAAaE,EACxBc,KAAK,SACLX,UAAU,8BA5BZ,wCA4CPlC","file":"static/js/31.a55f8ef5.chunk.js","sourcesContent":["import { useEffect, useState } from \"react\";\nimport { selectLocationPayload } from \"state/location/selectors\";\nimport { useAppSelector } from \"store/hooks\";\nimport { selectPricing } from \"state/course/courseSplice\";\nimport { selectSections } from \"state/curriculum/currriculumSplice\";\nimport { useAlert } from \"react-alert\";\nimport {\n  useFetchPricingCurrencyQuery,\n  useFetchPricingTierQuery,\n  useCreatePricingMutation,\n  useFetchPricingQuery,\n  useFetchSectionsQuery,\n  useUpdatePricingMutation,\n  Pricing\n} from \"services/courses\";\nimport classNames from \"classnames\";\n\nexport const CoursePricing = () => {\n  const alert = useAlert()\n  const { data: currencies } = useFetchPricingCurrencyQuery();\n  const { data: tiers } = useFetchPricingTierQuery();\n  const [createPricing] = useCreatePricingMutation();\n  const [updatePricing] = useUpdatePricingMutation();\n  const selectedSections = useAppSelector(selectSections)\n  const locationPayload = useAppSelector(selectLocationPayload)\n  const { data: querySections } = useFetchSectionsQuery(locationPayload.id)\n  const payload = useAppSelector(selectLocationPayload);\n  const { data: pricingQuery } = useFetchPricingQuery(payload.id);\n  const pricing = useAppSelector(selectPricing);\n  const [toggleCurrency, setToggleCurrency] = useState(false);\n  const [toggleTier, setToggleTier] = useState(false);\n  const [currency, setCurrency] = useState({\n    name: \"USD\",\n    display: \"USD\",\n  });\n  const [amount, setAmount] = useState({\n    name: '100',\n    display: \"100\",\n  });\n\n  useEffect(() => {\n    if (pricing) {\n      setCurrency({\n        name: pricing.currency,\n        display: pricing.currency,\n      });\n\n      setAmount({\n        name: pricing.amount,\n        display: pricing.amount,\n      });\n    }\n  }, [pricing]);\n  return (\n    <div>\n      <div className=\"sub-header--wrapper--3Vunm\">\n        <div className=\"sub-header--main-content--22it3\">\n          <h2\n            data-purpose=\"page-title\"\n            className=\"font-heading-serif-xl sub-header--title--2VD8q\"\n          >\n            Pricing\n          </h2>\n        </div>\n      </div>\n      <div className=\"main-content--wrap_component--2TEkz\">\n\n        <div data-purpose=\"price-route\">\n          <div className=\"mb30\">\n            <div>\n              <div data-name=\"owner-opt-in\">\n                <h4 className=\"blockLabel\">Course Price Tier</h4>\n                <div className=\"mb30 mt20\">\n                  <p data-purpose=\"safely-set-inner-html:price-form:link-to-price-tier-matrix\">\n                    Please select the price tier for your course below and click\n                    'Save'.\n                  </p>\n\n                  <span data-purpose=\"practice-course-message\" />\n                </div>\n              </div>\n              <div className=\"fx-jsb db-sm mt10\">\n                <div className=\"fx-jsb\">\n                  <div className=\"pr20\">\n                    <div className=\"dib\" style={{ verticalAlign: \"top\" }}>\n                      <div\n                        data-purpose=\"price-select\"\n                        className=\"price-select--price-select--3gmzG form-group\"\n                      >\n                        <div className=\"df\">\n                          <div className=\"fx-jsb mr20\">\n                            <div\n                              className={classNames(\n                                \"dropdown btn-group btn-group-default\",\n                                {\n                                  open: toggleCurrency,\n                                }\n                              )}\n                            >\n                              <button\n                                onClick={() =>\n                                  setToggleCurrency(!toggleCurrency)\n                                }\n                                id=\"select-currency\"\n                                role=\"button\"\n                                aria-haspopup=\"true\"\n                                aria-expanded=\"false\"\n                                type=\"button\"\n                                className=\"dropdown-toggle btn btn-default\"\n                                style={{ paddingRight: \"26px\" }}\n                              >\n                                {currency.display}\n                                <span\n                                  style={{\n                                    position: \"absolute\",\n                                    right: \"12px\",\n                                  }}\n                                >\n                                  <span className=\"dropdown-caret cfi cfi-angle-down\" />\n                                </span>\n                              </button>\n                              <ul\n                                role=\"menu\"\n                                className=\"dropdown-menu\"\n                                aria-labelledby=\"select-currency\"\n                              >\n                                {currencies &&\n                                  currencies.map((curr) => (\n                                    <li key={curr.name} role=\"presentation\">\n                                      <a\n                                        onClick={() => {\n                                          setCurrency(curr);\n                                          setToggleCurrency(!toggleCurrency);\n                                        }}\n                                        role=\"menuitem\"\n                                        tabIndex={-1}\n                                       \n                                      >\n                                        {curr.display}\n                                      </a>\n                                    </li>\n                                  ))}\n                              </ul>\n                            </div>\n                          </div>\n                          <div className=\"fx-jsb mr20\">\n                            <div\n                              className={classNames(\n                                \"dropdown btn-group btn-group-default\",\n                                {\n                                  open: toggleTier,\n                                }\n                              )}\n                            >\n                              <button\n                                onClick={() => setToggleTier(!toggleTier)}\n                                id=\"select-amount\"\n                                role=\"button\"\n                                aria-haspopup=\"true\"\n                                aria-expanded=\"false\"\n                                type=\"button\"\n                                className=\"dropdown-toggle btn btn-default\"\n                                style={{ paddingRight: \"26px\" }}\n                              >\n                                <div className=\"dib\">\n                                  <div className=\"price-select--price-select__title-spacer--3OZvO\">\n                                    <span>{`${currency.display} ${amount.display}`}</span>\n                                  </div>\n                                  {`${currency.display} ${amount.display}`}\n                                </div>\n                                <span\n                                  style={{\n                                    position: \"absolute\",\n                                    right: \"12px\",\n                                  }}\n                                >\n                                  <span className=\"dropdown-caret cfi cfi-angle-down\" />\n                                </span>\n                              </button>\n                              <ul\n                                role=\"menu\"\n                                className=\"dropdown-menu\"\n                                aria-labelledby=\"select-amount\"\n                              >\n                                <li role=\"presentation\" className=\"active\">\n                                  <a\n                                    data-purpose=\"select-amount-\"\n                                    role=\"menuitem\"\n                                    tabIndex={-1}\n                                 \n                                  >\n                                    Select\n                                  </a>\n                                </li>\n                                {tiers &&\n                                  tiers.map((tier, index) => (\n                                    <li key={tier.name} role=\"presentation\">\n                                      <a\n                                        onClick={() => {\n                                          setAmount(tier);\n                                          setToggleTier(!toggleTier);\n                                        }}\n                                        role=\"menuitem\"\n                                        tabIndex={-1}\n                                      >\n                                        {currency.display} {tier.display}\n                                        <span className=\"text-midnight-lighter\">\n                                          (tier {index + 1})\n                                        </span>\n                                      </a>\n                                    </li>\n                                  ))}\n                              </ul>\n                            </div>\n                          </div>\n                        </div>\n                      </div>\n                    </div>\n                    <div className=\"dib\">\n                      <button\n                        onClick={() => {\n                          if (pricing?.amount) {\n                            updatePricing({\n                              course: payload.id,\n                              amount: amount.name,\n                              currency: currency.name,\n                            }).then((res: { data: Pricing }) => {\n                              if (res?.data?.amount) {\n                                alert.show('Your changes have been saved')\n                              }\n                            })\n\n                          } else {\n                            createPricing({\n                              course: payload.id,\n                              amount: amount.name,\n                              currency: currency.name,\n                            }).then((res: { data: Pricing }) => {\n                              if (res?.data?.amount) {\n                                alert.show('Your changes have been saved')\n                              }\n                            });\n                          }\n\n                        }}\n                        disabled={!currency || !amount}\n                        type=\"submit\"\n                        className=\"btn btn-secondary btn-block\"\n                      >\n                        Save\n                      </button>\n                    </div>\n                  </div>\n                </div>\n              </div>\n            </div>\n          </div>\n        </div>\n      </div>\n    </div>\n  );\n};\n\nexport default CoursePricing;\n"],"sourceRoot":""}