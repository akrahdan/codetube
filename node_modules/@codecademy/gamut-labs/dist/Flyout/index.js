import _styled from "@emotion/styled/base";

function _extends() { _extends = Object.assign || function (target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i]; for (var key in source) { if (Object.prototype.hasOwnProperty.call(source, key)) { target[key] = source[key]; } } } return target; }; return _extends.apply(this, arguments); }

function _slicedToArray(arr, i) { return _arrayWithHoles(arr) || _iterableToArrayLimit(arr, i) || _unsupportedIterableToArray(arr, i) || _nonIterableRest(); }

function _nonIterableRest() { throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method."); }

function _unsupportedIterableToArray(o, minLen) { if (!o) return; if (typeof o === "string") return _arrayLikeToArray(o, minLen); var n = Object.prototype.toString.call(o).slice(8, -1); if (n === "Object" && o.constructor) n = o.constructor.name; if (n === "Map" || n === "Set") return Array.from(o); if (n === "Arguments" || /^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)) return _arrayLikeToArray(o, minLen); }

function _arrayLikeToArray(arr, len) { if (len == null || len > arr.length) len = arr.length; for (var i = 0, arr2 = new Array(len); i < len; i++) { arr2[i] = arr[i]; } return arr2; }

function _iterableToArrayLimit(arr, i) { if (typeof Symbol === "undefined" || !(Symbol.iterator in Object(arr))) return; var _arr = []; var _n = true; var _d = false; var _e = undefined; try { for (var _i = arr[Symbol.iterator](), _s; !(_n = (_s = _i.next()).done); _n = true) { _arr.push(_s.value); if (i && _arr.length === i) break; } } catch (err) { _d = true; _e = err; } finally { try { if (!_n && _i["return"] != null) _i["return"](); } finally { if (_d) throw _e; } } return _arr; }

function _arrayWithHoles(arr) { if (Array.isArray(arr)) return arr; }

function _objectWithoutProperties(source, excluded) { if (source == null) return {}; var target = _objectWithoutPropertiesLoose(source, excluded); var key, i; if (Object.getOwnPropertySymbols) { var sourceSymbolKeys = Object.getOwnPropertySymbols(source); for (i = 0; i < sourceSymbolKeys.length; i++) { key = sourceSymbolKeys[i]; if (excluded.indexOf(key) >= 0) continue; if (!Object.prototype.propertyIsEnumerable.call(source, key)) continue; target[key] = source[key]; } } return target; }

function _objectWithoutPropertiesLoose(source, excluded) { if (source == null) return {}; var target = {}; var sourceKeys = Object.keys(source); var key, i; for (i = 0; i < sourceKeys.length; i++) { key = sourceKeys[i]; if (excluded.indexOf(key) >= 0) continue; target[key] = source[key]; } return target; }

import { BodyPortal, FocusTrap, IconButton } from '@codecademy/gamut';
import { MiniDeleteIcon } from '@codecademy/gamut-icons';
import { system, variant } from '@codecademy/gamut-styles';
import { variance } from '@codecademy/variance';
import { AnimatePresence, motion } from 'framer-motion';
import React, { useCallback, useEffect, useState } from 'react';
export var transitionDuration = 0.35;
var flyoutStyles = variance.compose(system.background, system.border, system.flex, system.grid, system.layout, system.positioning);
var flyoutOpenVariants = variant({
  defaultVariant: 'left',
  prop: 'openFrom',
  variants: {
    left: {
      right: 'auto',
      left: 0
    },
    right: {
      right: 0,
      left: 'auto'
    }
  }
});
export var DrawerBase = /*#__PURE__*/_styled(motion.div, {
  target: "e6yjhop0",
  label: "DrawerBase"
})(flyoutStyles, flyoutOpenVariants, process.env.NODE_ENV === "production" ? "" : "/*# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi4uLy4uL3NyYy9GbHlvdXQvaW5kZXgudHN4Il0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiJBQXNDMEIiLCJmaWxlIjoiLi4vLi4vc3JjL0ZseW91dC9pbmRleC50c3giLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgeyBCb2R5UG9ydGFsLCBGb2N1c1RyYXAsIEljb25CdXR0b24gfSBmcm9tICdAY29kZWNhZGVteS9nYW11dCc7XG5pbXBvcnQgeyBNaW5pRGVsZXRlSWNvbiB9IGZyb20gJ0Bjb2RlY2FkZW15L2dhbXV0LWljb25zJztcbmltcG9ydCB7IHN5c3RlbSwgdmFyaWFudCB9IGZyb20gJ0Bjb2RlY2FkZW15L2dhbXV0LXN0eWxlcyc7XG5pbXBvcnQgeyBTdHlsZVByb3BzLCB2YXJpYW5jZSB9IGZyb20gJ0Bjb2RlY2FkZW15L3ZhcmlhbmNlJztcbmltcG9ydCBzdHlsZWQgZnJvbSAnQGVtb3Rpb24vc3R5bGVkJztcbmltcG9ydCB7IEFuaW1hdGVQcmVzZW5jZSwgbW90aW9uIH0gZnJvbSAnZnJhbWVyLW1vdGlvbic7XG5pbXBvcnQgUmVhY3QsIHsgdXNlQ2FsbGJhY2ssIHVzZUVmZmVjdCwgdXNlU3RhdGUgfSBmcm9tICdyZWFjdCc7XG5cbmV4cG9ydCBjb25zdCB0cmFuc2l0aW9uRHVyYXRpb24gPSAwLjM1O1xuXG5jb25zdCBmbHlvdXRTdHlsZXMgPSB2YXJpYW5jZS5jb21wb3NlKFxuICBzeXN0ZW0uYmFja2dyb3VuZCxcbiAgc3lzdGVtLmJvcmRlcixcbiAgc3lzdGVtLmZsZXgsXG4gIHN5c3RlbS5ncmlkLFxuICBzeXN0ZW0ubGF5b3V0LFxuICBzeXN0ZW0ucG9zaXRpb25pbmdcbik7XG5cbmNvbnN0IGZseW91dE9wZW5WYXJpYW50cyA9IHZhcmlhbnQoe1xuICBkZWZhdWx0VmFyaWFudDogJ2xlZnQnLFxuICBwcm9wOiAnb3BlbkZyb20nLFxuICB2YXJpYW50czoge1xuICAgIGxlZnQ6IHtcbiAgICAgIHJpZ2h0OiAnYXV0bycsXG4gICAgICBsZWZ0OiAwLFxuICAgIH0sXG4gICAgcmlnaHQ6IHtcbiAgICAgIHJpZ2h0OiAwLFxuICAgICAgbGVmdDogJ2F1dG8nLFxuICAgIH0sXG4gIH0sXG59KTtcblxuZXhwb3J0IHR5cGUgRmx5b3V0U3R5bGVzID0gU3R5bGVQcm9wczx0eXBlb2YgZmx5b3V0U3R5bGVzPiAmXG4gIFN0eWxlUHJvcHM8dHlwZW9mIGZseW91dE9wZW5WYXJpYW50cz47XG5leHBvcnQgaW50ZXJmYWNlIEZseW91dFN0eWxlUHJvcHMgZXh0ZW5kcyBGbHlvdXRTdHlsZXMge31cblxuZXhwb3J0IGNvbnN0IERyYXdlckJhc2UgPSBzdHlsZWQobW90aW9uLmRpdik8Rmx5b3V0U3R5bGVQcm9wcz4oXG4gIGZseW91dFN0eWxlcyxcbiAgZmx5b3V0T3BlblZhcmlhbnRzXG4pO1xuXG50eXBlIEZseW91dFByb3BzID0gRmx5b3V0U3R5bGVQcm9wcyAmIHtcbiAgLyoqXG4gICAqIGlmIHRoZSBkcmF3ZXIgc2hvdWxkIGJlIG9wZW4gb3IgY2xvc2VkXG4gICAqL1xuICBpbml0aWFsRXhwYW5kZWQ/OiBib29sZWFuO1xuICAvKipcbiAgICogd2lkdGggb2YgdGhlIG9wZW4gZHJhd2VyIGluIHJlbVxuICAgKi9cbiAgb3BlbldpZHRoPzogbnVtYmVyO1xuICAvKipcbiAgICogdG9nZ2xlcyB0aGUgRmx5b3V0XG4gICAqL1xuICByZW5kZXJCdXR0b246IChvbkNsaWNrOiAoKSA9PiB2b2lkKSA9PiBSZWFjdC5SZWFjdE5vZGU7XG4gIC8qKlxuICAgKiBXaGV0aGVyIGNsaWNraW5nIG9uIHRoZSBzY3JlZW4gb3V0c2lkZSBvZiB0aGUgY29udGFpbmVyIHNob3VsZCBjbG9zZSB0aGUgRmx5b3V0XG4gICAqL1xuICBjbGlja091dHNpZGVEb2VzTm90Q2xvc2U/OiBib29sZWFuO1xuICAvKipcbiAgICogV2hldGhlciBjbGlja2luZyB0aGUgZXNjYXBlIGtleSBzaG91bGQgY2xvc2UgdGhlIEZseW91dFxuICAgKi9cbiAgZXNjYXBlRG9lc05vdENsb3NlPzogYm9vbGVhbjtcblxuICAvKipcbiAgICogQSBtZWFucyBvZiB0aGUgcGFyZW50IG1ldGhvZCB0byBnZXQgYSByZWZlcmVuY2UgdG8gdGhlIGNsb3NlRmx5b3V0IGZ1bmN0aW9uXG4gICAqL1xuICBjbG9zZUZseW91dFJlZj86IFJlYWN0Lk11dGFibGVSZWZPYmplY3Q8RnVuY3Rpb24+O1xufTtcblxuZXhwb3J0IGNvbnN0IEZseW91dDogUmVhY3QuRkM8Rmx5b3V0UHJvcHM+ID0gKHtcbiAgY2hpbGRyZW4sXG4gIHJlbmRlckJ1dHRvbixcbiAgaW5pdGlhbEV4cGFuZGVkLFxuICBvcGVuRnJvbSA9ICdsZWZ0JyxcbiAgb3BlbldpZHRoID0gMzAsXG4gIGNsaWNrT3V0c2lkZURvZXNOb3RDbG9zZSxcbiAgZXNjYXBlRG9lc05vdENsb3NlLFxuICBjbG9zZUZseW91dFJlZixcbiAgLi4uc3R5bGVQcm9wc1xufSkgPT4ge1xuICBjb25zdCBpbml0aWFsWCA9IG9wZW5Gcm9tID09PSAnbGVmdCcgPyAtMTAwMCA6IDEwMDA7XG5cbiAgY29uc3QgW2lzRXhwYW5kZWQsIHNldElzRXhwYW5kZWRdID0gdXNlU3RhdGUoISFpbml0aWFsRXhwYW5kZWQpO1xuICBjb25zdCB0b2dnbGVFeHBhbmRlZCA9IHVzZUNhbGxiYWNrKFxuICAgICgpID0+IHNldElzRXhwYW5kZWQoKGlzRXhwYW5kZWQpID0+ICFpc0V4cGFuZGVkKSxcbiAgICBbXVxuICApO1xuICBjb25zdCBjbG9zZUZseW91dCA9IHVzZUNhbGxiYWNrKCgpID0+IHtcbiAgICBzZXRJc0V4cGFuZGVkKGZhbHNlKTtcbiAgfSwgW10pO1xuXG4gIHVzZUVmZmVjdCgoKSA9PiB7XG4gICAgLy8gUGFzc2VzIHRoZSBmdW5jdGlvbiB1cCB0byBhbnkgaW50ZXJlc3RlZCBwYXJlbnQgY29tcG9uZW50XG4gICAgaWYgKGNsb3NlRmx5b3V0UmVmKSB7XG4gICAgICBjbG9zZUZseW91dFJlZi5jdXJyZW50ID0gY2xvc2VGbHlvdXQ7XG4gICAgICByZXR1cm4gKCkgPT4ge1xuICAgICAgICBjbG9zZUZseW91dFJlZi5jdXJyZW50ID0gKCkgPT4ge307XG4gICAgICB9O1xuICAgIH1cbiAgfSwgW2Nsb3NlRmx5b3V0UmVmLCBjbG9zZUZseW91dF0pO1xuXG4gIGNvbnN0IGhhbmRsZU91dHNpZGVDbGljayA9IHVzZUNhbGxiYWNrKCgpID0+IHtcbiAgICAhY2xpY2tPdXRzaWRlRG9lc05vdENsb3NlICYmIGNsb3NlRmx5b3V0KCk7XG4gIH0sIFtjbGlja091dHNpZGVEb2VzTm90Q2xvc2UsIGNsb3NlRmx5b3V0XSk7XG5cbiAgY29uc3QgaGFuZGxlRXNjYXBlS2V5ID0gdXNlQ2FsbGJhY2soKCkgPT4ge1xuICAgICFlc2NhcGVEb2VzTm90Q2xvc2UgJiYgY2xvc2VGbHlvdXQoKTtcbiAgfSwgW2VzY2FwZURvZXNOb3RDbG9zZSwgY2xvc2VGbHlvdXRdKTtcblxuICByZXR1cm4gKFxuICAgIDw+XG4gICAgICA8QW5pbWF0ZVByZXNlbmNlPlxuICAgICAgICB7aXNFeHBhbmRlZCA/IChcbiAgICAgICAgICA8Qm9keVBvcnRhbD5cbiAgICAgICAgICAgIDxGb2N1c1RyYXBcbiAgICAgICAgICAgICAgb25DbGlja091dHNpZGU9e2hhbmRsZU91dHNpZGVDbGlja31cbiAgICAgICAgICAgICAgb25Fc2NhcGVLZXk9e2hhbmRsZUVzY2FwZUtleX1cbiAgICAgICAgICAgID5cbiAgICAgICAgICAgICAgPERyYXdlckJhc2VcbiAgICAgICAgICAgICAgICBhcmlhLWV4cGFuZGVkPXtpc0V4cGFuZGVkfVxuICAgICAgICAgICAgICAgIGluaXRpYWw9e3sgeDogaW5pdGlhbFggfX1cbiAgICAgICAgICAgICAgICBhbmltYXRlPXt7IHg6IDAgfX1cbiAgICAgICAgICAgICAgICBleGl0PXt7IHg6IGluaXRpYWxYIH19XG4gICAgICAgICAgICAgICAgdHJhbnNpdGlvbj17eyBkdXJhdGlvbjogdHJhbnNpdGlvbkR1cmF0aW9uIH19XG4gICAgICAgICAgICAgICAgd2lkdGg9e3sgXzogJzc1JScsIHNtOiBgJHtvcGVuV2lkdGh9cmVtYCB9fVxuICAgICAgICAgICAgICAgIG1heFdpZHRoPXtgJHtvcGVuV2lkdGh9cmVtYH1cbiAgICAgICAgICAgICAgICBvcGVuRnJvbT17b3BlbkZyb219XG4gICAgICAgICAgICAgICAgcG9zaXRpb249XCJmaXhlZFwiXG4gICAgICAgICAgICAgICAgYm90dG9tPVwiMFwiXG4gICAgICAgICAgICAgICAgdG9wPVwiMFwiXG4gICAgICAgICAgICAgICAgey4uLnN0eWxlUHJvcHN9XG4gICAgICAgICAgICAgID5cbiAgICAgICAgICAgICAgICA8SWNvbkJ1dHRvblxuICAgICAgICAgICAgICAgICAgaWNvbj17TWluaURlbGV0ZUljb259XG4gICAgICAgICAgICAgICAgICBvbkNsaWNrPXt0b2dnbGVFeHBhbmRlZH1cbiAgICAgICAgICAgICAgICAgIHBvc2l0aW9uPVwiYWJzb2x1dGVcIlxuICAgICAgICAgICAgICAgICAgdG9wPVwiMC41cmVtXCJcbiAgICAgICAgICAgICAgICAgIHJpZ2h0PVwiMC41cmVtXCJcbiAgICAgICAgICAgICAgICAvPlxuICAgICAgICAgICAgICAgIHtjaGlsZHJlbn1cbiAgICAgICAgICAgICAgPC9EcmF3ZXJCYXNlPlxuICAgICAgICAgICAgPC9Gb2N1c1RyYXA+XG4gICAgICAgICAgPC9Cb2R5UG9ydGFsPlxuICAgICAgICApIDogbnVsbH1cbiAgICAgIDwvQW5pbWF0ZVByZXNlbmNlPlxuICAgICAge3JlbmRlckJ1dHRvbih0b2dnbGVFeHBhbmRlZCl9XG4gICAgPC8+XG4gICk7XG59O1xuIl19 */");
export var Flyout = function Flyout(_ref) {
  var children = _ref.children,
      renderButton = _ref.renderButton,
      initialExpanded = _ref.initialExpanded,
      _ref$openFrom = _ref.openFrom,
      openFrom = _ref$openFrom === void 0 ? 'left' : _ref$openFrom,
      _ref$openWidth = _ref.openWidth,
      openWidth = _ref$openWidth === void 0 ? 30 : _ref$openWidth,
      clickOutsideDoesNotClose = _ref.clickOutsideDoesNotClose,
      escapeDoesNotClose = _ref.escapeDoesNotClose,
      closeFlyoutRef = _ref.closeFlyoutRef,
      styleProps = _objectWithoutProperties(_ref, ["children", "renderButton", "initialExpanded", "openFrom", "openWidth", "clickOutsideDoesNotClose", "escapeDoesNotClose", "closeFlyoutRef"]);

  var initialX = openFrom === 'left' ? -1000 : 1000;

  var _useState = useState(!!initialExpanded),
      _useState2 = _slicedToArray(_useState, 2),
      isExpanded = _useState2[0],
      setIsExpanded = _useState2[1];

  var toggleExpanded = useCallback(function () {
    return setIsExpanded(function (isExpanded) {
      return !isExpanded;
    });
  }, []);
  var closeFlyout = useCallback(function () {
    setIsExpanded(false);
  }, []);
  useEffect(function () {
    // Passes the function up to any interested parent component
    if (closeFlyoutRef) {
      closeFlyoutRef.current = closeFlyout;
      return function () {
        closeFlyoutRef.current = function () {};
      };
    }
  }, [closeFlyoutRef, closeFlyout]);
  var handleOutsideClick = useCallback(function () {
    !clickOutsideDoesNotClose && closeFlyout();
  }, [clickOutsideDoesNotClose, closeFlyout]);
  var handleEscapeKey = useCallback(function () {
    !escapeDoesNotClose && closeFlyout();
  }, [escapeDoesNotClose, closeFlyout]);
  return /*#__PURE__*/React.createElement(React.Fragment, null, /*#__PURE__*/React.createElement(AnimatePresence, null, isExpanded ? /*#__PURE__*/React.createElement(BodyPortal, null, /*#__PURE__*/React.createElement(FocusTrap, {
    onClickOutside: handleOutsideClick,
    onEscapeKey: handleEscapeKey
  }, /*#__PURE__*/React.createElement(DrawerBase, _extends({
    "aria-expanded": isExpanded,
    initial: {
      x: initialX
    },
    animate: {
      x: 0
    },
    exit: {
      x: initialX
    },
    transition: {
      duration: transitionDuration
    },
    width: {
      _: '75%',
      sm: "".concat(openWidth, "rem")
    },
    maxWidth: "".concat(openWidth, "rem"),
    openFrom: openFrom,
    position: "fixed",
    bottom: "0",
    top: "0"
  }, styleProps), /*#__PURE__*/React.createElement(IconButton, {
    icon: MiniDeleteIcon,
    onClick: toggleExpanded,
    position: "absolute",
    top: "0.5rem",
    right: "0.5rem"
  }), children))) : null), renderButton(toggleExpanded));
};