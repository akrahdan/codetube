{"ast":null,"code":"import _objectSpread from\"/Users/akrah/Documents/dev/readux/src/codefluent/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/objectSpread2\";import _slicedToArray from\"/Users/akrah/Documents/dev/readux/src/codefluent/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/slicedToArray\";import React,{useCallback,useMemo,useState}from'react';import isHotkey from'is-hotkey';import{Editable,withReact,useSlate,Slate}from'slate-react';import{jsx}from'slate-hyperscript';import{Editor,Text,Transforms,createEditor,Element as SlateElement}from'slate';import{withHistory}from'slate-history';import escapeHtml from'escape-html';import{Button,Icon,Toolbar}from'./components';import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";var HOTKEYS={'mod+b':'bold','mod+i':'italic','mod+u':'underline','mod+`':'code'};var LIST_TYPES=['numbered-list','bulleted-list','list-item'];export var RTEditor=function RTEditor(_ref){var handleChange=_ref.handleChange,editorValue=_ref.editorValue;var html=editorValue?new DOMParser().parseFromString(editorValue,'text/html'):'';var initEditValue=html?deserialize(html.body):initialValue;var _useState=useState(initEditValue),_useState2=_slicedToArray(_useState,2),value=_useState2[0],setValue=_useState2[1];var renderElement=useCallback(function(props){return/*#__PURE__*/_jsx(Element,_objectSpread({},props));},[]);var renderLeaf=useCallback(function(props){return/*#__PURE__*/_jsx(Leaf,_objectSpread({},props));},[]);var editor=useMemo(function(){return withHistory(withReact(createEditor()));},[]);return/*#__PURE__*/_jsxs(Slate,{editor:editor,value:value,onChange:function onChange(value){setValue(value);var result=value.map(serialize).join('\\n');handleChange(result);},children:[/*#__PURE__*/_jsx(Toolbar,{className:\"rt-menu-bar-container\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"rt-menu-bar fx-lt\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"btn-group\",children:[/*#__PURE__*/_jsx(MarkButton,{className:\"cfi cfi-bold\",format:\"bold\"}),/*#__PURE__*/_jsx(MarkButton,{className:\"cfi cfi-italic\",format:\"italic\"}),/*#__PURE__*/_jsx(BlockButton,{format:\"numbered-list\",className:\"cfi cfi-list-ol\"}),/*#__PURE__*/_jsx(BlockButton,{format:\"bulleted-list\",className:\"cfi cfi-list-ul\"})]}),/*#__PURE__*/_jsx(\"div\",{className:\"fx\"}),/*#__PURE__*/_jsx(\"div\",{className:\"btn-group\"})]})}),/*#__PURE__*/_jsx(\"div\",{className:\"rt-editor rt-editor--empty rt-editor--wysiwyg-mode \",children:/*#__PURE__*/_jsx(Editable,{className:\"ProseMirror\",renderElement:renderElement,renderLeaf:renderLeaf,placeholder:\"Insert description here\",spellCheck:true,autoFocus:true,onKeyDown:function onKeyDown(event){for(var hotkey in HOTKEYS){if(isHotkey(hotkey,event)){event.preventDefault();var mark=HOTKEYS[hotkey];toggleMark(editor,mark);}}}})})]});};var toggleBlock=function toggleBlock(editor,format){var isActive=isBlockActive(editor,format);var isList=LIST_TYPES.includes(format);Transforms.unwrapNodes(editor,{match:function match(n){return LIST_TYPES.includes(!Editor.isEditor(n)&&SlateElement.isElement(n)&&n.type);},split:true});var newProperties={type:isActive?'paragraph':isList?'list-item':format};Transforms.setNodes(editor,newProperties);if(!isActive&&isList){var block={type:format,children:[]};Transforms.wrapNodes(editor,block);}};var toggleMark=function toggleMark(editor,format){var isActive=isMarkActive(editor,format);if(isActive){Editor.removeMark(editor,format);}else{Editor.addMark(editor,format,true);}};var isBlockActive=function isBlockActive(editor,format){var _Editor$nodes=Editor.nodes(editor,{match:function match(n){return!Editor.isEditor(n)&&SlateElement.isElement(n)&&n.type===format;}}),_Editor$nodes2=_slicedToArray(_Editor$nodes,1),match=_Editor$nodes2[0];return!!match;};var isMarkActive=function isMarkActive(editor,format){var marks=Editor.marks(editor);return marks?marks[format]===true:false;};var Element=function Element(_ref2){var attributes=_ref2.attributes,children=_ref2.children,element=_ref2.element;switch(element.type){case'bulleted-list':return/*#__PURE__*/_jsx(\"ul\",_objectSpread(_objectSpread({},attributes),{},{children:children}));case'list-item':return/*#__PURE__*/_jsx(\"li\",_objectSpread(_objectSpread({},attributes),{},{children:children}));case'numbered-list':return/*#__PURE__*/_jsx(\"ol\",_objectSpread(_objectSpread({},attributes),{},{children:children}));default:return/*#__PURE__*/_jsx(\"p\",_objectSpread(_objectSpread({},attributes),{},{children:children}));}};var Leaf=function Leaf(_ref3){var attributes=_ref3.attributes,children=_ref3.children,leaf=_ref3.leaf;if(leaf.bold){children=/*#__PURE__*/_jsx(\"strong\",{children:children});}if(leaf.code){children=/*#__PURE__*/_jsx(\"code\",{children:children});}if(leaf.italic){children=/*#__PURE__*/_jsx(\"em\",{children:children});}if(leaf.underline){children=/*#__PURE__*/_jsx(\"u\",{children:children});}return/*#__PURE__*/_jsx(\"span\",_objectSpread(_objectSpread({},attributes),{},{children:children}));};var BlockButton=function BlockButton(_ref4){var format=_ref4.format,className=_ref4.className;var editor=useSlate();return/*#__PURE__*/_jsx(Button,{className:\"btn btn-link\",active:isBlockActive(editor,format),onMouseDown:function onMouseDown(event){event.preventDefault();toggleBlock(editor,format);},children:/*#__PURE__*/_jsx(Icon,{className:className})});};var MarkButton=function MarkButton(_ref5){var format=_ref5.format,className=_ref5.className;var editor=useSlate();return/*#__PURE__*/_jsx(Button,{className:\"btn btn-link\",active:isMarkActive(editor,format),onMouseDown:function onMouseDown(event){event.preventDefault();toggleMark(editor,format);},children:/*#__PURE__*/_jsx(Icon,{className:className})});};var initialValue=[{type:'paragraph',children:[{text:''}]}];var serialize=function serialize(node){if(Text.isText(node)){var string=escapeHtml(node.text);if(node.bold){string=\"<strong>\".concat(string,\"</strong>\");}if(node.italic){string=\"<em>\".concat(string,\"</em>\");}return string;}var children=node.children.map(function(n){return serialize(n);}).join('');switch(node.type){case'quote':return\"<blockquote><p>\".concat(children,\"</p></blockquote>\");case'paragraph':return\"<p>\".concat(children,\"</p>\");case'bulleted-list':return\"<ul>\".concat(children,\"</ul>\");case'list-item':return\"<li>\".concat(children,\"</li>\");case'numbered-list':return\"<ol>\".concat(children,\"</ol>\");case'link':return\"<a href=\\\"\".concat(escapeHtml(node.url),\"\\\">\").concat(children,\"</a>\");default:return children;}};var deserialize=function deserialize(el){if(el.nodeType===3){return el.textContent;}else if(el.nodeType!==1){return null;}var children=Array.from(el.childNodes).map(deserialize);if(children.length===0){children=[{text:''}];}switch(el.nodeName){case'BODY':return jsx('fragment',{},children);case'BR':return'\\n';case'BLOCKQUOTE':return jsx('element',{type:'quote'},children);case'P':return jsx('element',{type:'paragraph'},children);case'UL':return jsx('element',{type:'bulleted-list'},children);case'OL':return jsx('element',{type:'numbered-list'},children);case'LI':return jsx('element',{type:'list-item'},children);case'A':return jsx('element',{type:'link',url:el.getAttribute('href')},children);default:return el.textContent;}};export default RTEditor;","map":{"version":3,"sources":["/Users/akrah/Documents/dev/readux/src/codefluent/src/portal/scenes/Instructor/Editor/index.tsx"],"names":["React","useCallback","useMemo","useState","isHotkey","Editable","withReact","useSlate","Slate","jsx","Editor","Text","Transforms","createEditor","Element","SlateElement","withHistory","escapeHtml","Button","Icon","Toolbar","HOTKEYS","LIST_TYPES","RTEditor","handleChange","editorValue","html","DOMParser","parseFromString","initEditValue","deserialize","body","initialValue","value","setValue","renderElement","props","renderLeaf","editor","result","map","serialize","join","event","hotkey","preventDefault","mark","toggleMark","toggleBlock","format","isActive","isBlockActive","isList","includes","unwrapNodes","match","n","isEditor","isElement","type","split","newProperties","setNodes","block","children","wrapNodes","isMarkActive","removeMark","addMark","nodes","marks","attributes","element","Leaf","leaf","bold","code","italic","underline","BlockButton","className","MarkButton","text","node","isText","string","url","el","nodeType","textContent","Array","from","childNodes","length","nodeName","getAttribute"],"mappings":"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","sourcesContent":["import React, { useCallback, useMemo, useState } from 'react'\nimport isHotkey from 'is-hotkey'\nimport { Editable, withReact, useSlate, Slate } from 'slate-react'\nimport { jsx } from 'slate-hyperscript'\nimport {\n  Editor,\n  Text,\n  Transforms,\n  createEditor,\n  Descendant,\n  Node,\n  Element as SlateElement,\n} from 'slate'\nimport { withHistory } from 'slate-history'\nimport escapeHtml from 'escape-html'\nimport { Button, Icon, Toolbar } from './components'\n\nconst HOTKEYS = {\n  'mod+b': 'bold',\n  'mod+i': 'italic',\n  'mod+u': 'underline',\n  'mod+`': 'code',\n}\n\nconst LIST_TYPES = ['numbered-list', 'bulleted-list', 'list-item']\n\nexport const RTEditor = ({ handleChange, editorValue }) => {\n  const html = editorValue ? new DOMParser().parseFromString(editorValue, 'text/html') : ''\n  const initEditValue = html ? deserialize(html.body) : initialValue\n  const [value, setValue] = useState<Descendant[]>(initEditValue)\n  const renderElement = useCallback(props => <Element {...props} />, [])\n  const renderLeaf = useCallback(props => <Leaf {...props} />, [])\n  const editor = useMemo(() => withHistory(withReact(createEditor())), [])\n  \n  return (\n    <Slate editor={editor} value={value} onChange={value => {\n      setValue(value)\n      const result = value.map(serialize).join('\\n')\n      handleChange(result)\n    }}>\n      <Toolbar className=\"rt-menu-bar-container\">\n        <div className=\"rt-menu-bar fx-lt\">\n          <div className='btn-group'>\n            <MarkButton className=\"cfi cfi-bold\" format=\"bold\" />\n            <MarkButton className=\"cfi cfi-italic\" format=\"italic\" />\n            <BlockButton format=\"numbered-list\" className=\"cfi cfi-list-ol\" />\n            <BlockButton format=\"bulleted-list\" className=\"cfi cfi-list-ul\" />\n          </div>\n          <div className=\"fx\"></div>\n          <div className=\"btn-group\"></div>\n        </div>\n\n      </Toolbar>\n      <div className=\"rt-editor rt-editor--empty rt-editor--wysiwyg-mode \">\n        <Editable\n\n          className=\"ProseMirror\"\n          renderElement={renderElement}\n          renderLeaf={renderLeaf}\n          placeholder=\"Insert description here\"\n          spellCheck\n          autoFocus\n          onKeyDown={event => {\n            for (const hotkey in HOTKEYS) {\n              if (isHotkey(hotkey, event as any)) {\n                event.preventDefault()\n                const mark = HOTKEYS[hotkey]\n                toggleMark(editor, mark)\n              }\n            }\n          }}\n        />\n      </div>\n\n    </Slate>\n  )\n}\n\nconst toggleBlock = (editor, format) => {\n  const isActive = isBlockActive(editor, format)\n  const isList = LIST_TYPES.includes(format)\n\n  Transforms.unwrapNodes(editor, {\n    match: n =>\n      LIST_TYPES.includes(\n        !Editor.isEditor(n) && SlateElement.isElement(n) && n.type\n      ),\n    split: true,\n  })\n  const newProperties: Partial<SlateElement> = {\n    type: isActive ? 'paragraph' : isList ? 'list-item' : format,\n  }\n  Transforms.setNodes(editor, newProperties)\n\n  if (!isActive && isList) {\n    const block = { type: format, children: [] }\n    Transforms.wrapNodes(editor, block)\n  }\n}\n\nconst toggleMark = (editor, format) => {\n  const isActive = isMarkActive(editor, format)\n\n  if (isActive) {\n    Editor.removeMark(editor, format)\n  } else {\n    Editor.addMark(editor, format, true)\n  }\n}\n\nconst isBlockActive = (editor, format) => {\n  const [match] = Editor.nodes(editor, {\n    match: n =>\n      !Editor.isEditor(n) && SlateElement.isElement(n) && n.type === format,\n  })\n\n  return !!match\n}\n\nconst isMarkActive = (editor, format) => {\n  const marks = Editor.marks(editor)\n  return marks ? marks[format] === true : false\n}\n\n\n\nconst Element = ({ attributes, children, element }) => {\n  switch (element.type) {\n\n    case 'bulleted-list':\n      return <ul {...attributes}>{children}</ul>\n\n    case 'list-item':\n      return <li {...attributes}>{children}</li>\n    case 'numbered-list':\n      return <ol {...attributes}>{children}</ol>\n    default:\n      return <p {...attributes}>{children}</p>\n  }\n}\n\nconst Leaf = ({ attributes, children, leaf }) => {\n  if (leaf.bold) {\n    children = <strong>{children}</strong>\n  }\n\n  if (leaf.code) {\n    children = <code>{children}</code>\n  }\n\n  if (leaf.italic) {\n    children = <em>{children}</em>\n  }\n\n  if (leaf.underline) {\n    children = <u>{children}</u>\n  }\n\n  return <span {...attributes}>{children}</span>\n}\n\nconst BlockButton = ({ format, className }) => {\n  const editor = useSlate()\n  return (\n    <Button\n      className='btn btn-link'\n      active={isBlockActive(editor, format)}\n      onMouseDown={event => {\n        event.preventDefault()\n        toggleBlock(editor, format)\n      }}\n    >\n      <Icon className={className}></Icon>\n    </Button>\n  )\n}\n\nconst MarkButton = ({ format, className }) => {\n  const editor = useSlate()\n  return (\n    <Button\n      className=\"btn btn-link\"\n      active={isMarkActive(editor, format)}\n      onMouseDown={event => {\n        event.preventDefault()\n        toggleMark(editor, format)\n      }}\n    >\n      <Icon className={className}></Icon>\n    </Button>\n  )\n}\n\nconst initialValue: Descendant[] = [\n  {\n    type: 'paragraph',\n    children: [\n      { text: '' },\n\n\n    ],\n  },\n\n]\n\n\nconst serialize = (node) => {\n  if (Text.isText(node)) {\n    let string = escapeHtml(node.text)\n    if (node.bold) {\n      string = `<strong>${string}</strong>`\n    }\n    if (node.italic) {\n      string = `<em>${string}</em>`\n    }\n    return string\n  }\n\n  const children = node.children.map(n => serialize(n)).join('')\n\n  switch (node.type) {\n    case 'quote':\n      return `<blockquote><p>${children}</p></blockquote>`\n    case 'paragraph':\n      return `<p>${children}</p>`\n    case 'bulleted-list':\n      return `<ul>${children}</ul>`\n    case 'list-item':\n      return `<li>${children}</li>`\n    case 'numbered-list':\n      return `<ol>${children}</ol>`\n\n    case 'link':\n      return `<a href=\"${escapeHtml(node.url)}\">${children}</a>`\n    default:\n      return children\n  }\n}\n\nconst deserialize = el => {\n  if (el.nodeType === 3) {\n    return el.textContent\n  } else if (el.nodeType !== 1) {\n    return null\n  }\n\n  let children = Array.from(el.childNodes).map(deserialize)\n\n  if (children.length === 0) {\n    children = [{ text: '' }]\n  }\n\n  switch (el.nodeName) {\n    case 'BODY':\n      return jsx('fragment', {}, children)\n    case 'BR':\n      return '\\n'\n    case 'BLOCKQUOTE':\n      return jsx('element', { type: 'quote' }, children)\n    case 'P':\n      return jsx('element', { type: 'paragraph' }, children)\n    case 'UL':\n      return jsx('element', { type: 'bulleted-list' }, children)\n    case 'OL':\n      return jsx('element', { type: 'numbered-list' }, children)\n    case 'LI':\n      return jsx('element', { type: 'list-item' }, children)\n    case 'A':\n      return jsx(\n        'element',\n        { type: 'link', url: el.getAttribute('href') },\n        children\n      )\n    default:\n      return el.textContent\n  }\n}\n\nexport default RTEditor"]},"metadata":{},"sourceType":"module"}