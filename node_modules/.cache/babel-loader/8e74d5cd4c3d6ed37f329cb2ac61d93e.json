{"ast":null,"code":"import _regeneratorRuntime from\"/Users/akrah/Documents/dev/readux/src/codefluent/node_modules/babel-preset-react-app/node_modules/@babel/runtime/regenerator\";import _objectSpread from\"/Users/akrah/Documents/dev/readux/src/codefluent/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/objectSpread2\";import _asyncToGenerator from\"/Users/akrah/Documents/dev/readux/src/codefluent/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";import _slicedToArray from\"/Users/akrah/Documents/dev/readux/src/codefluent/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/slicedToArray\";import classNames from\"classnames\";import{useEffect,useState}from\"react\";import{selectResources}from\"state/course/courseSplice\";import{useUploadLectureVideoMutation}from\"services/courses\";import moment from'moment';import{useAppSelector}from\"store/hooks\";import{selectLocationPayload}from\"state/location/selectors\";import*as client from'filestack-js';import{UploadProgress}from\"./UploadProgress\";import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";var filestack=client.Filestack(process.env.REACT_APP_FILESTACK_APP_KEY,{});var validateFileType=function validateFileType(fileItem){var fileType=fileItem.filetype;// image/png image/jpeg\nvar rootType=fileType.split(\"/\")[0];switch(rootType){case\"image\":return'File';default:return'Video';}};export var UploadVideo=function UploadVideo(_ref){var onSuccess=_ref.onSuccess,lecture=_ref.lecture;var _useState=useState(false),_useState2=_slicedToArray(_useState,2),active=_useState2[0],setActive=_useState2[1];var _useState3=useState(false),_useState4=_slicedToArray(_useState3,2),uploading=_useState4[0],setUploading=_useState4[1];var _useState5=useState(0),_useState6=_slicedToArray(_useState5,2),progress=_useState6[0],setProgress=_useState6[1];var _useState7=useState([]),_useState8=_slicedToArray(_useState7,2),mediaResources=_useState8[0],setMediaResources=_useState8[1];var _useState9=useState(null),_useState10=_slicedToArray(_useState9,2),error=_useState10[0],setError=_useState10[1];var _useState11=useState('Progress'),_useState12=_slicedToArray(_useState11,2),status=_useState12[0],setStatus=_useState12[1];var _useState13=useState(null),_useState14=_slicedToArray(_useState13,2),files=_useState14[0],setFiles=_useState14[1];var locationPayload=useAppSelector(selectLocationPayload);var resources=useAppSelector(selectResources);var _useUploadLectureVide=useUploadLectureVideoMutation(),_useUploadLectureVide2=_slicedToArray(_useUploadLectureVide,1),uploadLectureVideo=_useUploadLectureVide2[0];var onProgress=function onProgress(eve){console.log(eve.totalPercent);setProgress(eve.totalPercent);};var onUpload=function onUpload(files,_ref2){var onProgress=_ref2.onProgress;var obj={name:files.name,type:files.type};setMediaResources([obj]);setStatus('Progress');setUploading(true);filestack.upload(files,{onProgress:onProgress}).then(/*#__PURE__*/function(){var _ref3=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(res){var media,result,_obj;return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:if(res.status==\"Failed\"){setError('Your file upload failed');setStatus('Failed');}console.log(res);media={name:res.name,filetype:res.type,key:res.handle,size:res.size,course:locationPayload.id};_context.prev=3;_context.next=6;return uploadLectureVideo(media).unwrap();case 6:result=_context.sent;_obj=_objectSpread(_objectSpread({},result),{},{url:res.url});onSuccess(_obj);setStatus('Success');setUploading(false);_context.next=18;break;case 13:_context.prev=13;_context.t0=_context[\"catch\"](3);console.log('Error: ',_context.t0);setError(_context.t0);setStatus('Failed');case 18:case\"end\":return _context.stop();}}},_callee,null,[[3,13]]);}));return function(_x){return _ref3.apply(this,arguments);};}()).catch(function(err){console.log('Error: ',err);setError(err.status);setStatus('Failed');});};useEffect(function(){setError(null);setStatus(null);if(files){onUpload(files,{onProgress:onProgress});}},[files]);return/*#__PURE__*/_jsx(\"div\",{className:\"pl10 pr10 pb10\",children:/*#__PURE__*/_jsxs(\"div\",{id:\"media-asset-creator\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"nav-container\",children:/*#__PURE__*/_jsxs(\"ul\",{\"data-purpose\":\"video-asset-creator\",role:\"tablist\",className:\"nav nav-tabs\",children:[/*#__PURE__*/_jsx(\"li\",{role:\"presentation\",className:classNames({'active':!active}),children:/*#__PURE__*/_jsx(\"a\",{id:\"media-asset-creator-tab-1\",role:\"tab\",onClick:function onClick(){return setActive(!active);},\"aria-controls\":\"media-asset-creator-pane-1\",\"aria-selected\":\"true\",children:\"Upload Video\"})}),/*#__PURE__*/_jsx(\"li\",{role:\"presentation\",className:classNames({'active':active}),children:/*#__PURE__*/_jsx(\"a\",{id:\"media-asset-creator-tab-2\",role:\"tab\",onClick:function onClick(){return setActive(!active);},\"aria-controls\":\"media-asset-creator-pane-2\",\"aria-selected\":\"false\",tabIndex:-1,children:\"Add from library\"})})]})}),/*#__PURE__*/_jsxs(\"div\",{className:\"tab-content\",children:[/*#__PURE__*/_jsx(\"div\",{id:\"media-asset-creator-pane-1\",\"aria-labelledby\":\"media-asset-creator-tab-1\",role:\"tabpanel\",\"aria-hidden\":\"false\",className:classNames(\"tab-pane  fade in\",{'active':!active}),children:/*#__PURE__*/_jsx(\"div\",{children:uploading?/*#__PURE__*/_jsx(UploadProgress,{error:error,status:status,progress:progress,mediaResources:mediaResources,toggleUpload:function toggleUpload(){return setUploading(!uploading);}}):/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsxs(\"div\",{className:\"file-uploader--file-selector--SGCns\",\"data-purpose\":\"asset-uploader-input\",children:[/*#__PURE__*/_jsx(\"input\",{name:\"assert-\".concat(lecture.id),accept:\".avi,.mpg,.mpeg,.flv,.mov,.m2v,.m4v,.mp4,.rm,.ram,.vob,.ogv,.webm,.wmv\",type:\"file\",onChange:function onChange(event){return setFiles(event.target.files[0]);},id:\"file-upload-\".concat(lecture.id),className:\"sr-only\"}),/*#__PURE__*/_jsx(\"label\",{htmlFor:\"file-upload-\".concat(lecture.id),children:/*#__PURE__*/_jsxs(\"span\",{className:\"input-group\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"form-control file-uploader--fake-file-input--1_ohV\",children:\"No file selected\"}),/*#__PURE__*/_jsx(\"span\",{className:\"input-group-btn\",children:/*#__PURE__*/_jsx(\"div\",{className:\"btn btn-default\",children:\"Select Video\"})})]})})]}),/*#__PURE__*/_jsx(\"div\",{children:/*#__PURE__*/_jsxs(\"div\",{className:\"mt10 mb10\",\"data-purpose\":\"safely-set-inner-html:asset-uploader:note\",children:[/*#__PURE__*/_jsx(\"b\",{children:\"Note\"}),\": All files should be at least 720p and less than 4.0 GB.\"]})})]})})}),/*#__PURE__*/_jsx(\"div\",{id:\"media-asset-creator-pane-2\",\"aria-labelledby\":\"media-asset-creator-tab-2\",role:\"tabpanel\",\"aria-hidden\":\"true\",className:classNames(\"tab-pane  fade in\",{'active':active}),children:/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"form\",{children:/*#__PURE__*/_jsx(\"div\",{className:\"asset-library--search-box--2e_tN form-group form-group-sm\",children:/*#__PURE__*/_jsxs(\"span\",{className:\"input-group\",children:[/*#__PURE__*/_jsx(\"input\",{placeholder:\"Search files by name\",\"data-purpose\":\"search-box\",type:\"text\",className:\"form-control\"}),/*#__PURE__*/_jsx(\"span\",{className:\"input-group-btn\",children:/*#__PURE__*/_jsx(\"button\",{type:\"button\",className:\"btn btn-sm btn-secondary\",children:/*#__PURE__*/_jsx(\"span\",{className:\"cfi cfi-search\"})})})]})})}),/*#__PURE__*/_jsx(\"div\",{className:\"fx\",\"data-purpose\":\"asset-table\",children:/*#__PURE__*/_jsxs(\"table\",{className:\"v5-table-flat v5-table-flat--compress asset-table--asset-table--1FB3C data-table--sorting-table--Fr9kd\",children:[/*#__PURE__*/_jsxs(\"caption\",{className:\"sr-only\",children:[\"Library \",/*#__PURE__*/_jsx(\"br\",{}),\" Sort descending by Date\"]}),/*#__PURE__*/_jsx(\"thead\",{children:/*#__PURE__*/_jsxs(\"tr\",{children:[/*#__PURE__*/_jsxs(\"th\",{role:\"columnheader\",\"aria-sort\":\"none\",scope:\"col\",className:\"header\",children:[/*#__PURE__*/_jsx(\"span\",{className:\"sortable-header--header--2afzt\",children:\"Filename\"}),/*#__PURE__*/_jsxs(\"button\",{type:\"button\",className:\"btn btn-xs btn-tertiary\",children:[/*#__PURE__*/_jsx(\"span\",{className:\"cfi-small cfi cfi-sort\"}),/*#__PURE__*/_jsx(\"span\",{className:\"sr-only\",children:\"Sort ascending by Filename\"})]})]}),/*#__PURE__*/_jsx(\"th\",{role:\"columnheader\",\"aria-sort\":\"none\",scope:\"col\",className:\"header\",children:/*#__PURE__*/_jsx(\"span\",{className:\"sortable-header--header--2afzt\",children:\"Type\"})}),/*#__PURE__*/_jsx(\"th\",{role:\"columnheader\",\"aria-sort\":\"none\",scope:\"col\",className:\"header\",children:/*#__PURE__*/_jsx(\"span\",{className:\"sortable-header--header--2afzt\",children:\"Status\"})}),/*#__PURE__*/_jsxs(\"th\",{role:\"columnheader\",\"aria-sort\":\"descending\",scope:\"col\",className:\"header active\",children:[/*#__PURE__*/_jsx(\"span\",{className:\"sortable-header--header--2afzt\",children:\"Date\"}),/*#__PURE__*/_jsxs(\"button\",{type:\"button\",className:\"btn btn-xs btn-tertiary\",children:[/*#__PURE__*/_jsx(\"span\",{className:\"cfi-small cfi cfi-sort-desc\"}),/*#__PURE__*/_jsx(\"span\",{className:\"sr-only\",children:\"Sort ascending by Date\"})]})]}),/*#__PURE__*/_jsx(\"th\",{role:\"columnheader\",\"aria-sort\":\"none\",scope:\"col\",className:\"header\",children:/*#__PURE__*/_jsx(\"span\",{className:\"sortable-header--header--2afzt\"})})]})}),/*#__PURE__*/_jsx(\"tbody\",{children:resources&&resources.map(function(resource,index){if(validateFileType(resource)=='Video'){return/*#__PURE__*/_jsxs(\"tr\",{className:\"asset-table--asset-row--36BEz\",children:[/*#__PURE__*/_jsx(\"td\",{\"data-valign\":\"center\",children:/*#__PURE__*/_jsx(\"div\",{children:resource.name})}),/*#__PURE__*/_jsx(\"td\",{\"data-responsive-text\":\"Type\",\"data-valign\":\"center\",children:/*#__PURE__*/_jsx(\"div\",{children:validateFileType(resource)})}),/*#__PURE__*/_jsx(\"td\",{\"data-responsive-text\":\"Status\",\"data-valign\":\"center\",children:/*#__PURE__*/_jsx(\"div\",{className:\"text-success asset-table--asset-status--11R9h\",children:\"Success\"})}),/*#__PURE__*/_jsx(\"td\",{\"data-responsive-text\":\"Date\",\"data-valign\":\"center\",children:/*#__PURE__*/_jsx(\"div\",{children:moment(resource.timestamp).format(\"MM/DD/YYYY\")})}),/*#__PURE__*/_jsx(\"td\",{\"data-valign\":\"center\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"asset-table--action-buttons--3agUO\",children:[/*#__PURE__*/_jsx(\"button\",{onClick:function onClick(){onSuccess(resource);},type:\"button\",className:\"btn btn-xs btn-tertiary\",children:\"Select\"}),/*#__PURE__*/_jsx(\"button\",{type:\"button\",className:\"btn btn-xs btn-tertiary\",children:/*#__PURE__*/_jsx(\"span\",{className:\"cfi cfi-trash\"})})]})})]},index);}})})]})}),/*#__PURE__*/_jsx(\"div\",{className:\"pagination-container hidden\",\"data-purpose\":\"pagination-container\",children:/*#__PURE__*/_jsxs(\"ul\",{className:\"pager\",children:[/*#__PURE__*/_jsx(\"li\",{className:\"disabled previous\",children:/*#__PURE__*/_jsx(\"a\",{href:\"/instructor/course/4199184/manage/curriculum\",tabIndex:-1,style:{pointerEvents:\"none\"},children:/*#__PURE__*/_jsx(\"span\",{className:\"cfi cfi-previous\"})})}),/*#__PURE__*/_jsx(\"li\",{className:\"disabled next\",children:/*#__PURE__*/_jsx(\"a\",{href:\"/instructor/course/4199184/manage/curriculum?p=2\",tabIndex:-1,style:{pointerEvents:\"none\"},children:/*#__PURE__*/_jsx(\"span\",{className:\"cfi cfi-next\"})})})]})})]})})]})]})});};","map":{"version":3,"sources":["/Users/akrah/Documents/dev/readux/src/codefluent/src/portal/scenes/Instructor/Courses/Curriculum/Section/Lecture/UploadVideo.tsx"],"names":["classNames","useEffect","useState","selectResources","useUploadLectureVideoMutation","moment","useAppSelector","selectLocationPayload","client","UploadProgress","filestack","Filestack","process","env","REACT_APP_FILESTACK_APP_KEY","validateFileType","fileItem","fileType","filetype","rootType","split","UploadVideo","onSuccess","lecture","active","setActive","uploading","setUploading","progress","setProgress","mediaResources","setMediaResources","error","setError","status","setStatus","files","setFiles","locationPayload","resources","uploadLectureVideo","onProgress","eve","console","log","totalPercent","onUpload","obj","name","type","upload","then","res","media","key","handle","size","course","id","unwrap","result","url","catch","err","event","target","map","resource","index","timestamp","format","pointerEvents"],"mappings":"wpBAAA,MAAOA,CAAAA,UAAP,KAAuB,YAAvB,CACA,OAASC,SAAT,CAAoBC,QAApB,KAAoC,OAApC,CACA,OAASC,eAAT,KAAgC,2BAAhC,CACA,OAASC,6BAAT,KAA8C,kBAA9C,CACA,MAAOC,CAAAA,MAAP,KAAmB,QAAnB,CAEA,OAASC,cAAT,KAA+B,aAA/B,CACA,OAASC,qBAAT,KAAsC,0BAAtC,CACA,MAAO,GAAKC,CAAAA,MAAZ,KAAwB,cAAxB,CACA,OAASC,cAAT,KAA+B,kBAA/B,C,wFACA,GAAMC,CAAAA,SAAS,CAAGF,MAAM,CAACG,SAAP,CAAiBC,OAAO,CAACC,GAAR,CAAYC,2BAA7B,CAA0D,EAA1D,CAAlB,CAEA,GAAMC,CAAAA,gBAAgB,CAAG,QAAnBA,CAAAA,gBAAmB,CAACC,QAAD,CAAc,CACrC,GAAIC,CAAAA,QAAQ,CAAGD,QAAQ,CAACE,QAAxB,CAAkC;AAClC,GAAIC,CAAAA,QAAQ,CAAGF,QAAQ,CAACG,KAAT,CAAe,GAAf,EAAoB,CAApB,CAAf,CACA,OAAQD,QAAR,EACE,IAAK,OAAL,CACE,MAAO,MAAP,CACF,QACE,MAAO,OAAP,CAJJ,CAMD,CATD,CAUA,MAAO,IAAME,CAAAA,WAAW,CAAG,QAAdA,CAAAA,WAAc,MAA4B,IAAzBC,CAAAA,SAAyB,MAAzBA,SAAyB,CAAdC,OAAc,MAAdA,OAAc,eACzBrB,QAAQ,CAAC,KAAD,CADiB,wCAC9CsB,MAD8C,eACtCC,SADsC,8BAEnBvB,QAAQ,CAAC,KAAD,CAFW,yCAE9CwB,SAF8C,eAEnCC,YAFmC,8BAGrBzB,QAAQ,CAAC,CAAD,CAHa,yCAG9C0B,QAH8C,eAGpCC,WAHoC,8BAIT3B,QAAQ,CAAC,EAAD,CAJC,yCAI9C4B,cAJ8C,eAI9BC,iBAJ8B,8BAK3B7B,QAAQ,CAAC,IAAD,CALmB,0CAK9C8B,KAL8C,gBAKvCC,QALuC,gCAMzB/B,QAAQ,CAAC,UAAD,CANiB,2CAM9CgC,MAN8C,gBAMtCC,SANsC,gCAO3BjC,QAAQ,CAAC,IAAD,CAPmB,2CAO9CkC,KAP8C,gBAOvCC,QAPuC,gBAQrD,GAAMC,CAAAA,eAAe,CAAGhC,cAAc,CAACC,qBAAD,CAAtC,CACA,GAAMgC,CAAAA,SAAS,CAAGjC,cAAc,CAACH,eAAD,CAAhC,CATqD,0BAUxBC,6BAA6B,EAVL,gEAU9CoC,kBAV8C,2BAarD,GAAMC,CAAAA,UAAU,CAAG,QAAbA,CAAAA,UAAa,CAAAC,GAAG,CAAI,CACxBC,OAAO,CAACC,GAAR,CAAYF,GAAG,CAACG,YAAhB,EACAhB,WAAW,CAACa,GAAG,CAACG,YAAL,CAAX,CAED,CAJD,CAKA,GAAMC,CAAAA,QAAQ,CAAG,QAAXA,CAAAA,QAAW,CAACV,KAAD,OAA2B,IAAjBK,CAAAA,UAAiB,OAAjBA,UAAiB,CAC1C,GAAMM,CAAAA,GAAG,CAAG,CACVC,IAAI,CAAEZ,KAAK,CAACY,IADF,CAEVC,IAAI,CAAEb,KAAK,CAACa,IAFF,CAAZ,CAKAlB,iBAAiB,CAAC,CAACgB,GAAD,CAAD,CAAjB,CACAZ,SAAS,CAAC,UAAD,CAAT,CACAR,YAAY,CAAC,IAAD,CAAZ,CACAjB,SAAS,CAACwC,MAAV,CAAiBd,KAAjB,CAAwB,CAAEK,UAAU,CAAVA,UAAF,CAAxB,EACGU,IADH,2FACQ,iBAAOC,GAAP,wIACJ,GAAIA,GAAG,CAAClB,MAAJ,EAAc,QAAlB,CAA4B,CAC1BD,QAAQ,CAAC,yBAAD,CAAR,CACAE,SAAS,CAAC,QAAD,CAAT,CACD,CACDQ,OAAO,CAACC,GAAR,CAAYQ,GAAZ,EACMC,KANF,CAMU,CACZL,IAAI,CAAEI,GAAG,CAACJ,IADE,CAEZ9B,QAAQ,CAAEkC,GAAG,CAACH,IAFF,CAGZK,GAAG,CAAEF,GAAG,CAACG,MAHG,CAIZC,IAAI,CAAEJ,GAAG,CAACI,IAJE,CAKZC,MAAM,CAAEnB,eAAe,CAACoB,EALZ,CANV,uCAcmBlB,CAAAA,kBAAkB,CAACa,KAAD,CAAlB,CAA0BM,MAA1B,EAdnB,QAcIC,MAdJ,eAeIb,IAfJ,gCAeea,MAff,MAeuBC,GAAG,CAAET,GAAG,CAACS,GAfhC,GAgBFvC,SAAS,CAACyB,IAAD,CAAT,CACAZ,SAAS,CAAC,SAAD,CAAT,CACAR,YAAY,CAAC,KAAD,CAAZ,CAlBE,iFAoBFgB,OAAO,CAACC,GAAR,CAAY,SAAZ,cACAX,QAAQ,aAAR,CACAE,SAAS,CAAC,QAAD,CAAT,CAtBE,qEADR,iEA2BG2B,KA3BH,CA2BS,SAAAC,GAAG,CAAI,CACZpB,OAAO,CAACC,GAAR,CAAY,SAAZ,CAAuBmB,GAAvB,EACA9B,QAAQ,CAAC8B,GAAG,CAAC7B,MAAL,CAAR,CACAC,SAAS,CAAC,QAAD,CAAT,CACD,CA/BH,EAgCD,CAzCD,CA2CAlC,SAAS,CAAC,UAAM,CACdgC,QAAQ,CAAC,IAAD,CAAR,CACAE,SAAS,CAAC,IAAD,CAAT,CACA,GAAIC,KAAJ,CAAW,CACTU,QAAQ,CAACV,KAAD,CAAQ,CAAEK,UAAU,CAAVA,UAAF,CAAR,CAAR,CACD,CACF,CANQ,CAMN,CAACL,KAAD,CANM,CAAT,CAQA,mBACE,YAAK,SAAS,CAAC,gBAAf,uBACE,aAAK,EAAE,CAAC,qBAAR,wBACE,YAAK,SAAS,CAAC,eAAf,uBACE,YACE,eAAa,qBADf,CAEE,IAAI,CAAC,SAFP,CAGE,SAAS,CAAC,cAHZ,wBAKE,WAAI,IAAI,CAAC,cAAT,CAAwB,SAAS,CAAEpC,UAAU,CAAC,CAC5C,SAAU,CAACwB,MADiC,CAAD,CAA7C,uBAGE,UACE,EAAE,CAAC,2BADL,CAEE,IAAI,CAAC,KAFP,CAGE,OAAO,CAAE,yBAAMC,CAAAA,SAAS,CAAC,CAACD,MAAF,CAAf,EAHX,CAIE,gBAAc,4BAJhB,CAKE,gBAAc,MALhB,0BAHF,EALF,cAmBE,WAAI,IAAI,CAAC,cAAT,CAAwB,SAAS,CAAExB,UAAU,CAAC,CAC5C,SAAUwB,MADkC,CAAD,CAA7C,uBAGE,UACE,EAAE,CAAC,2BADL,CAEE,IAAI,CAAC,KAFP,CAGE,OAAO,CAAE,yBAAMC,CAAAA,SAAS,CAAC,CAACD,MAAF,CAAf,EAHX,CAIE,gBAAc,4BAJhB,CAKE,gBAAc,OALhB,CAOE,QAAQ,CAAE,CAAC,CAPb,8BAHF,EAnBF,GADF,EADF,cAsCE,aAAK,SAAS,CAAC,aAAf,wBACE,YACE,EAAE,CAAC,4BADL,CAEE,kBAAgB,2BAFlB,CAGE,IAAI,CAAC,UAHP,CAIE,cAAY,OAJd,CAKE,SAAS,CAAExB,UAAU,CAAC,mBAAD,CAAsB,CACzC,SAAU,CAACwB,MAD8B,CAAtB,CALvB,uBASE,qBACGE,SAAS,cAAG,KAAC,cAAD,EAAgB,KAAK,CAAEM,KAAvB,CAA8B,MAAM,CAAEE,MAAtC,CAA8C,QAAQ,CAAEN,QAAxD,CAAkE,cAAc,CAAEE,cAAlF,CAAkG,YAAY,CAAE,8BAAMH,CAAAA,YAAY,CAAC,CAACD,SAAF,CAAlB,EAAhH,EAAH,cAAyJ,oCACjK,aACE,SAAS,CAAC,qCADZ,CAEE,eAAa,sBAFf,wBAIE,cACE,IAAI,kBAAYH,OAAO,CAACmC,EAApB,CADN,CAEE,MAAM,CAAC,wEAFT,CAGE,IAAI,CAAC,MAHP,CAIE,QAAQ,CAAE,kBAAAM,KAAK,QAAI3B,CAAAA,QAAQ,CAAC2B,KAAK,CAACC,MAAN,CAAa7B,KAAb,CAAmB,CAAnB,CAAD,CAAZ,EAJjB,CAKE,EAAE,uBAAiBb,OAAO,CAACmC,EAAzB,CALJ,CAME,SAAS,CAAC,SANZ,EAJF,cAYE,cAAO,OAAO,uBAAiBnC,OAAO,CAACmC,EAAzB,CAAd,uBACE,cAAM,SAAS,CAAC,aAAhB,wBACE,YAAK,SAAS,CAAC,oDAAf,8BADF,cAIE,aAAM,SAAS,CAAC,iBAAhB,uBACE,YAAK,SAAS,CAAC,iBAAf,0BADF,EAJF,GADF,EAZF,GADiK,cA0BjK,kCACE,aACE,SAAS,CAAC,WADZ,CAEE,eAAa,2CAFf,wBAIE,2BAJF,+DADF,EA1BiK,GADrK,EATF,EADF,cAkDE,YACE,EAAE,CAAC,4BADL,CAEE,kBAAgB,2BAFlB,CAGE,IAAI,CAAC,UAHP,CAIE,cAAY,MAJd,CAKE,SAAS,CAAE1D,UAAU,CAAC,mBAAD,CAAsB,CACzC,SAAUwB,MAD+B,CAAtB,CALvB,uBASE,oCACE,mCACE,YAAK,SAAS,CAAC,2DAAf,uBACE,cAAM,SAAS,CAAC,aAAhB,wBACE,cACE,WAAW,CAAC,sBADd,CAEE,eAAa,YAFf,CAGE,IAAI,CAAC,MAHP,CAIE,SAAS,CAAC,cAJZ,EADF,cAOE,aAAM,SAAS,CAAC,iBAAhB,uBACE,eACE,IAAI,CAAC,QADP,CAEE,SAAS,CAAC,0BAFZ,uBAIE,aAAM,SAAS,CAAC,gBAAhB,EAJF,EADF,EAPF,GADF,EADF,EADF,cAqBE,YAAK,SAAS,CAAC,IAAf,CAAoB,eAAa,aAAjC,uBACE,eAAO,SAAS,CAAC,wGAAjB,wBACE,iBAAS,SAAS,CAAC,SAAnB,mCACU,aADV,8BADF,cAIE,oCACE,mCACE,YACE,IAAI,CAAC,cADP,CAEE,YAAU,MAFZ,CAGE,KAAK,CAAC,KAHR,CAIE,SAAS,CAAC,QAJZ,wBAME,aAAM,SAAS,CAAC,gCAAhB,sBANF,cASE,gBACE,IAAI,CAAC,QADP,CAEE,SAAS,CAAC,yBAFZ,wBAIE,aAAM,SAAS,CAAC,wBAAhB,EAJF,cAKE,aAAM,SAAS,CAAC,SAAhB,wCALF,GATF,GADF,cAoBE,WACE,IAAI,CAAC,cADP,CAEE,YAAU,MAFZ,CAGE,KAAK,CAAC,KAHR,CAIE,SAAS,CAAC,QAJZ,uBAME,aAAM,SAAS,CAAC,gCAAhB,kBANF,EApBF,cA8BE,WACE,IAAI,CAAC,cADP,CAEE,YAAU,MAFZ,CAGE,KAAK,CAAC,KAHR,CAIE,SAAS,CAAC,QAJZ,uBAME,aAAM,SAAS,CAAC,gCAAhB,oBANF,EA9BF,cAwCE,YACE,IAAI,CAAC,cADP,CAEE,YAAU,YAFZ,CAGE,KAAK,CAAC,KAHR,CAIE,SAAS,CAAC,eAJZ,wBAME,aAAM,SAAS,CAAC,gCAAhB,kBANF,cASE,gBACE,IAAI,CAAC,QADP,CAEE,SAAS,CAAC,yBAFZ,wBAIE,aAAM,SAAS,CAAC,6BAAhB,EAJF,cAKE,aAAM,SAAS,CAAC,SAAhB,oCALF,GATF,GAxCF,cA2DE,WACE,IAAI,CAAC,cADP,CAEE,YAAU,MAFZ,CAGE,KAAK,CAAC,KAHR,CAIE,SAAS,CAAC,QAJZ,uBAME,aAAM,SAAS,CAAC,gCAAhB,EANF,EA3DF,GADF,EAJF,cA0EE,uBACGe,SAAS,EAAIA,SAAS,CAAC2B,GAAV,CAAc,SAACC,QAAD,CAAWC,KAAX,CAAqB,CAC/C,GAAIrD,gBAAgB,CAACoD,QAAD,CAAhB,EAA8B,OAAlC,CAA2C,CACzC,mBACE,YAAgB,SAAS,CAAC,+BAA1B,wBACE,WAAI,cAAY,QAAhB,uBACE,qBAAMA,QAAQ,CAACnB,IAAf,EADF,EADF,cAIE,WAAI,uBAAqB,MAAzB,CAAgC,cAAY,QAA5C,uBACE,qBAAMjC,gBAAgB,CAACoD,QAAD,CAAtB,EADF,EAJF,cAOE,WAAI,uBAAqB,QAAzB,CAAkC,cAAY,QAA9C,uBACE,YAAK,SAAS,CAAC,+CAAf,qBADF,EAPF,cAYE,WAAI,uBAAqB,MAAzB,CAAgC,cAAY,QAA5C,uBACE,qBAAM9D,MAAM,CAAC8D,QAAQ,CAACE,SAAV,CAAN,CAA2BC,MAA3B,CAAkC,YAAlC,CAAN,EADF,EAZF,cAeE,WAAI,cAAY,QAAhB,uBACE,aAAK,SAAS,CAAC,oCAAf,wBACE,eACE,OAAO,CAAE,kBAAM,CACbhD,SAAS,CAAC6C,QAAD,CAAT,CAED,CAJH,CAOE,IAAI,CAAC,QAPP,CAQE,SAAS,CAAC,yBARZ,oBADF,cAaE,eAEE,IAAI,CAAC,QAFP,CAGE,SAAS,CAAC,yBAHZ,uBAKE,aAAM,SAAS,CAAC,eAAhB,EALF,EAbF,GADF,EAfF,GAASC,KAAT,CADF,CAyCD,CACF,CA5Ca,CADhB,EA1EF,GADF,EArBF,cAiJE,YACE,SAAS,CAAC,6BADZ,CAEE,eAAa,sBAFf,uBAIE,YAAI,SAAS,CAAC,OAAd,wBACE,WAAI,SAAS,CAAC,mBAAd,uBACE,UACE,IAAI,CAAC,8CADP,CAEE,QAAQ,CAAE,CAAC,CAFb,CAGE,KAAK,CAAE,CAAEG,aAAa,CAAE,MAAjB,CAHT,uBAKE,aAAM,SAAS,CAAC,kBAAhB,EALF,EADF,EADF,cAUE,WAAI,SAAS,CAAC,eAAd,uBACE,UACE,IAAI,CAAC,kDADP,CAEE,QAAQ,CAAE,CAAC,CAFb,CAGE,KAAK,CAAE,CAAEA,aAAa,CAAE,MAAjB,CAHT,uBAKE,aAAM,SAAS,CAAC,cAAhB,EALF,EADF,EAVF,GAJF,EAjJF,GATF,EAlDF,GAtCF,GADF,EADF,CAmRD,CAxVM","sourcesContent":["import classNames from \"classnames\";\nimport { useEffect, useState } from \"react\";\nimport { selectResources } from \"state/course/courseSplice\";\nimport { useUploadLectureVideoMutation } from \"services/courses\";\nimport moment from 'moment';\nimport type { MediaRequest, MediaResponse } from \"services/courses\";\nimport { useAppSelector } from \"store/hooks\";\nimport { selectLocationPayload } from \"state/location/selectors\";\nimport * as client from 'filestack-js';\nimport { UploadProgress } from \"./UploadProgress\";\nconst filestack = client.Filestack(process.env.REACT_APP_FILESTACK_APP_KEY, {})\n\nconst validateFileType = (fileItem) => {\n  var fileType = fileItem.filetype; // image/png image/jpeg\n  var rootType = fileType.split(\"/\")[0];\n  switch (rootType) {\n    case \"image\":\n      return 'File';\n    default:\n      return 'Video';\n  }\n}\nexport const UploadVideo = ({ onSuccess, lecture }) => {\n  const [active, setActive] = useState(false)\n  const [uploading, setUploading] = useState(false)\n  const [progress, setProgress] = useState(0)\n  const [mediaResources, setMediaResources] = useState([])\n  const [error, setError] = useState(null)\n  const [status, setStatus] = useState('Progress')\n  const [files, setFiles] = useState(null)\n  const locationPayload = useAppSelector(selectLocationPayload);\n  const resources = useAppSelector(selectResources)\n  const [uploadLectureVideo] = useUploadLectureVideoMutation()\n\n\n  const onProgress = eve => {\n    console.log(eve.totalPercent)\n    setProgress(eve.totalPercent)\n\n  }\n  const onUpload = (files, { onProgress }) => {\n    const obj = {\n      name: files.name,\n      type: files.type\n\n    }\n    setMediaResources([obj])\n    setStatus('Progress')\n    setUploading(true)\n    filestack.upload(files, { onProgress })\n      .then(async (res) => {\n        if (res.status == \"Failed\") {\n          setError('Your file upload failed')\n          setStatus('Failed')\n        }\n        console.log(res)\n        const media = {\n          name: res.name,\n          filetype: res.type,\n          key: res.handle,\n          size: res.size,\n          course: locationPayload.id\n        }\n        try {\n          const result = await uploadLectureVideo(media).unwrap();\n          const obj = { ...result, url: res.url }\n          onSuccess(obj)\n          setStatus('Success')\n          setUploading(false)\n        } catch (err) {\n          console.log('Error: ', err)\n          setError(err)\n          setStatus('Failed')\n\n        }\n      })\n      .catch(err => {\n        console.log('Error: ', err)\n        setError(err.status)\n        setStatus('Failed')\n      })\n  }\n\n  useEffect(() => {\n    setError(null)\n    setStatus(null)\n    if (files) {\n      onUpload(files, { onProgress })\n    }\n  }, [files])\n\n  return (\n    <div className=\"pl10 pr10 pb10\">\n      <div id=\"media-asset-creator\">\n        <div className=\"nav-container\">\n          <ul\n            data-purpose=\"video-asset-creator\"\n            role=\"tablist\"\n            className=\"nav nav-tabs\"\n          >\n            <li role=\"presentation\" className={classNames({\n              'active': !active\n            })}>\n              <a\n                id=\"media-asset-creator-tab-1\"\n                role=\"tab\"\n                onClick={() => setActive(!active)}\n                aria-controls=\"media-asset-creator-pane-1\"\n                aria-selected=\"true\"\n\n              >\n                Upload Video\n              </a>\n            </li>\n            <li role=\"presentation\" className={classNames({\n              'active': active\n            })}>\n              <a\n                id=\"media-asset-creator-tab-2\"\n                role=\"tab\"\n                onClick={() => setActive(!active)}\n                aria-controls=\"media-asset-creator-pane-2\"\n                aria-selected=\"false\"\n\n                tabIndex={-1}\n              >\n                Add from library\n              </a>\n            </li>\n          </ul>\n        </div>\n        <div className=\"tab-content\">\n          <div\n            id=\"media-asset-creator-pane-1\"\n            aria-labelledby=\"media-asset-creator-tab-1\"\n            role=\"tabpanel\"\n            aria-hidden=\"false\"\n            className={classNames(\"tab-pane  fade in\", {\n              'active': !active\n            })}\n          >\n            <div>\n              {uploading ? <UploadProgress error={error} status={status} progress={progress} mediaResources={mediaResources} toggleUpload={() => setUploading(!uploading)} /> : (<div>\n                <div\n                  className=\"file-uploader--file-selector--SGCns\"\n                  data-purpose=\"asset-uploader-input\"\n                >\n                  <input\n                    name={`assert-${lecture.id}`}\n                    accept=\".avi,.mpg,.mpeg,.flv,.mov,.m2v,.m4v,.mp4,.rm,.ram,.vob,.ogv,.webm,.wmv\"\n                    type=\"file\"\n                    onChange={event => setFiles(event.target.files[0])}\n                    id={`file-upload-${lecture.id}`}\n                    className=\"sr-only\"\n                  />\n                  <label htmlFor={`file-upload-${lecture.id}`}>\n                    <span className=\"input-group\">\n                      <div className=\"form-control file-uploader--fake-file-input--1_ohV\">\n                        No file selected\n                      </div>\n                      <span className=\"input-group-btn\">\n                        <div className=\"btn btn-default\">\n                          Select Video\n                        </div>\n                      </span>\n                    </span>\n                  </label>\n                </div>\n                <div>\n                  <div\n                    className=\"mt10 mb10\"\n                    data-purpose=\"safely-set-inner-html:asset-uploader:note\"\n                  >\n                    <b>Note</b>: All files should be at least 720p and less than\n                    4.0 GB.\n                  </div>\n                </div>\n              </div>)}\n\n            </div>\n          </div>\n          <div\n            id=\"media-asset-creator-pane-2\"\n            aria-labelledby=\"media-asset-creator-tab-2\"\n            role=\"tabpanel\"\n            aria-hidden=\"true\"\n            className={classNames(\"tab-pane  fade in\", {\n              'active': active\n            })}\n          >\n            <div>\n              <form >\n                <div className=\"asset-library--search-box--2e_tN form-group form-group-sm\">\n                  <span className=\"input-group\">\n                    <input\n                      placeholder=\"Search files by name\"\n                      data-purpose=\"search-box\"\n                      type=\"text\"\n                      className=\"form-control\"\n                    />\n                    <span className=\"input-group-btn\">\n                      <button\n                        type=\"button\"\n                        className=\"btn btn-sm btn-secondary\"\n                      >\n                        <span className=\"cfi cfi-search\" />\n                      </button>\n                    </span>\n                  </span>\n                </div>\n              </form>\n              <div className=\"fx\" data-purpose=\"asset-table\">\n                <table className=\"v5-table-flat v5-table-flat--compress asset-table--asset-table--1FB3C data-table--sorting-table--Fr9kd\">\n                  <caption className=\"sr-only\">\n                    Library <br /> Sort descending by Date\n                  </caption>\n                  <thead>\n                    <tr>\n                      <th\n                        role=\"columnheader\"\n                        aria-sort=\"none\"\n                        scope=\"col\"\n                        className=\"header\"\n                      >\n                        <span className=\"sortable-header--header--2afzt\">\n                          Filename\n                        </span>\n                        <button\n                          type=\"button\"\n                          className=\"btn btn-xs btn-tertiary\"\n                        >\n                          <span className=\"cfi-small cfi cfi-sort\" />\n                          <span className=\"sr-only\">\n                            Sort ascending by Filename\n                          </span>\n                        </button>\n                      </th>\n                      <th\n                        role=\"columnheader\"\n                        aria-sort=\"none\"\n                        scope=\"col\"\n                        className=\"header\"\n                      >\n                        <span className=\"sortable-header--header--2afzt\">\n                          Type\n                        </span>\n                      </th>\n                      <th\n                        role=\"columnheader\"\n                        aria-sort=\"none\"\n                        scope=\"col\"\n                        className=\"header\"\n                      >\n                        <span className=\"sortable-header--header--2afzt\">\n                          Status\n                        </span>\n                      </th>\n                      <th\n                        role=\"columnheader\"\n                        aria-sort=\"descending\"\n                        scope=\"col\"\n                        className=\"header active\"\n                      >\n                        <span className=\"sortable-header--header--2afzt\">\n                          Date\n                        </span>\n                        <button\n                          type=\"button\"\n                          className=\"btn btn-xs btn-tertiary\"\n                        >\n                          <span className=\"cfi-small cfi cfi-sort-desc\" />\n                          <span className=\"sr-only\">\n                            Sort ascending by Date\n                          </span>\n                        </button>\n                      </th>\n                      <th\n                        role=\"columnheader\"\n                        aria-sort=\"none\"\n                        scope=\"col\"\n                        className=\"header\"\n                      >\n                        <span className=\"sortable-header--header--2afzt\" />\n                      </th>\n                    </tr>\n                  </thead>\n                  <tbody>\n                    {resources && resources.map((resource, index) => {\n                      if (validateFileType(resource) == 'Video') {\n                        return (\n                          <tr key={index} className=\"asset-table--asset-row--36BEz\">\n                            <td data-valign=\"center\">\n                              <div>{resource.name}</div>\n                            </td>\n                            <td data-responsive-text=\"Type\" data-valign=\"center\">\n                              <div>{validateFileType(resource)}</div>\n                            </td>\n                            <td data-responsive-text=\"Status\" data-valign=\"center\">\n                              <div className=\"text-success asset-table--asset-status--11R9h\">\n                                Success\n                              </div>\n                            </td>\n                            <td data-responsive-text=\"Date\" data-valign=\"center\">\n                              <div>{moment(resource.timestamp).format(\"MM/DD/YYYY\")}</div>\n                            </td>\n                            <td data-valign=\"center\">\n                              <div className=\"asset-table--action-buttons--3agUO\">\n                                <button\n                                  onClick={() => {\n                                    onSuccess(resource)\n\n                                  }\n\n                                  }\n                                  type=\"button\"\n                                  className=\"btn btn-xs btn-tertiary\"\n                                >\n                                  Select\n                                </button>\n                                <button\n\n                                  type=\"button\"\n                                  className=\"btn btn-xs btn-tertiary\"\n                                >\n                                  <span className=\"cfi cfi-trash\" />\n                                </button>\n                              </div>\n                            </td>\n                          </tr>\n                        )\n                      }\n                    })}\n                  </tbody>\n                </table>\n              </div>\n              <div\n                className=\"pagination-container hidden\"\n                data-purpose=\"pagination-container\"\n              >\n                <ul className=\"pager\">\n                  <li className=\"disabled previous\">\n                    <a\n                      href=\"/instructor/course/4199184/manage/curriculum\"\n                      tabIndex={-1}\n                      style={{ pointerEvents: \"none\" }}\n                    >\n                      <span className=\"cfi cfi-previous\" />\n                    </a>\n                  </li>\n                  <li className=\"disabled next\">\n                    <a\n                      href=\"/instructor/course/4199184/manage/curriculum?p=2\"\n                      tabIndex={-1}\n                      style={{ pointerEvents: \"none\" }}\n                    >\n                      <span className=\"cfi cfi-next\" />\n                    </a>\n                  </li>\n                </ul>\n              </div>\n            </div>\n          </div>\n        </div>\n      </div>\n    </div>\n  );\n};\n"]},"metadata":{},"sourceType":"module"}