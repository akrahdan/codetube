{"ast":null,"code":"import _defineProperty from\"/Users/akrah/Documents/dev/readux/src/codefluent/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/defineProperty\";import _slicedToArray from\"/Users/akrah/Documents/dev/readux/src/codefluent/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/slicedToArray\";import React,{useEffect,useState}from\"react\";import{useAppDispatch}from\"store/hooks\";import{useHistory}from\"react-router\";import{setCurrentUrl,setSubtitle,setClipId,setCurrentLecture}from\"state/player/playerSlice\";import{useTrackViewsMutation,useFetchVideoViewsQuery,useUpdateVideoViewsMutation}from\"services/courses\";import{usePlayer}from\"store/usePlayer\";import classNames from\"classnames\";import styles from\"./style.module.scss\";import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";export var LectureItem=function LectureItem(_ref){var lecture=_ref.lecture,isCurrent=_ref.isCurrent,handleCurrent=_ref.handleCurrent,complete=_ref.complete,handleActive=_ref.handleActive;var _useState=useState(0),_useState2=_slicedToArray(_useState,2),seconds=_useState2[0],setSeconds=_useState2[1];var _useState3=useState(0),_useState4=_slicedToArray(_useState3,2),minutes=_useState4[0],setMinutes=_useState4[1];var _useTrackViewsMutatio=useTrackViewsMutation(),_useTrackViewsMutatio2=_slicedToArray(_useTrackViewsMutatio,1),trackViews=_useTrackViewsMutatio2[0];var _useUpdateVideoViewsM=useUpdateVideoViewsMutation(),_useUpdateVideoViewsM2=_slicedToArray(_useUpdateVideoViewsM,1),updateVideoViews=_useUpdateVideoViewsM2[0];var _useFetchVideoViewsQu=useFetchVideoViewsQuery(lecture.id),viewsQuery=_useFetchVideoViewsQu.data;var dispatch=useAppDispatch();var _useHistory=useHistory(),push=_useHistory.push;var _usePlayer=usePlayer(),player=_usePlayer.player;var _useState5=useState(),_useState6=_slicedToArray(_useState5,2),views=_useState6[0],setViews=_useState6[1];useEffect(function(){if(viewsQuery){setViews(viewsQuery);}},[viewsQuery]);useEffect(function(){if(lecture){var _minutes=Math.floor(lecture.duration/60);var _seconds=Math.round(lecture.duration-_minutes*60);setMinutes(_minutes);setSeconds(_seconds);dispatch(setSubtitle(lecture.title));}},[lecture]);return/*#__PURE__*/_jsxs(\"button\",{onClick:function onClick(){var _lecture$video;handleCurrent();dispatch(setCurrentUrl(lecture.video_url));dispatch(setCurrentLecture(lecture));trackViews({id:lecture.id});var view=views===null||views===void 0?void 0:views.find(function(v){return v.lecture==lecture.id;});if(view){updateVideoViews({progress:player.time,lecture:lecture.id,id:view.id});}handleActive();push({search:\"?\"+new URLSearchParams({clipid:lecture.video.key})});dispatch(setSubtitle(lecture.title));dispatch(setClipId((_lecture$video=lecture.video)===null||_lecture$video===void 0?void 0:_lecture$video.key));},className:classNames(styles.lectureItemContainer,_defineProperty({},styles.isCurrent,isCurrent)),children:[/*#__PURE__*/_jsx(\"div\",{className:styles.iconContainer,children:complete&&!isCurrent?/*#__PURE__*/_jsx(\"div\",{className:styles.iconPosition,children:/*#__PURE__*/_jsx(\"svg\",{\"aria-label\":\"completed\",className:styles.svgIcon,xmlns:\"http://www.w3.org/2000/svg\",viewBox:\"0 0 24 24\",children:/*#__PURE__*/_jsx(\"path\",{d:\"M2.6 12.3l-1.4 1.4a1 1 0 000 1.5l6.1 6.2c.4.4 1 .4 1.4 0L23 6.9c.4-.4.4-1 0-1.4L21.6 4A1 1 0 0020 4l-12 12.3-4-4a1 1 0 00-1.5 0z\"})})}):/*#__PURE__*/_jsx(\"div\",{className:classNames(styles.iconPosition,_defineProperty({},styles.isCurrent,isCurrent)),children:/*#__PURE__*/_jsx(\"svg\",{\"aria-label\":\"selected\",className:styles.svgIcon,xmlns:\"http://www.w3.org/2000/svg\",viewBox:\"0 0 24 24\",children:/*#__PURE__*/_jsx(\"path\",{d:\"M6.23 20.7L19.77 12 6.23 3.3\"})})})}),/*#__PURE__*/_jsxs(\"div\",{className:styles.lectureItemDisplay,children:[/*#__PURE__*/_jsx(\"h3\",{className:styles.lectureItemH3,children:/*#__PURE__*/_jsx(\"div\",{className:styles.textCenter,children:/*#__PURE__*/_jsx(\"span\",{title:\"Introduction\",children:lecture.title})})}),/*#__PURE__*/_jsxs(\"div\",{className:styles.lectureDuration,children:[minutes,\"m \",seconds,\"s\"]})]})]});};","map":{"version":3,"sources":["/Users/akrah/Documents/dev/readux/src/codefluent/src/portal/scenes/CoursePlayer/contentItem/lectureItem/index.tsx"],"names":["React","useEffect","useState","useAppDispatch","useHistory","setCurrentUrl","setSubtitle","setClipId","setCurrentLecture","useTrackViewsMutation","useFetchVideoViewsQuery","useUpdateVideoViewsMutation","usePlayer","classNames","styles","LectureItem","lecture","isCurrent","handleCurrent","complete","handleActive","seconds","setSeconds","minutes","setMinutes","trackViews","updateVideoViews","id","viewsQuery","data","dispatch","push","player","views","setViews","Math","floor","duration","round","title","video_url","view","find","v","progress","time","search","URLSearchParams","clipid","video","key","lectureItemContainer","iconContainer","iconPosition","svgIcon","lectureItemDisplay","lectureItemH3","textCenter","lectureDuration"],"mappings":"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","sourcesContent":["import React, { useEffect, useState } from \"react\";\nimport { useAppDispatch } from \"store/hooks\";\nimport { useHistory } from \"react-router\";\nimport { setCurrentUrl, setCurrentUrlIndex, setSubtitle, setClipId, setCurrentLecture } from \"state/player/playerSlice\";\nimport { useTrackViewsMutation, useFetchVideoViewsQuery, useUpdateVideoViewsMutation, VideoAnalytics } from \"services/courses\";\n\nimport { usePlayer } from \"store/usePlayer\";\nimport classNames from \"classnames\";\nimport { Lecture } from \"services/courses\";\nimport styles from \"./style.module.scss\";\n\ntype LectureProps = {\n  lecture: Lecture,\n  isCurrent: boolean,\n  handleCurrent: () => void,\n  complete: boolean\n  handleActive: () => void\n}\nexport const LectureItem: React.FC<LectureProps> = ({ lecture, isCurrent, handleCurrent, complete, handleActive }) => {\n\n  const [seconds, setSeconds] = useState(0)\n  const [minutes, setMinutes] = useState(0)\n  const [trackViews] = useTrackViewsMutation()\n  const [ updateVideoViews ] = useUpdateVideoViewsMutation()\n  const { data: viewsQuery } = useFetchVideoViewsQuery(lecture.id)\n  const dispatch = useAppDispatch()\n  const { push } = useHistory()\n  const { player } = usePlayer()\n  const [views, setViews] = useState<VideoAnalytics[]>()\n\n  useEffect(() => {\n    if(viewsQuery) {\n      setViews(viewsQuery)\n    }\n  }, [viewsQuery])\n  useEffect(() => {\n    if (lecture) {\n      const minutes = Math.floor(lecture.duration / 60)\n      const seconds = Math.round(lecture.duration - minutes * 60)\n      setMinutes(minutes)\n      setSeconds(seconds)\n      dispatch(setSubtitle(lecture.title))\n    }\n\n  }, [lecture])\n\n \n\n  return (\n    <button onClick={() => {\n      handleCurrent();\n      dispatch(setCurrentUrl(lecture.video_url))\n      dispatch(setCurrentLecture(lecture))\n      trackViews({\n        id: lecture.id\n      })\n      const view = views?.find(v => v.lecture == lecture.id )\n      if(view) {\n        updateVideoViews({\n          progress: player.time,\n          lecture: lecture.id,\n          id: view.id\n        })\n      }\n\n     \n      handleActive()\n      push({\n        search: \"?\" + new URLSearchParams({ clipid: lecture.video.key })\n      })\n      dispatch(setSubtitle(lecture.title))\n      dispatch(setClipId(lecture.video?.key))\n\n    }} className={classNames(styles.lectureItemContainer, {\n      [styles.isCurrent]: isCurrent\n    })}>\n      <div className={styles.iconContainer}>\n        {\n          (complete && !isCurrent) ? (<div className={styles.iconPosition}>\n            <svg aria-label=\"completed\" className={styles.svgIcon}\n              xmlns=\"http://www.w3.org/2000/svg\" viewBox=\"0 0 24 24\">\n              <path d=\"M2.6 12.3l-1.4 1.4a1 1 0 000 1.5l6.1 6.2c.4.4 1 .4 1.4 0L23 6.9c.4-.4.4-1 0-1.4L21.6 4A1 1 0 0020 4l-12 12.3-4-4a1 1 0 00-1.5 0z\" />\n            </svg>\n          </div>) : (<div className={classNames(styles.iconPosition, {\n            [styles.isCurrent]: isCurrent\n          })}>\n            <svg\n              aria-label=\"selected\"\n              className={styles.svgIcon}\n              xmlns=\"http://www.w3.org/2000/svg\"\n              viewBox=\"0 0 24 24\"\n            >\n              <path d=\"M6.23 20.7L19.77 12 6.23 3.3\" />\n            </svg>\n          </div>)\n        }\n\n      </div>\n      <div className={styles.lectureItemDisplay}>\n        <h3 className={styles.lectureItemH3}>\n          <div className={styles.textCenter}>\n            <span title=\"Introduction\">{lecture.title}</span>\n          </div>\n        </h3>\n        <div className={styles.lectureDuration}>{minutes}m {seconds}s</div>\n      </div>\n    </button>\n  );\n};\n"]},"metadata":{},"sourceType":"module"}