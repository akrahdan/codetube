{"ast":null,"code":"import _classCallCheck from\"/Users/akrah/Documents/dev/readux/src/codefluent/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/classCallCheck\";import _createClass from\"/Users/akrah/Documents/dev/readux/src/codefluent/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/createClass\";import _inherits from\"/Users/akrah/Documents/dev/readux/src/codefluent/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/inherits\";import _createSuper from\"/Users/akrah/Documents/dev/readux/src/codefluent/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/createSuper\";import React,{Component}from'react';import Button from'@pluralsight/ps-design-system-button';import Link from'@pluralsight/ps-design-system-link';import moment from'moment';// import * as actions from '../../actions'\nimport{Errors}from'../constants';import css from'./error-modal.module.css';import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";function ModalUnauthenticated(signIn){return/*#__PURE__*/_jsxs(\"div\",{className:css['error-modal__content'],children:[/*#__PURE__*/_jsx(\"p\",{children:\"You need to sign in to view this course.\"}),/*#__PURE__*/_jsx(Button,{className:css['error-modal__btn'],onClick:function onClick(){return signIn&&signIn();},children:\"Sign in\"})]});}function ModalForbidden(upgrade,buttonText){return/*#__PURE__*/_jsxs(\"div\",{className:css['error-modal__content'],children:[/*#__PURE__*/_jsx(\"p\",{children:\"Your current plan doesn\\u2019t allow access to this course. Upgrade to get access to thousands of expert-led courses across hundreds of topics.\"}),/*#__PURE__*/_jsx(Button,{className:css['error-modal__btn'],onClick:function onClick(){return upgrade&&upgrade();},children:buttonText})]});}export var ModalGeneric=function ModalGeneric(_ref){var retry=_ref.retry,tryAgainCount=_ref.tryAgainCount,setTryAgainCount=_ref.setTryAgainCount;return/*#__PURE__*/_jsxs(\"div\",{className:css['error-modal__content'],children:[/*#__PURE__*/_jsx(\"p\",{children:\"We're sorry, there has been an issue loading your video.\"}),/*#__PURE__*/_jsx(Button,{className:css['error-modal__btn'],onClick:function onClick(){setTryAgainCount&&setTryAgainCount(tryAgainCount?tryAgainCount+1:1);retry&&retry();},children:\"Try again\"}),tryAgainCount>0&&/*#__PURE__*/_jsx(\"div\",{children:/*#__PURE__*/_jsx(Link,{appearance:Link.appearances.subtle,children:/*#__PURE__*/_jsx(\"a\",{className:css['error-modal__link'],href:\"https://app.pluralsight.com/video/test\",target:\"_blank\",children:\"Still having issues?\"})})})]});};export var ErrorModal=/*#__PURE__*/function(_Component){_inherits(ErrorModal,_Component);var _super=_createSuper(ErrorModal);function ErrorModal(){_classCallCheck(this,ErrorModal);return _super.apply(this,arguments);}_createClass(ErrorModal,[{key:\"getErrorMessage\",value:function getErrorMessage(){var _this$props=this.props,error=_this$props.error,signIn=_this$props.signIn,requestUrls=_this$props.requestUrls,setLoading=_this$props.setLoading,upgrade=_this$props.upgrade,userId=_this$props.userId,tryAgainCount=_this$props.tryAgainCount,setTryAgainCount=_this$props.setTryAgainCount,_this$props$currentTi=_this$props.currentTime,currentTime=_this$props$currentTi===void 0?new Date().toISOString():_this$props$currentTi,boundedContext=_this$props.boundedContext,clipId=_this$props.clipId;var isAnonymous=!userId||userId==='anonymous';var isInPromotionWindow=moment(currentTime).isBetween('2021-02-09T07:00:00.000Z','2021-02-18T07:00:00.000Z');var upgradeText=isInPromotionWindow?'Get 33% off':'Upgrade';if(error===Errors.UNAUTHENTICATED)return ModalUnauthenticated(signIn);if(error===Errors.FORBIDDEN&&isAnonymous)return ModalUnauthenticated(signIn);if(error===Errors.FORBIDDEN)return ModalForbidden(function(){return upgrade(boundedContext,clipId);},upgradeText);return/*#__PURE__*/_jsx(ModalGeneric,{retry:function retry(){setLoading(true);requestUrls();},tryAgainCount:tryAgainCount,setTryAgainCount:setTryAgainCount});}},{key:\"render\",value:function render(){var error=this.props.error;if(!error)return null;return/*#__PURE__*/_jsx(\"div\",{className:css.errorModal,children:this.getErrorMessage()});}}]);return ErrorModal;}(Component);export default ErrorModal;// export default connect(\n//   (state) => ({\n//     error: state.error,\n//     clipId: state.clipId,\n//     boundedContext: state.boundedContext,\n//     userId: state.userId,\n//     currentUrlIndex: state.currentUrlIndex,\n//     tryAgainCount: state.tryAgainCount,\n//   }),\n//   (store) => ({\n//     setLoading: actions.setLoading,\n//     requestUrls: actions.requestUrls,\n//     setTryAgainCount: actions.setTryAgainCount,\n//   })\n// )(ErrorModal)","map":{"version":3,"sources":["/Users/akrah/Documents/dev/readux/src/codefluent/src/portal/scenes/CoursePlayer/error-modal/error-modal.js"],"names":["React","Component","Button","Link","moment","Errors","css","ModalUnauthenticated","signIn","ModalForbidden","upgrade","buttonText","ModalGeneric","retry","tryAgainCount","setTryAgainCount","appearances","subtle","ErrorModal","props","error","requestUrls","setLoading","userId","currentTime","Date","toISOString","boundedContext","clipId","isAnonymous","isInPromotionWindow","isBetween","upgradeText","UNAUTHENTICATED","FORBIDDEN","errorModal","getErrorMessage"],"mappings":"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","sourcesContent":["import React, { Component } from 'react'\n\nimport Button from '@pluralsight/ps-design-system-button'\nimport Link from '@pluralsight/ps-design-system-link'\nimport moment from 'moment'\n\n// import * as actions from '../../actions'\nimport { Errors } from '../constants'\nimport css from './error-modal.module.css'\n\nfunction ModalUnauthenticated(signIn) {\n  return (\n    <div className={css['error-modal__content']}>\n      <p>You need to sign in to view this course.</p>\n      <Button className={css['error-modal__btn']} onClick={() => signIn && signIn()}>\n        Sign in\n      </Button>\n    </div>\n  )\n}\n\nfunction ModalForbidden(upgrade, buttonText) {\n  return (\n    <div className={css['error-modal__content']}>\n      <p>\n        Your current plan doesnâ€™t allow access to this course. Upgrade to get access to thousands of expert-led courses\n        across hundreds of topics.\n      </p>\n      <Button className={css['error-modal__btn']} onClick={() => upgrade && upgrade()}>\n        {buttonText}\n      </Button>\n    </div>\n  )\n}\n\nexport const ModalGeneric = ({ retry, tryAgainCount, setTryAgainCount }) => {\n  return (\n    <div className={css['error-modal__content']}>\n      <p>We're sorry, there has been an issue loading your video.</p>\n      <Button\n        className={css['error-modal__btn']}\n        onClick={() => {\n          setTryAgainCount && setTryAgainCount(tryAgainCount ? tryAgainCount + 1 : 1)\n          retry && retry()\n        }}\n      >\n        Try again\n      </Button>\n      {tryAgainCount > 0 && (\n        <div>\n          <Link appearance={Link.appearances.subtle}>\n            <a className={css['error-modal__link']} href=\"https://app.pluralsight.com/video/test\" target=\"_blank\">\n              Still having issues?\n            </a>\n          </Link>\n        </div>\n      )}\n    </div>\n  )\n}\n\nexport class ErrorModal extends Component {\n  getErrorMessage() {\n    const {\n      error,\n      signIn,\n      requestUrls,\n      setLoading,\n      upgrade,\n      userId,\n      tryAgainCount,\n      setTryAgainCount,\n      currentTime = new Date().toISOString(),\n      boundedContext, \n      clipId\n    } = this.props\n    const isAnonymous = !userId || userId === 'anonymous'\n    const isInPromotionWindow = moment(currentTime).isBetween('2021-02-09T07:00:00.000Z', '2021-02-18T07:00:00.000Z')\n\n    const upgradeText = isInPromotionWindow ? 'Get 33% off' : 'Upgrade'\n\n    if (error === Errors.UNAUTHENTICATED) return ModalUnauthenticated(signIn)\n    if (error === Errors.FORBIDDEN && isAnonymous) return ModalUnauthenticated(signIn)\n    if (error === Errors.FORBIDDEN) return ModalForbidden(() => upgrade(boundedContext, clipId), upgradeText)\n\n    return (\n      <ModalGeneric\n        retry={() => {\n          setLoading(true)\n          requestUrls()\n        }}\n        tryAgainCount={tryAgainCount}\n        setTryAgainCount={setTryAgainCount}\n      />\n    )\n  }\n\n  render() {\n    const { error } = this.props\n\n    if (!error) return null\n\n    return <div className={css.errorModal}>{this.getErrorMessage()}</div>\n  }\n}\n\nexport default ErrorModal;\n\n// export default connect(\n//   (state) => ({\n//     error: state.error,\n//     clipId: state.clipId,\n//     boundedContext: state.boundedContext,\n//     userId: state.userId,\n//     currentUrlIndex: state.currentUrlIndex,\n//     tryAgainCount: state.tryAgainCount,\n//   }),\n//   (store) => ({\n//     setLoading: actions.setLoading,\n//     requestUrls: actions.requestUrls,\n//     setTryAgainCount: actions.setTryAgainCount,\n//   })\n// )(ErrorModal)\n"]},"metadata":{},"sourceType":"module"}