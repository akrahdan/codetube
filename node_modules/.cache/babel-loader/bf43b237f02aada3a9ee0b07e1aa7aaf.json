{"ast":null,"code":"import _objectSpread from\"/Users/akrah/Documents/dev/readux/src/codefluent/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/objectSpread2\";import _slicedToArray from\"/Users/akrah/Documents/dev/readux/src/codefluent/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/slicedToArray\";import'./profile.scss';import logo from'static/images/avatar/profile-avatar.png';import{PickerOverlay}from'filestack-react';import{useUpdateProfileMutation,useUpdateAvatarMutation}from'services/auth';import React,{useEffect,useState}from'react';import{useAlert}from'react-alert';import{useAuth,useAvatar}from'store/useAuth';import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";export var EditModal=function EditModal(_ref){var onClose=_ref.onClose;var _useAuth=useAuth(),user=_useAuth.user;var _useAvatar=useAvatar(),userAvatar=_useAvatar.avatar;var _useUpdateAvatarMutat=useUpdateAvatarMutation(),_useUpdateAvatarMutat2=_slicedToArray(_useUpdateAvatarMutat,1),updateAvatar=_useUpdateAvatarMutat2[0];var _useUpdateProfileMuta=useUpdateProfileMutation(),_useUpdateProfileMuta2=_slicedToArray(_useUpdateProfileMuta,1),updateProfile=_useUpdateProfileMuta2[0];var alert=useAlert();var _useState=useState(false),_useState2=_slicedToArray(_useState,2),pickerOpen=_useState2[0],setPickerOpen=_useState2[1];var _useState3=useState({avatar:userAvatar}),_useState4=_slicedToArray(_useState3,2),avatar=_useState4[0],setAvatar=_useState4[1];var _useState5=useState(user),_useState6=_slicedToArray(_useState5,2),profile=_useState6[0],setProfile=_useState6[1];var onPickerClose=function onPickerClose(){setPickerOpen(false);};useEffect(function(){setProfile(user);},[user]);useEffect(function(){setAvatar({avatar:userAvatar});},[userAvatar]);var onUploadSuccess=function onUploadSuccess(result){if(result.filesUploaded&&result.filesUploaded.length){var files=result.filesUploaded[0];updateAvatar({avatar:files.url}).then(function(res){if(res.data&&res.data.avatar){setAvatar({avatar:res.data.avatar});alert.show('Your avatar updates saved successfully');}});}};return/*#__PURE__*/_jsx(\"div\",{\"aria-labelledby\":\"myModalLabel\",className:\"modal fade in\",\"data-first-name-missing\":\"false\",\"data-user-course-id\":true,\"data-user-id\":1304005,id:\"complete-your-profile\",role:\"dialog\",tabIndex:-1,style:{display:\"block\",background:'rgba(0,0,0,0.8)'},children:/*#__PURE__*/_jsx(\"div\",{className:\"modal-dialog\",role:\"document\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"modal-content cf-invert\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"modal-header\",children:[/*#__PURE__*/_jsx(\"button\",{\"aria-label\":\"Close\",className:\"close\",onClick:onClose,\"data-dismiss\":\"modal\",id:\"cyp-dismiss\",type:\"button\",children:/*#__PURE__*/_jsx(\"span\",{\"aria-hidden\":\"true\",children:\" \\xD7\"})}),/*#__PURE__*/_jsxs(\"div\",{className:\"cf-text--center\",children:[/*#__PURE__*/_jsx(\"h4\",{className:\"cf-text-h4 cf-mb-2\",children:\"Please complete your profile.\"}),/*#__PURE__*/_jsx(\"p\",{children:\"Introduce yourself.\"})]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"modal-body\",children:[/*#__PURE__*/_jsxs(\"form\",{className:\"new_user_info\",id:\"new_user_info\",onSubmit:function onSubmit(event){event.preventDefault();updateProfile(profile).then(function(res){if(res.data&&res.data.email){alert.show('Your profile changes saved successfully');onClose();}}).catch(function(err){alert.error(err);});},children:[/*#__PURE__*/_jsx(\"div\",{className:\"pre-comment__col-user-container\",children:/*#__PURE__*/_jsx(\"div\",{className:\"pre-comment__col-user-avatar-container\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"pre-comment__col-user-avatar-edit-holder\",children:[/*#__PURE__*/_jsx(\"img\",{className:\"pre-comment__user-avatar profile-photo\",src:avatar.avatar?avatar.avatar:logo}),/*#__PURE__*/_jsx(\"div\",{className:\"c-button c-button--tertiary upload-photo\",\"data-module\":\"FilePickerUpload\",onClick:function onClick(){setPickerOpen(!pickerOpen);},id:\"cyp-picker-trigger\",children:\"Upload Photo\"}),/*#__PURE__*/_jsx(\"a\",{className:\"c-button c-button--primary c-button--facebook btn-facebook\",href:\"\",id:\"facebook-connect\",children:\"Import from Facebook\"})]})})}),/*#__PURE__*/_jsxs(\"div\",{className:\"fields-container\",children:[/*#__PURE__*/_jsxs(\"ul\",{children:[/*#__PURE__*/_jsxs(\"li\",{children:[/*#__PURE__*/_jsx(\"p\",{children:\"Name:\"}),/*#__PURE__*/_jsx(\"div\",{className:\"cyp-name first\",children:/*#__PURE__*/_jsx(\"input\",{placeholder:\"First Name\",className:\"name first\",value:profile?profile.first_name:'',onChange:function onChange(event){setProfile(_objectSpread(_objectSpread({},profile),{},{first_name:event.target.value}));},type:\"text\",name:\"user_info[first_name]\",id:\"user_info_first_name\"})}),/*#__PURE__*/_jsx(\"div\",{className:\"cyp-name\",children:/*#__PURE__*/_jsx(\"input\",{defaultValue:\"Akrah\",placeholder:\"Last Name\",className:\"name\",value:profile?profile.last_name:'',onChange:function onChange(event){setProfile(_objectSpread(_objectSpread({},profile),{},{last_name:event.target.value}));},type:\"text\",name:\"user_info[last_name]\",id:\"user_info_last_name\"})})]}),/*#__PURE__*/_jsxs(\"li\",{children:[/*#__PURE__*/_jsx(\"p\",{children:\"Location:\"}),/*#__PURE__*/_jsx(\"input\",{placeholder:\"Your Location\",type:\"text\",name:\"user_info[location]\",id:\"user_info_location\"})]})]}),/*#__PURE__*/_jsx(\"button\",{className:\"cf-mt-3 c-button c-button--primary c-button--full-width\",id:\"cyp-submit\",type:\"submit\",children:\"Continue\"})]})]}),pickerOpen&&/*#__PURE__*/_jsx(PickerOverlay,{apikey:\"AVBagqtWmRWyWVqWas0m9z\",onSuccess:onUploadSuccess,pickerOptions:{onClose:onPickerClose}})]})]})})});};","map":{"version":3,"sources":["/Users/akrah/Documents/dev/readux/src/codefluent/src/portal/scenes/Profile/EditModal.tsx"],"names":["logo","PickerOverlay","useUpdateProfileMutation","useUpdateAvatarMutation","React","useEffect","useState","useAlert","useAuth","useAvatar","EditModal","onClose","user","userAvatar","avatar","updateAvatar","updateProfile","alert","pickerOpen","setPickerOpen","setAvatar","profile","setProfile","onPickerClose","onUploadSuccess","result","filesUploaded","length","files","url","then","res","data","show","display","background","event","preventDefault","email","catch","err","error","first_name","target","value","last_name"],"mappings":"6UAAA,MAAO,gBAAP,CACA,MAAOA,CAAAA,IAAP,KAAiB,yCAAjB,CAGA,OAASC,aAAT,KAA8B,iBAA9B,CAEA,OAASC,wBAAT,CAAmCC,uBAAnC,KAAkE,eAAlE,CACA,MAAOC,CAAAA,KAAP,EAAgBC,SAAhB,CAA2BC,QAA3B,KAA2C,OAA3C,CACA,OAASC,QAAT,KAAyB,aAAzB,CACA,OAASC,OAAT,CAAkBC,SAAlB,KAAmC,eAAnC,C,wFAOA,MAAO,IAAMC,CAAAA,SAA+B,CAAG,QAAlCA,CAAAA,SAAkC,MAAiB,IAAdC,CAAAA,OAAc,MAAdA,OAAc,cAE7CH,OAAO,EAFsC,CAEtDI,IAFsD,UAEtDA,IAFsD,gBAG/BH,SAAS,EAHsB,CAG9CI,UAH8C,YAGtDC,MAHsD,2BAKvCX,uBAAuB,EALgB,gEAKvDY,YALuD,qDAMtCb,wBAAwB,EANc,gEAMvDc,aANuD,2BAO9D,GAAMC,CAAAA,KAAK,CAAGV,QAAQ,EAAtB,CAP8D,cAQxBD,QAAQ,CAAC,KAAD,CARgB,wCAQtDY,UARsD,eAQzCC,aARyC,8BASlCb,QAAQ,CAAS,CAC3CQ,MAAM,CAAED,UADmC,CAAT,CAT0B,yCASvDC,MATuD,eAS/CM,SAT+C,8BAahCd,QAAQ,CAAOM,IAAP,CAbwB,yCAavDS,OAbuD,eAa9CC,UAb8C,eAe9D,GAAMC,CAAAA,aAAa,CAAG,QAAhBA,CAAAA,aAAgB,EAAM,CAC1BJ,aAAa,CAAC,KAAD,CAAb,CACD,CAFD,CAIAd,SAAS,CAAC,UAAM,CACbiB,UAAU,CAACV,IAAD,CAAV,CACF,CAFQ,CAEN,CAACA,IAAD,CAFM,CAAT,CAIAP,SAAS,CAAC,UAAM,CACde,SAAS,CAAC,CACRN,MAAM,CAAED,UADA,CAAD,CAAT,CAGF,CAJS,CAIP,CAACA,UAAD,CAJO,CAAT,CAMA,GAAMW,CAAAA,eAAe,CAAG,QAAlBA,CAAAA,eAAkB,CAACC,MAAD,CAA4B,CAClD,GAAIA,MAAM,CAACC,aAAP,EAAwBD,MAAM,CAACC,aAAP,CAAqBC,MAAjD,CAAyD,CACvD,GAAMC,CAAAA,KAAK,CAAGH,MAAM,CAACC,aAAP,CAAqB,CAArB,CAAd,CACAX,YAAY,CAAC,CACXD,MAAM,CAAEc,KAAK,CAACC,GADH,CAAD,CAAZ,CAEGC,IAFH,CAEQ,SAACC,GAAD,CAAgC,CACtC,GAAGA,GAAG,CAACC,IAAJ,EAAYD,GAAG,CAACC,IAAJ,CAASlB,MAAxB,CAAgC,CAC9BM,SAAS,CAAC,CACRN,MAAM,CAAEiB,GAAG,CAACC,IAAJ,CAASlB,MADT,CAAD,CAAT,CAGAG,KAAK,CAACgB,IAAN,CAAW,wCAAX,EACD,CACF,CATD,EAUD,CACF,CAdD,CAkBA,mBACE,YACE,kBAAgB,cADlB,CAEE,SAAS,CAAC,eAFZ,CAGE,0BAAwB,OAH1B,CAIE,0BAJF,CAKE,eAAc,OALhB,CAME,EAAE,CAAC,uBANL,CAOE,IAAI,CAAC,QAPP,CAQE,QAAQ,CAAE,CAAC,CARb,CASE,KAAK,CAAE,CAAEC,OAAO,CAAE,OAAX,CAAqBC,UAAU,CAAE,iBAAjC,CATT,uBAWE,YAAK,SAAS,CAAC,cAAf,CAA8B,IAAI,CAAC,UAAnC,uBACE,aAAK,SAAS,CAAC,yBAAf,wBACE,aAAK,SAAS,CAAC,cAAf,wBACE,eACE,aAAW,OADb,CAEE,SAAS,CAAC,OAFZ,CAGE,OAAO,CAAExB,OAHX,CAIE,eAAa,OAJf,CAKE,EAAE,CAAC,aALL,CAME,IAAI,CAAC,QANP,uBAQE,aAAM,cAAY,MAAlB,mBARF,EADF,cAWE,aAAK,SAAS,CAAC,iBAAf,wBACE,WAAI,SAAS,CAAC,oBAAd,2CADF,cAIE,0CAJF,GAXF,GADF,cAmBE,aAAK,SAAS,CAAC,YAAf,wBACE,cACE,SAAS,CAAC,eADZ,CAEE,EAAE,CAAC,eAFL,CAGE,QAAQ,CAAE,kBAAAyB,KAAK,CAAI,CACjBA,KAAK,CAACC,cAAN,GACArB,aAAa,CAACK,OAAD,CAAb,CACCS,IADD,CACM,SAACC,GAAD,CAAwB,CAC5B,GAAGA,GAAG,CAACC,IAAJ,EAAYD,GAAG,CAACC,IAAJ,CAASM,KAAxB,CAA+B,CAC7BrB,KAAK,CAACgB,IAAN,CAAW,yCAAX,EACAtB,OAAO,GACR,CACF,CAND,EAMG4B,KANH,CAMS,SAAAC,GAAG,CAAI,CACdvB,KAAK,CAACwB,KAAN,CAAYD,GAAZ,EACD,CARD,EASD,CAdH,wBAmBE,YAAK,SAAS,CAAC,iCAAf,uBACE,YAAK,SAAS,CAAC,wCAAf,uBACE,aAAK,SAAS,CAAC,0CAAf,wBACE,YACE,SAAS,CAAC,wCADZ,CAEE,GAAG,CAAE1B,MAAM,CAACA,MAAP,CAAgBA,MAAM,CAACA,MAAvB,CAAgCd,IAFvC,EADF,cAKE,YACE,SAAS,CAAC,0CADZ,CAEE,cAAY,kBAFd,CAGE,OAAO,CAAE,kBAAM,CACbmB,aAAa,CAAC,CAACD,UAAF,CAAb,CACD,CALH,CAOE,EAAE,CAAC,oBAPL,0BALF,cAgBE,UACE,SAAS,CAAC,4DADZ,CAEE,IAAI,CAAC,EAFP,CAGE,EAAE,CAAC,kBAHL,kCAhBF,GADF,EADF,EAnBF,cA+CE,aAAK,SAAS,CAAC,kBAAf,wBACE,mCACE,mCACE,4BADF,cAEE,YAAK,SAAS,CAAC,gBAAf,uBACE,cAEE,WAAW,CAAC,YAFd,CAGE,SAAS,CAAC,YAHZ,CAIE,KAAK,CAAEG,OAAO,CAAGA,OAAO,CAACqB,UAAX,CAAwB,EAJxC,CAKI,QAAQ,CAAE,kBAAAN,KAAK,CAAI,CACjBd,UAAU,gCACLD,OADK,MAERqB,UAAU,CAAEN,KAAK,CAACO,MAAN,CAAaC,KAFjB,GAAV,CAID,CAVL,CAWE,IAAI,CAAC,MAXP,CAYE,IAAI,CAAC,uBAZP,CAaE,EAAE,CAAC,sBAbL,EADF,EAFF,cAmBE,YAAK,SAAS,CAAC,UAAf,uBACE,cACE,YAAY,CAAC,OADf,CAEE,WAAW,CAAC,WAFd,CAGE,SAAS,CAAC,MAHZ,CAIE,KAAK,CAAEvB,OAAO,CAAGA,OAAO,CAACwB,SAAX,CAAuB,EAJvC,CAKI,QAAQ,CAAE,kBAAAT,KAAK,CAAI,CACjBd,UAAU,gCACLD,OADK,MAERwB,SAAS,CAAET,KAAK,CAACO,MAAN,CAAaC,KAFhB,GAAV,CAID,CAVL,CAWE,IAAI,CAAC,MAXP,CAYE,IAAI,CAAC,sBAZP,CAaE,EAAE,CAAC,qBAbL,EADF,EAnBF,GADF,cAsCE,mCACE,gCADF,cAEE,cAEE,WAAW,CAAC,eAFd,CAGE,IAAI,CAAC,MAHP,CAIE,IAAI,CAAC,qBAJP,CAKE,EAAE,CAAC,oBALL,EAFF,GAtCF,GADF,cAkDE,eACE,SAAS,CAAC,yDADZ,CAEE,EAAE,CAAC,YAFL,CAGE,IAAI,CAAC,QAHP,sBAlDF,GA/CF,GADF,CA2GG1B,UAAU,eAAI,KAAC,aAAD,EAAe,MAAM,CAAC,wBAAtB,CACX,SAAS,CAAEM,eADA,CAEX,aAAa,CAAE,CACbb,OAAO,CAAEY,aADI,CAFJ,EA3GjB,GAnBF,GADF,EAXF,EADF,CAuJD,CAtMM","sourcesContent":["import './profile.scss';\nimport logo from 'static/images/avatar/profile-avatar.png';\n\nimport type { UserRequest, Avatar, UserResponse, User } from 'services/auth';\nimport { PickerOverlay } from 'filestack-react';\nimport { PickerResponse } from \"filestack-js\";\nimport { useUpdateProfileMutation, useUpdateAvatarMutation } from 'services/auth'\nimport React, { useEffect, useState } from 'react';\nimport { useAlert } from 'react-alert';\nimport { useAuth, useAvatar } from 'store/useAuth';\n\n\ntype ModalProps = {\n  onClose: () => void\n}\n\nexport const EditModal: React.FC<ModalProps> = ({ onClose }) => {\n  \n  const { user } = useAuth()\n  const { avatar: userAvatar } = useAvatar()\n\n  const [updateAvatar] = useUpdateAvatarMutation()\n  const [updateProfile] = useUpdateProfileMutation()\n  const alert = useAlert()\n  const [ pickerOpen , setPickerOpen] = useState(false)\n  const [avatar, setAvatar] = useState<Avatar>({\n    avatar: userAvatar\n  })\n\n  const [profile, setProfile] = useState<User>(user)\n\n  const onPickerClose = () => {\n    setPickerOpen(false)\n  }\n\n  useEffect(() => {\n     setProfile(user)\n  }, [user])\n\n  useEffect(() => {\n    setAvatar({\n      avatar: userAvatar\n    })\n }, [userAvatar])\n\n  const onUploadSuccess = (result: PickerResponse) => {\n    if (result.filesUploaded && result.filesUploaded.length) {\n      const files = result.filesUploaded[0]\n      updateAvatar({\n        avatar: files.url\n      }).then((res: { data: UserResponse}) => {\n        if(res.data && res.data.avatar) {\n          setAvatar({\n            avatar: res.data.avatar\n          })\n          alert.show('Your avatar updates saved successfully')\n        }\n      })\n    }\n  }\n\n\n\n  return (\n    <div\n      aria-labelledby=\"myModalLabel\"\n      className=\"modal fade in\"\n      data-first-name-missing=\"false\"\n      data-user-course-id\n      data-user-id={1304005}\n      id=\"complete-your-profile\"\n      role=\"dialog\"\n      tabIndex={-1}\n      style={{ display: \"block\",  background: 'rgba(0,0,0,0.8)' }}\n    >\n      <div className=\"modal-dialog\" role=\"document\">\n        <div className=\"modal-content cf-invert\">\n          <div className=\"modal-header\">\n            <button\n              aria-label=\"Close\"\n              className=\"close\"\n              onClick={onClose}\n              data-dismiss=\"modal\"\n              id=\"cyp-dismiss\"\n              type=\"button\"\n            >\n              <span aria-hidden=\"true\"> ×</span>\n            </button>\n            <div className=\"cf-text--center\">\n              <h4 className=\"cf-text-h4 cf-mb-2\">\n                Please complete your profile.\n              </h4>\n              <p>Introduce yourself.</p>\n            </div>\n          </div>\n          <div className=\"modal-body\">\n            <form\n              className=\"new_user_info\"\n              id=\"new_user_info\"\n              onSubmit={event => {\n                event.preventDefault()\n                updateProfile(profile)\n                .then((res: { data: User}) => {\n                  if(res.data && res.data.email) {\n                    alert.show('Your profile changes saved successfully')\n                    onClose()\n                  }\n                }).catch(err => {\n                  alert.error(err)\n                })\n              }}\n             \n              \n            >\n           \n              <div className=\"pre-comment__col-user-container\">\n                <div className=\"pre-comment__col-user-avatar-container\">\n                  <div className=\"pre-comment__col-user-avatar-edit-holder\">\n                    <img\n                      className=\"pre-comment__user-avatar profile-photo\"\n                      src={avatar.avatar ? avatar.avatar : logo}\n                    />\n                    <div\n                      className=\"c-button c-button--tertiary upload-photo\"\n                      data-module=\"FilePickerUpload\"\n                      onClick={() => {\n                        setPickerOpen(!pickerOpen)\n                      }}\n                     \n                      id=\"cyp-picker-trigger\"\n                    >\n                      Upload Photo\n                    </div>\n                    <a\n                      className=\"c-button c-button--primary c-button--facebook btn-facebook\"\n                      href=\"\"\n                      id=\"facebook-connect\"\n                    >\n                      Import from Facebook\n                    </a>\n                  </div>\n                </div>\n              </div>\n              <div className=\"fields-container\">\n                <ul>\n                  <li>\n                    <p>Name:</p>\n                    <div className=\"cyp-name first\">\n                      <input\n                        \n                        placeholder=\"First Name\"\n                        className=\"name first\"\n                        value={profile ? profile.first_name : ''}\n                          onChange={event => {\n                            setProfile({\n                              ...profile,\n                              first_name: event.target.value\n                            })\n                          }}\n                        type=\"text\"\n                        name=\"user_info[first_name]\"\n                        id=\"user_info_first_name\"\n                      />\n                    </div>\n                    <div className=\"cyp-name\">\n                      <input\n                        defaultValue=\"Akrah\"\n                        placeholder=\"Last Name\"\n                        className=\"name\"\n                        value={profile ? profile.last_name : ''}\n                          onChange={event => {\n                            setProfile({\n                              ...profile,\n                              last_name: event.target.value\n                            })\n                          }}\n                        type=\"text\"\n                        name=\"user_info[last_name]\"\n                        id=\"user_info_last_name\"\n                      />\n                    </div>\n                  </li>\n                  <li>\n                    <p>Location:</p>\n                    <input\n                      \n                      placeholder=\"Your Location\"\n                      type=\"text\"\n                      name=\"user_info[location]\"\n                      id=\"user_info_location\"\n                    />\n                  </li>\n                </ul>\n                <button\n                  className=\"cf-mt-3 c-button c-button--primary c-button--full-width\"\n                  id=\"cyp-submit\"\n                  type=\"submit\"\n                >\n                  Continue\n                </button>\n              </div>\n            </form>\n            {pickerOpen && <PickerOverlay apikey=\"AVBagqtWmRWyWVqWas0m9z\"\n                onSuccess={onUploadSuccess}\n                pickerOptions={{\n                  onClose: onPickerClose,\n                  \n                }}\n              />}\n          </div>\n        </div>\n      </div>\n    </div>\n  );\n};\n"]},"metadata":{},"sourceType":"module"}