{"ast":null,"code":"import _objectSpread from\"/Users/akrah/Documents/dev/readux/src/codefluent/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/objectSpread2\";import _regeneratorRuntime from\"/Users/akrah/Documents/dev/readux/src/codefluent/node_modules/babel-preset-react-app/node_modules/@babel/runtime/regenerator\";import _asyncToGenerator from\"/Users/akrah/Documents/dev/readux/src/codefluent/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";import _slicedToArray from\"/Users/akrah/Documents/dev/readux/src/codefluent/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/slicedToArray\";import{Box}from'@codecademy/gamut';import{AnimatePresence,motion}from'framer-motion';import React,{useState}from'react';import{SearchButton}from'./Search/SearchButton';import{store}from'store';import{useLogoutMutation}from'services/auth';import{showModal}from'state/modals/modalSlice';import{useAuth,useAvatar}from'store/useAuth';import{useInstructor}from'store/useInstructor';import{useHistory}from'react-router';import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";var AnimatedPopoverVariants={enter:{opacity:1,transition:{duration:0.2}},exit:{opacity:0,transition:{duration:0.2}}};var animatedPopoverProps={initial:'exit',animate:'enter',exit:'exit',variants:AnimatedPopoverVariants};export var useAppHeaderProps=function useAppHeaderProps(){var _useState=useState(false),_useState2=_slicedToArray(_useState,2),isSearchVisible=_useState2[0],setSearchVisible=_useState2[1];// const { data: currentUser } = useGetCurrentUserQuery()\nvar _useAuth=useAuth(),currentUser=_useAuth.user;var _useAvatar=useAvatar(),avatar=_useAvatar.avatar;var _useInstructor=useInstructor(),instructor=_useInstructor.instructor;console.log(\"Current: \",instructor);var _useHistory=useHistory(),push=_useHistory.push;var _useLogoutMutation=useLogoutMutation(),_useLogoutMutation2=_slicedToArray(_useLogoutMutation,2),logout=_useLogoutMutation2[0],logoutResponse=_useLogoutMutation2[1].data;if(logoutResponse&&logoutResponse.detail){localStorage.clear();}var _useState3=useState(false),_useState4=_slicedToArray(_useState3,2),isMobileNotificationsOpen=_useState4[0],setIsMobileNotificationsOpen=_useState4[1];var toggleSearch=function toggleSearch(){setSearchVisible(!isSearchVisible);};var toggleMobileNotifications=function toggleMobileNotifications(){setIsMobileNotificationsOpen(!isMobileNotificationsOpen);};var handleClick=/*#__PURE__*/function(){var _ref=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(event,item){return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:if(item.id===\"instructor\"){if(currentUser&&currentUser.email){push('/course/create/');}else{store.dispatch(showModal('login'));}}if(item.id==\"login\"||item.id==\"signup\"){store.dispatch(showModal(item.id));}if(item.id==\"log-out\"){logout().then(function(res){if(res.data.detail){localStorage.clear();}});}case 3:case\"end\":return _context.stop();}}},_callee);}));return function handleClick(_x,_x2){return _ref.apply(this,arguments);};}();var headerProps=currentUser?{type:'pro',action:handleClick,user:{avatar:avatar,displayName:currentUser.first_name?\"\".concat(currentUser.first_name,\" \").concat(currentUser.last_name):currentUser.email,isInstructor:instructor&&!!instructor.id},search:{onEnable:function onEnable(){return console.log();},onSearch:function onSearch(query){return/*#__PURE__*/_jsx(SearchButton,{toggleSearch:toggleSearch});},onTrackingClick:function onTrackingClick(target){return console.log();}}}:{type:'anon',action:handleClick,search:{onEnable:function onEnable(){return console.log();},onSearch:function onSearch(query){return/*#__PURE__*/_jsx(SearchButton,{toggleSearch:toggleSearch});},onTrackingClick:function onTrackingClick(target){return console.log();}}};var search=/*#__PURE__*/_jsxs(Box,{position:\"relative\",zIndex:15,children:[isSearchVisible&&/*#__PURE__*/_jsxs(AnimatePresence,{children:[/*#__PURE__*/_jsx(motion.div,_objectSpread({},animatedPopoverProps),\"search\"),\")\"]}),isMobileNotificationsOpen&&/*#__PURE__*/_jsx(Box,{display:{_:'block',md:'none'},children:/*#__PURE__*/_jsx(AnimatePresence,{children:/*#__PURE__*/_jsx(motion.div,_objectSpread(_objectSpread({},animatedPopoverProps),{},{\"data-testid\":\"header-mobile-notifications-dropdown\"}),\"mobile notifications\")})})]});return[headerProps,search];};","map":{"version":3,"sources":["/Users/akrah/Documents/dev/readux/src/codefluent/src/components/AppHeader/useAppHeaderProps.tsx"],"names":["Box","AnimatePresence","motion","React","useState","SearchButton","store","useLogoutMutation","showModal","useAuth","useAvatar","useInstructor","useHistory","AnimatedPopoverVariants","enter","opacity","transition","duration","exit","animatedPopoverProps","initial","animate","variants","useAppHeaderProps","isSearchVisible","setSearchVisible","currentUser","user","avatar","instructor","console","log","push","logout","logoutResponse","data","detail","localStorage","clear","isMobileNotificationsOpen","setIsMobileNotificationsOpen","toggleSearch","toggleMobileNotifications","handleClick","event","item","id","email","dispatch","then","res","headerProps","type","action","displayName","first_name","last_name","isInstructor","search","onEnable","onSearch","query","onTrackingClick","target","_","md"],"mappings":"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","sourcesContent":["import { Box } from '@codecademy/gamut';\nimport type {\n\n  AppHeaderClickHandler,\n  GlobalHeaderProps,\n} from 'components/gamut-overrides';\nimport { AnimatePresence, motion, MotionProps, Variants } from 'framer-motion';\nimport React, { useState } from 'react';\n\nimport { Search } from './Search';\nimport { MobileSearchBar } from './Search/MobileSearchBar';\nimport { SearchButton } from './Search/SearchButton';\nimport cookie from 'react-cookies';\nimport { store } from 'store';\n\nimport { Logout, useLogoutMutation } from 'services/auth';\nimport { LogoutResponse } from 'services/auth';\nimport { showModal } from 'state/modals/modalSlice';\nimport { useAuth, useAvatar } from 'store/useAuth';\nimport { useInstructor } from 'store/useInstructor';\nimport { useHistory } from 'react-router';\n\nconst AnimatedPopoverVariants: Variants = {\n  enter: { opacity: 1, transition: { duration: 0.2 } },\n  exit: { opacity: 0, transition: { duration: 0.2 } },\n};\n\nconst animatedPopoverProps: MotionProps = {\n  initial: 'exit',\n  animate: 'enter',\n  exit: 'exit',\n  variants: AnimatedPopoverVariants,\n};\n\nexport const useAppHeaderProps = () => {\n\n\n\n\n  const [isSearchVisible, setSearchVisible] = useState(false);\n  // const { data: currentUser } = useGetCurrentUserQuery()\n  const { user: currentUser } = useAuth()\n  const { avatar } = useAvatar()\n  const { instructor } = useInstructor()\n  console.log(\"Current: \", instructor)\n  const { push } = useHistory();\n  const [logout, { data: logoutResponse }] = useLogoutMutation()\n\n  if (logoutResponse && logoutResponse.detail) {\n    localStorage.clear()\n  }\n\n  const [isMobileNotificationsOpen, setIsMobileNotificationsOpen] = useState(\n    false\n  );\n\n  const toggleSearch = () => {\n\n    setSearchVisible(!isSearchVisible);\n  };\n\n  const toggleMobileNotifications = () => {\n\n    setIsMobileNotificationsOpen(!isMobileNotificationsOpen);\n  };\n\n  const handleClick: AppHeaderClickHandler = async (event, item) => {\n\n    if (item.id === \"instructor\") {\n      if (currentUser && currentUser.email) {\n        push('/course/create/')\n      } else {\n        store.dispatch(showModal('login'))\n      }\n\n    }\n\n    if (item.id == \"login\" || item.id == \"signup\") {\n      store.dispatch(showModal(item.id))\n    }\n    if (item.id == \"log-out\") {\n      logout().\n        then((res: { data: LogoutResponse }) => {\n          if (res.data.detail) {\n            localStorage.clear()\n          }\n        })\n\n    }\n\n  };\n\n\n\n  const headerProps: GlobalHeaderProps = currentUser ? {\n    type: 'pro',\n    action: handleClick,\n    user: {\n      avatar: avatar,\n      displayName: currentUser.first_name ? `${currentUser.first_name} ${currentUser.last_name}` : currentUser.email,\n      isInstructor: instructor && !!instructor.id\n\n    },\n    search: {\n      onEnable: () => console.log(),\n      onSearch: (query: string) => <SearchButton toggleSearch={toggleSearch} />,\n      onTrackingClick: (target: string) => console.log()\n\n    }\n\n  } : {\n    type: 'anon',\n\n\n    action: handleClick,\n    search: {\n      onEnable: () => console.log(),\n      onSearch: (query: string) => <SearchButton toggleSearch={toggleSearch} />,\n      onTrackingClick: (target: string) => console.log()\n\n    }\n  };\n\n\n\n  const search = (\n    <Box position=\"relative\" zIndex={15}>\n      {isSearchVisible && (\n        <AnimatePresence>\n          <motion.div key=\"search\" {...animatedPopoverProps}>\n\n          </motion.div>\n          )\n        </AnimatePresence>\n      )}\n      {isMobileNotificationsOpen && (\n        <Box display={{ _: 'block', md: 'none' }}>\n          <AnimatePresence>\n            <motion.div\n              key=\"mobile notifications\"\n              {...animatedPopoverProps}\n              data-testid=\"header-mobile-notifications-dropdown\"\n            >\n\n            </motion.div>\n          </AnimatePresence>\n        </Box>\n      )}\n    </Box>\n  );\n\n  return [headerProps, search] as const;\n};\n"]},"metadata":{},"sourceType":"module"}