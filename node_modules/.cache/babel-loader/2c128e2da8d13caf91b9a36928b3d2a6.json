{"ast":null,"code":"import _regeneratorRuntime from\"/Users/akrah/Documents/dev/readux/src/codefluent/node_modules/babel-preset-react-app/node_modules/@babel/runtime/regenerator\";import _asyncToGenerator from\"/Users/akrah/Documents/dev/readux/src/codefluent/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";import _slicedToArray from\"/Users/akrah/Documents/dev/readux/src/codefluent/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/slicedToArray\";import{useCreateSectionMutation,useEditSectionMutation,useCreateResourceMutation,useFetchResourcesQuery}from'services/courses';import classNames from'classnames';import{selectSections}from'state/curriculum/currriculumSplice';import{useFetchSectionsQuery}from'services/courses';import{useAppSelector}from'store/hooks';import{selectLocationPayload}from'state/location/selectors';import{PickerOverlay}from'filestack-react';import\"./styles.scss\";import styles from'../Landing/style.module.scss';import{Section}from\"./Section\";import{useEffect,useState}from\"react\";import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";import{Fragment as _Fragment}from\"react/jsx-runtime\";export var Curriculum=function Curriculum(){var _useState=useState(false),_useState2=_slicedToArray(_useState,2),pickerOpen=_useState2[0],setPickerOpen=_useState2[1];var _useCreateSectionMuta=useCreateSectionMutation(),_useCreateSectionMuta2=_slicedToArray(_useCreateSectionMuta,2),createSection=_useCreateSectionMuta2[0],isLoading=_useCreateSectionMuta2[1].isLoading;var _useCreateResourceMut=useCreateResourceMutation(),_useCreateResourceMut2=_slicedToArray(_useCreateResourceMut,1),createResource=_useCreateResourceMut2[0];var _useEditSectionMutati=useEditSectionMutation(),_useEditSectionMutati2=_slicedToArray(_useEditSectionMutati,1),_editSection=_useEditSectionMutati2[0];var selectedSections=useAppSelector(selectSections);var locationPayload=useAppSelector(selectLocationPayload);var _useFetchSectionsQuer=useFetchSectionsQuery(locationPayload.id),querySections=_useFetchSectionsQuer.data;var _useFetchResourcesQue=useFetchResourcesQuery(locationPayload.id),resources=_useFetchResourcesQue.data;var _useState3=useState(selectedSections),_useState4=_slicedToArray(_useState3,2),sections=_useState4[0],setSections=_useState4[1];var onUploadSuccess=function onUploadSuccess(results){var data=results.filesUploaded;data&&Array.from(data).forEach(/*#__PURE__*/function(){var _ref=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(file){var media,result;return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:media={name:file.filename,filetype:file.mimetype,size:file.size,key:file.handle,course:locationPayload.id};try{result=createResource(media).unwrap();}catch(err){console.log(err);}case 2:case\"end\":return _context.stop();}}},_callee);}));return function(_x){return _ref.apply(this,arguments);};}());};var onClose=function onClose(event){setPickerOpen(false);};useEffect(function(){setSections(selectedSections);console.log('SelectedSections',selectedSections);},[selectedSections]);if(isLoading||!sections||sections.length==0){return/*#__PURE__*/_jsxs(\"div\",{className:\"ud-app-loader\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"sub-header--wrapper--3Vunm\",children:/*#__PURE__*/_jsx(\"div\",{className:\"sub-header--main-content--22it3\",children:/*#__PURE__*/_jsx(\"h2\",{\"data-purpose\":\"page-title\",className:\"font-heading-serif-xl sub-header--title--2VD8q\",children:\"Course landing page\"})})}),/*#__PURE__*/_jsx(\"div\",{className:\"main-content--wrap_component--2TEkz\",children:/*#__PURE__*/_jsx(\"form\",{children:/*#__PURE__*/_jsx(\"div\",{className:\"form-group\",children:/*#__PURE__*/_jsx(\"div\",{className:classNames(\"cfi-medium\",\"cfi\",\"cfi-circle-loader\",styles.loader)})})})})]});}return/*#__PURE__*/_jsxs(_Fragment,{children:[pickerOpen&&/*#__PURE__*/_jsx(PickerOverlay,{apikey:\"AVBagqtWmRWyWVqWas0m9z\",onSuccess:onUploadSuccess,pickerOptions:{onClose:onClose,maxFiles:20}}),/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsxs(\"div\",{className:\"sub-header--wrapper--3Vunm\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"sub-header--main-content--22it3\",children:/*#__PURE__*/_jsx(\"h2\",{\"data-purpose\":\"page-title\",className:\"font-heading-serif-xl sub-header--title--2VD8q\",children:\"Curriculum\"})}),/*#__PURE__*/_jsx(\"div\",{className:\"sub-header--actions--1Nblj\",children:/*#__PURE__*/_jsx(\"div\",{children:/*#__PURE__*/_jsx(\"button\",{onClick:function onClick(){return setPickerOpen(!pickerOpen);},type:\"button\",className:\"btn-bulk-uploader btn btn-default\",children:\"Bulk Uploader\"})})})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"main-content--wrap_component--2TEkz\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"curriculum-editor--alert-container--zgMwN\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"pb20\",children:\"Start putting together your course by creating sections, lectures and practice (quizzes, coding exercises and assignments).\"}),/*#__PURE__*/_jsx(\"p\",{\"data-purpose\":\"free-course-message\",children:\"If you\\u2019re intending to offer your course for free, the total length of video content must be less than 2 hours.\"})]}),/*#__PURE__*/_jsx(\"div\",{children:/*#__PURE__*/_jsx(\"ul\",{children:sections.map(function(section,index){return/*#__PURE__*/_jsx(Section,{editSection:function editSection(value){_editSection({id:section.id,description:value.description,title:value.title,course:locationPayload.id});},index:index,sectionResult:section,addSection:function addSection(value){createSection({title:value.title,description:value.description,course:locationPayload.id,position:value.position,neighbor:section.id||null});}},index);})})})]})]})]});};export default Curriculum;","map":{"version":3,"sources":["/Users/akrah/Documents/dev/readux/src/codefluent/src/portal/scenes/Instructor/Courses/Curriculum/index.tsx"],"names":["useCreateSectionMutation","useEditSectionMutation","useCreateResourceMutation","useFetchResourcesQuery","classNames","selectSections","useFetchSectionsQuery","useAppSelector","selectLocationPayload","PickerOverlay","styles","Section","useEffect","useState","Curriculum","pickerOpen","setPickerOpen","createSection","isLoading","createResource","editSection","selectedSections","locationPayload","id","querySections","data","resources","sections","setSections","onUploadSuccess","results","filesUploaded","Array","from","forEach","file","media","name","filename","filetype","mimetype","size","key","handle","course","result","unwrap","err","console","log","onClose","event","length","loader","maxFiles","map","section","index","value","description","title","position","neighbor"],"mappings":"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","sourcesContent":["import { useCreateSectionMutation, useEditSectionMutation,\n   useCreateResourceMutation, useFetchResourcesQuery } from 'services/courses';\nimport classNames from 'classnames';\nimport { selectSections } from 'state/curriculum/currriculumSplice';\nimport { useFetchSectionsQuery } from 'services/courses';\nimport { useAppSelector } from 'store/hooks';\nimport { selectLocationPayload } from 'state/location/selectors';\nimport { PickerOverlay, client } from 'filestack-react';\nimport { PickerResponse } from 'filestack-js';\nimport \"./styles.scss\";\nimport styles from '../Landing/style.module.scss';\nimport { Section } from \"./Section\";\nimport { useEffect, useState } from \"react\";\n\nexport const Curriculum = () => {\n  const [pickerOpen, setPickerOpen] = useState(false)\n  const [createSection, { isLoading }] = useCreateSectionMutation()\n  const [ createResource ] = useCreateResourceMutation()\n  const [editSection] = useEditSectionMutation()\n\n  const selectedSections = useAppSelector(selectSections)\n  const locationPayload = useAppSelector(selectLocationPayload)\n  const { data: querySections } = useFetchSectionsQuery(locationPayload.id)\n  const { data: resources } = useFetchResourcesQuery(locationPayload.id)\n  const [sections, setSections] = useState(selectedSections)\n\n  const onUploadSuccess = (results: PickerResponse) => {\n    const data = results.filesUploaded\n    data && Array.from(data).forEach( async file => {\n      const media = {\n        name: file.filename,\n        filetype: file.mimetype,\n        size: file.size,\n        key: file.handle,\n        course: locationPayload.id\n      };\n      try {\n       const result = createResource(media).unwrap()\n      } catch(err) {\n        console.log(err)\n      }\n    })\n  }\n  const onClose = (event) => {\n    setPickerOpen(false)\n  }\n\n\n\n  useEffect(() => {\n    setSections(selectedSections)\n    console.log('SelectedSections', selectedSections)\n  }, [selectedSections])\n\n  if (isLoading || !sections || (sections.length == 0)) {\n\n    return (\n      <div className=\"ud-app-loader\">\n        <div className=\"sub-header--wrapper--3Vunm\">\n          <div className=\"sub-header--main-content--22it3\">\n            <h2\n              data-purpose=\"page-title\"\n              className=\"font-heading-serif-xl sub-header--title--2VD8q\"\n            >\n              Course landing page\n            </h2>\n          </div>\n        </div>\n        <div className=\"main-content--wrap_component--2TEkz\">\n          <form>\n            <div className=\"form-group\">\n              <div className={classNames(\"cfi-medium\", \"cfi\", \"cfi-circle-loader\",\n                styles.loader)}>\n\n              </div>\n            </div>\n          </form>\n\n        </div>\n\n\n      </div>\n    );\n  }\n  return (\n    <>\n      {pickerOpen && <PickerOverlay  apikey=\"AVBagqtWmRWyWVqWas0m9z\"\n        onSuccess={onUploadSuccess}\n        pickerOptions={{\n          onClose,\n          maxFiles: 20\n        }}\n      />}\n      <div>\n        <div className=\"sub-header--wrapper--3Vunm\">\n          <div className=\"sub-header--main-content--22it3\">\n            <h2\n              data-purpose=\"page-title\"\n              className=\"font-heading-serif-xl sub-header--title--2VD8q\"\n            >\n              Curriculum\n            </h2>\n          </div>\n          <div className=\"sub-header--actions--1Nblj\">\n            <div>\n              <button onClick={() => setPickerOpen(!pickerOpen)} type=\"button\" className=\"btn-bulk-uploader btn btn-default\">\n                Bulk Uploader\n              </button>\n            </div>\n          </div>\n        </div>\n        <div className=\"main-content--wrap_component--2TEkz\">\n          <div className=\"curriculum-editor--alert-container--zgMwN\">\n            <div className=\"pb20\">\n              Start putting together your course by creating sections, lectures\n              and practice (quizzes, coding exercises and assignments).\n            </div>\n            <p data-purpose=\"free-course-message\">\n              If youâ€™re intending to offer your course for free, the total length\n              of video content must be less than 2 hours.\n            </p>\n          </div>\n          <div>\n            <ul >\n              {sections.map((section, index) => <Section editSection={value => {\n\n                editSection({\n                  id: section.id,\n                  description: value.description,\n                  title: value.title,\n                  course: locationPayload.id\n                })\n\n              }} key={index} index={index} sectionResult={section} addSection={value => {\n\n                createSection({\n                  title: value.title,\n                  description: value.description,\n                  course: locationPayload.id,\n                  position: value.position,\n                  neighbor: section.id || null\n\n                })\n\n              }} />)}\n\n            </ul>\n          </div>\n        </div>\n      </div>\n    </>\n  );\n};\n\nexport default Curriculum;\n"]},"metadata":{},"sourceType":"module"}