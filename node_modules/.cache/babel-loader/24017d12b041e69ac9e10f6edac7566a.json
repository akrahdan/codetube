{"ast":null,"code":"import _slicedToArray from\"/Users/akrah/Documents/dev/codefluent/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/slicedToArray\";import _taggedTemplateLiteral from\"/Users/akrah/Documents/dev/codefluent/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/taggedTemplateLiteral\";var _templateObject,_templateObject2,_templateObject3,_templateObject4;import{BodyPortal,FocusTrap,Pattern}from'@codecademy/gamut';import styled from'@emotion/styled';import React,{useCallback,useEffect,useRef,useState}from'react';import{useWindowScroll,useWindowSize}from'react-use';import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";var transform={right:'translateX(-100%)',left:'translateX(0%)',above:'translateY(-100%)',below:'translateY(0%)'};var PopoverContainer=styled.div(_templateObject||(_templateObject=_taggedTemplateLiteral([\"\\n  position: fixed;\\n  display: flex;\\n  transform: \",\";\\n\"])),function(_ref){var position=_ref.position,align=_ref.align;return position&&align&&\"\".concat(transform[position],\" \").concat(transform[align]);});var RaisedDiv=styled.div(_templateObject2||(_templateObject2=_taggedTemplateLiteral([\"\\n  z-index: 1;\\n  border-radius: 2px;\\n  border: 1px \",\"\\n    \",\";\\n  background-color: \",\";\\n  \",\";\\n\"])),function(_ref2){var outline=_ref2.outline;return outline?'solid':'none';},function(_ref3){var theme=_ref3.theme;return theme.colors.secondary;},function(_ref4){var theme=_ref4.theme;return theme.colors.white;},function(_ref5){var outline=_ref5.outline;return!outline&&'box-shadow: 0 0 16px rgba(0, 0, 0, 0.1), 0 0 24px rgba(0, 0, 0, 0.15)';});var Beak=styled.div(_templateObject3||(_templateObject3=_taggedTemplateLiteral([\"\\n  width: 20px;\\n  height: 20px;\\n  transform: rotate(45deg);\\n  border-\",\":\\n    1px\\n    \",\"\\n    \",\";\\n  border-\",\":\\n    1px\\n    \",\"\\n    \",\";\\n  background-color: \",\";\\n  position: absolute;\\n  left: \",\";\\n  right: \",\";\\n  top: \",\";\\n\"])),function(_ref6){var position=_ref6.position;return position==='below'?'left':'right';},function(_ref7){var outline=_ref7.outline;return outline?'solid':'none';},function(_ref8){var theme=_ref8.theme;return theme.colors.secondary;},function(_ref9){var position=_ref9.position;return position==='below'?'top':'bottom';},function(_ref10){var outline=_ref10.outline;return outline?'solid':'none';},function(_ref11){var theme=_ref11.theme;return theme.colors.secondary;},function(_ref12){var theme=_ref12.theme;return theme.colors.white;},function(_ref13){var beak=_ref13.beak;return beak==='left'&&'25px';},function(_ref14){var beak=_ref14.beak;return beak==='right'&&'25px';},function(_ref15){var position=_ref15.position;return position==='below'?'-10px':'calc(100% - 10px);';});var PatternContainer=styled.div(_templateObject4||(_templateObject4=_taggedTemplateLiteral([\"\\n  width: 100%;\\n  height: 100%;\\n  border-radius: 2px;\\n  overflow: hidden;\\n  background-color: \",\";\\n  position: absolute;\\n  top: \",\";\\n  left: \",\";\\n\"])),function(_ref16){var theme=_ref16.theme;return theme.colors.white;},function(_ref17){var position=_ref17.position;return position==='below'?'8px':'-8px';},function(_ref18){var align=_ref18.align;return align==='left'?'8px':'-8px';});export var Popover=function Popover(_ref19){var children=_ref19.children,className=_ref19.className,_ref19$align=_ref19.align,align=_ref19$align===void 0?'left':_ref19$align,_ref19$verticalOffset=_ref19.verticalOffset,verticalOffset=_ref19$verticalOffset===void 0?20:_ref19$verticalOffset,_ref19$horizontalOffs=_ref19.horizontalOffset,horizontalOffset=_ref19$horizontalOffs===void 0?0:_ref19$horizontalOffs,_ref19$outline=_ref19.outline,outline=_ref19$outline===void 0?false:_ref19$outline,_ref19$position=_ref19.position,position=_ref19$position===void 0?'below':_ref19$position,beak=_ref19.beak,isOpen=_ref19.isOpen,onRequestClose=_ref19.onRequestClose,targetRef=_ref19.targetRef,pattern=_ref19.pattern;var _useState=useState(),_useState2=_slicedToArray(_useState,2),targetRect=_useState2[0],setTargetRect=_useState2[1];var _useState3=useState(true),_useState4=_slicedToArray(_useState3,2),isInViewport=_useState4[0],setIsInViewport=_useState4[1];var _useWindowSize=useWindowSize(),width=_useWindowSize.width,height=_useWindowSize.height;var _useWindowScroll=useWindowScroll(),x=_useWindowScroll.x,y=_useWindowScroll.y;var getPopoverPosition=useCallback(function(){if(!targetRect)return{};var positions={above:Math.round(targetRect.top-verticalOffset),below:Math.round(targetRect.top+targetRect.height+verticalOffset)};var alignments={right:Math.round(window.scrollX+targetRect.right+horizontalOffset),left:Math.round(window.scrollX+targetRect.left-horizontalOffset)};return{top:positions[position],left:alignments[align]};},[targetRect,verticalOffset,horizontalOffset,align,position]);useEffect(function(){var _targetRef$current;setTargetRect(targetRef===null||targetRef===void 0?void 0:(_targetRef$current=targetRef.current)===null||_targetRef$current===void 0?void 0:_targetRef$current.getBoundingClientRect());},[targetRef,isOpen,width,height,x,y]);useEffect(function(){if(targetRect){var inView=targetRect.top>=0&&targetRect.left>=0&&targetRect.bottom<=(window.innerHeight||document.documentElement.clientHeight)&&targetRect.right<=(window.innerWidth||document.documentElement.clientWidth);setIsInViewport(inView);}if(!isInViewport)onRequestClose===null||onRequestClose===void 0?void 0:onRequestClose();},[targetRect,isInViewport,onRequestClose]);var handleClickOutside=useCallback(function(e){var _targetRef$current2;/**\n       * Allows targetRef to be or contain a button that toggles the popover open and closed.\n       * Without this check it would toggle closed then back open immediately.\n       */if((_targetRef$current2=targetRef.current)===null||_targetRef$current2===void 0?void 0:_targetRef$current2.contains(e.target))return;onRequestClose===null||onRequestClose===void 0?void 0:onRequestClose();},[onRequestClose,targetRef]);var popoverRef=useRef(null);if(!isOpen||!targetRef)return null;return/*#__PURE__*/_jsx(BodyPortal,{children:/*#__PURE__*/_jsx(FocusTrap,{allowPageInteraction:true,onClickOutside:handleClickOutside,onEscapeKey:onRequestClose,children:/*#__PURE__*/_jsxs(PopoverContainer,{position:position,align:align,ref:popoverRef,className:className,style:getPopoverPosition(),\"data-testid\":\"popover-content-container\",tabIndex:-1,children:[/*#__PURE__*/_jsxs(RaisedDiv,{outline:outline,children:[beak&&/*#__PURE__*/_jsx(Beak,{outline:outline,position:position,beak:beak,\"data-testid\":\"popover-beak\"}),children]}),pattern&&/*#__PURE__*/_jsx(PatternContainer,{position:position,align:align,children:/*#__PURE__*/_jsx(Pattern,{\"data-testid\":\"popover-pattern\",name:pattern,fit:true})})]})})});};","map":{"version":3,"sources":["/Users/akrah/Documents/dev/codefluent/src/components/gamut-overrides/Popover/index.tsx"],"names":["BodyPortal","FocusTrap","Pattern","styled","React","useCallback","useEffect","useRef","useState","useWindowScroll","useWindowSize","transform","right","left","above","below","PopoverContainer","div","position","align","RaisedDiv","outline","theme","colors","secondary","white","Beak","beak","PatternContainer","Popover","children","className","verticalOffset","horizontalOffset","isOpen","onRequestClose","targetRef","pattern","targetRect","setTargetRect","isInViewport","setIsInViewport","width","height","x","y","getPopoverPosition","positions","Math","round","top","alignments","window","scrollX","current","getBoundingClientRect","inView","bottom","innerHeight","document","documentElement","clientHeight","innerWidth","clientWidth","handleClickOutside","e","contains","target","popoverRef"],"mappings":"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","sourcesContent":["import { BodyPortal, FocusTrap, Pattern, PatternName } from '@codecademy/gamut';\nimport styled from '@emotion/styled';\nimport React, { useCallback, useEffect, useRef, useState } from 'react';\nimport { useWindowScroll, useWindowSize } from 'react-use';\n\ntype StyleProps = {\n  outline?: boolean;\n  position?: 'above' | 'below';\n  beak?: 'right' | 'left';\n  align?: 'right' | 'left';\n};\n\nconst transform = {\n  right: 'translateX(-100%)',\n  left: 'translateX(0%)',\n  above: 'translateY(-100%)',\n  below: 'translateY(0%)',\n};\n\nconst PopoverContainer = styled.div<StyleProps>`\n  position: fixed;\n  display: flex;\n  transform: ${({ position, align }) =>\n    position && align && `${transform[position]} ${transform[align]}`};\n`;\n\nconst RaisedDiv = styled.div<StyleProps>`\n  z-index: 1;\n  border-radius: 2px;\n  border: 1px ${({ outline }) => (outline ? 'solid' : 'none')}\n    ${({ theme }) => theme.colors.secondary};\n  background-color: ${({ theme }) => theme.colors.white};\n  ${({ outline }) =>\n    !outline &&\n    'box-shadow: 0 0 16px rgba(0, 0, 0, 0.1), 0 0 24px rgba(0, 0, 0, 0.15)'};\n`;\n\nconst Beak = styled.div<StyleProps>`\n  width: 20px;\n  height: 20px;\n  transform: rotate(45deg);\n  border-${({ position }) => (position === 'below' ? 'left' : 'right')}:\n    1px\n    ${({ outline }) => (outline ? 'solid' : 'none')}\n    ${({ theme }) => theme.colors.secondary};\n  border-${({ position }) => (position === 'below' ? 'top' : 'bottom')}:\n    1px\n    ${({ outline }) => (outline ? 'solid' : 'none')}\n    ${({ theme }) => theme.colors.secondary};\n  background-color: ${({ theme }) => theme.colors.white};\n  position: absolute;\n  left: ${({ beak }) => beak === 'left' && '25px'};\n  right: ${({ beak }) => beak === 'right' && '25px'};\n  top: ${({ position }) =>\n    position === 'below' ? '-10px' : 'calc(100% - 10px);'};\n`;\n\nconst PatternContainer = styled.div<StyleProps>`\n  width: 100%;\n  height: 100%;\n  border-radius: 2px;\n  overflow: hidden;\n  background-color: ${({ theme }) => theme.colors.white};\n  position: absolute;\n  top: ${({ position }) => (position === 'below' ? '8px' : '-8px')};\n  left: ${({ align }) => (align === 'left' ? '8px' : '-8px')};\n`;\n\nexport type PopoverProps = {\n  children: React.ReactElement<any>;\n  className?: string;\n  /**\n   * Which vertical edge of the source component to align against.\n   */\n  align?: 'left' | 'right';\n  /**\n   * Number of pixels to offset the popover vertically from the source component.\n   */\n  verticalOffset?: number;\n  /**\n   * Number of pixels to offset the popover horizontally from the source component.\n   */\n  horizontalOffset?: number;\n  /**\n   * Whether to add outline style (i.e. used for dropdowns and coachmarks).\n   */\n  outline?: boolean;\n  /**\n   * Which horizontal edge of the source componet to align against.\n   */\n  position?: 'above' | 'below';\n  /**\n   * Which side to position the beak. If not provided, beak will not be rendered.\n   */\n  beak?: 'left' | 'right';\n  /**\n   * Whether the popover is rendered.\n   */\n  isOpen: boolean;\n  /**\n   * Whether to add a pattern background.\n   */\n  pattern?: PatternName;\n  /**\n   * Called when the Popover requests to be closed,\n   * this could be due to clicking outside of the popover, or by clicking the escape key.\n   */\n  onRequestClose?: () => void;\n  /**\n   * The target element around which the popover will be positioned.\n   */\n  targetRef: React.RefObject<\n    Pick<HTMLDivElement, 'getBoundingClientRect' | 'contains'>\n  >;\n};\n\nexport const Popover: React.FC<PopoverProps> = ({\n  children,\n  className,\n  align = 'left',\n  verticalOffset = 20,\n  horizontalOffset = 0,\n  outline = false,\n  position = 'below',\n  beak,\n  isOpen,\n  onRequestClose,\n  targetRef,\n  pattern,\n}) => {\n  const [targetRect, setTargetRect] = useState<DOMRect>();\n  const [isInViewport, setIsInViewport] = useState(true);\n  const { width, height } = useWindowSize();\n  const { x, y } = useWindowScroll();\n\n  const getPopoverPosition = useCallback(() => {\n    if (!targetRect) return {};\n\n    const positions = {\n      above: Math.round(targetRect.top - verticalOffset),\n      below: Math.round(targetRect.top + targetRect.height + verticalOffset),\n    };\n    const alignments = {\n      right: Math.round(window.scrollX + targetRect.right + horizontalOffset),\n      left: Math.round(window.scrollX + targetRect.left - horizontalOffset),\n    };\n    return {\n      top: positions[position],\n      left: alignments[align],\n    };\n  }, [targetRect, verticalOffset, horizontalOffset, align, position]);\n\n  useEffect(() => {\n    setTargetRect(targetRef?.current?.getBoundingClientRect());\n  }, [targetRef, isOpen, width, height, x, y]);\n\n  useEffect(() => {\n    if (targetRect) {\n      const inView =\n        targetRect.top >= 0 &&\n        targetRect.left >= 0 &&\n        targetRect.bottom <=\n          (window.innerHeight || document.documentElement.clientHeight) &&\n        targetRect.right <=\n          (window.innerWidth || document.documentElement.clientWidth);\n      setIsInViewport(inView);\n    }\n    if (!isInViewport) onRequestClose?.();\n  }, [targetRect, isInViewport, onRequestClose]);\n\n  const handleClickOutside = useCallback(\n    (e) => {\n      /**\n       * Allows targetRef to be or contain a button that toggles the popover open and closed.\n       * Without this check it would toggle closed then back open immediately.\n       */\n      if (targetRef.current?.contains(e.target as Node)) return;\n\n      onRequestClose?.();\n    },\n    [onRequestClose, targetRef]\n  );\n\n  const popoverRef = useRef<HTMLDivElement>(null);\n\n  if (!isOpen || !targetRef) return null;\n\n  return (\n    <BodyPortal>\n      <FocusTrap\n        allowPageInteraction\n        onClickOutside={handleClickOutside}\n        onEscapeKey={onRequestClose}\n      >\n        <PopoverContainer\n          position={position}\n          align={align}\n          ref={popoverRef}\n          className={className}\n          style={getPopoverPosition()}\n          data-testid=\"popover-content-container\"\n          tabIndex={-1}\n        >\n          <RaisedDiv outline={outline}>\n            {beak && (\n              <Beak\n                outline={outline}\n                position={position}\n                beak={beak}\n                data-testid=\"popover-beak\"\n              />\n            )}\n            {children}\n          </RaisedDiv>\n          {pattern && (\n            <PatternContainer position={position} align={align}>\n              <Pattern data-testid=\"popover-pattern\" name={pattern} fit />\n            </PatternContainer>\n          )}\n        </PopoverContainer>\n      </FocusTrap>\n    </BodyPortal>\n  );\n};\n"]},"metadata":{},"sourceType":"module"}