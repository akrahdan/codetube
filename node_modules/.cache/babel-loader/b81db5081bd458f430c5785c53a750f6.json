{"ast":null,"code":"function ownKeys(object, enumerableOnly) {\n  var keys = Object.keys(object);\n\n  if (Object.getOwnPropertySymbols) {\n    var symbols = Object.getOwnPropertySymbols(object);\n    if (enumerableOnly) symbols = symbols.filter(function (sym) {\n      return Object.getOwnPropertyDescriptor(object, sym).enumerable;\n    });\n    keys.push.apply(keys, symbols);\n  }\n\n  return keys;\n}\n\nfunction _objectSpread(target) {\n  for (var i = 1; i < arguments.length; i++) {\n    var source = arguments[i] != null ? arguments[i] : {};\n\n    if (i % 2) {\n      ownKeys(Object(source), true).forEach(function (key) {\n        _defineProperty(target, key, source[key]);\n      });\n    } else if (Object.getOwnPropertyDescriptors) {\n      Object.defineProperties(target, Object.getOwnPropertyDescriptors(source));\n    } else {\n      ownKeys(Object(source)).forEach(function (key) {\n        Object.defineProperty(target, key, Object.getOwnPropertyDescriptor(source, key));\n      });\n    }\n  }\n\n  return target;\n}\n\nfunction _defineProperty(obj, key, value) {\n  if (key in obj) {\n    Object.defineProperty(obj, key, {\n      value: value,\n      enumerable: true,\n      configurable: true,\n      writable: true\n    });\n  } else {\n    obj[key] = value;\n  }\n\n  return obj;\n}\n\nfunction _objectWithoutProperties(source, excluded) {\n  if (source == null) return {};\n\n  var target = _objectWithoutPropertiesLoose(source, excluded);\n\n  var key, i;\n\n  if (Object.getOwnPropertySymbols) {\n    var sourceSymbolKeys = Object.getOwnPropertySymbols(source);\n\n    for (i = 0; i < sourceSymbolKeys.length; i++) {\n      key = sourceSymbolKeys[i];\n      if (excluded.indexOf(key) >= 0) continue;\n      if (!Object.prototype.propertyIsEnumerable.call(source, key)) continue;\n      target[key] = source[key];\n    }\n  }\n\n  return target;\n}\n\nfunction _objectWithoutPropertiesLoose(source, excluded) {\n  if (source == null) return {};\n  var target = {};\n  var sourceKeys = Object.keys(source);\n  var key, i;\n\n  for (i = 0; i < sourceKeys.length; i++) {\n    key = sourceKeys[i];\n    if (excluded.indexOf(key) >= 0) continue;\n    target[key] = source[key];\n  }\n\n  return target;\n}\n\nimport { preResolve, resolve, postResolve } from './resolve';\nimport { getActiveItem } from './utils';\nvar lastStalledId = null;\nexport function onInput(_ref) {\n  var event = _ref.event,\n      _ref$nextState = _ref.nextState,\n      nextState = _ref$nextState === void 0 ? {} : _ref$nextState,\n      props = _ref.props,\n      query = _ref.query,\n      refresh = _ref.refresh,\n      store = _ref.store,\n      setters = _objectWithoutProperties(_ref, [\"event\", \"nextState\", \"props\", \"query\", \"refresh\", \"store\"]);\n\n  if (lastStalledId) {\n    props.environment.clearTimeout(lastStalledId);\n  }\n\n  var setCollections = setters.setCollections,\n      setIsOpen = setters.setIsOpen,\n      setQuery = setters.setQuery,\n      setActiveItemId = setters.setActiveItemId,\n      setStatus = setters.setStatus;\n  setQuery(query);\n  setActiveItemId(props.defaultActiveItemId);\n\n  if (!query && props.openOnFocus === false) {\n    var _nextState$isOpen;\n\n    setStatus('idle');\n    setCollections(store.getState().collections.map(function (collection) {\n      return _objectSpread(_objectSpread({}, collection), {}, {\n        items: []\n      });\n    }));\n    setIsOpen((_nextState$isOpen = nextState.isOpen) !== null && _nextState$isOpen !== void 0 ? _nextState$isOpen : props.shouldPanelOpen({\n      state: store.getState()\n    }));\n    return Promise.resolve();\n  }\n\n  setStatus('loading');\n  lastStalledId = props.environment.setTimeout(function () {\n    setStatus('stalled');\n  }, props.stallThreshold);\n  return props.getSources(_objectSpread({\n    query: query,\n    refresh: refresh,\n    state: store.getState()\n  }, setters)).then(function (sources) {\n    setStatus('loading');\n    return Promise.all(sources.map(function (source) {\n      return Promise.resolve(source.getItems(_objectSpread({\n        query: query,\n        refresh: refresh,\n        state: store.getState()\n      }, setters))).then(function (itemsOrDescription) {\n        return preResolve(itemsOrDescription, source.sourceId);\n      });\n    })).then(resolve).then(function (responses) {\n      return postResolve(responses, sources);\n    }).then(function (collections) {\n      var _nextState$isOpen2;\n\n      setStatus('idle');\n      setCollections(collections);\n      var isPanelOpen = props.shouldPanelOpen({\n        state: store.getState()\n      });\n      setIsOpen((_nextState$isOpen2 = nextState.isOpen) !== null && _nextState$isOpen2 !== void 0 ? _nextState$isOpen2 : props.openOnFocus && !query && isPanelOpen || isPanelOpen);\n      var highlightedItem = getActiveItem(store.getState());\n\n      if (store.getState().activeItemId !== null && highlightedItem) {\n        var item = highlightedItem.item,\n            itemInputValue = highlightedItem.itemInputValue,\n            itemUrl = highlightedItem.itemUrl,\n            source = highlightedItem.source;\n        source.onActive(_objectSpread({\n          event: event,\n          item: item,\n          itemInputValue: itemInputValue,\n          itemUrl: itemUrl,\n          refresh: refresh,\n          source: source,\n          state: store.getState()\n        }, setters));\n      }\n    }).finally(function () {\n      if (lastStalledId) {\n        props.environment.clearTimeout(lastStalledId);\n      }\n    });\n  });\n}","map":{"version":3,"sources":["/Users/akrah/Documents/dev/readux/src/codefluent/node_modules/@algolia/autocomplete-core/dist/esm/onInput.js"],"names":["ownKeys","object","enumerableOnly","keys","Object","getOwnPropertySymbols","symbols","filter","sym","getOwnPropertyDescriptor","enumerable","push","apply","_objectSpread","target","i","arguments","length","source","forEach","key","_defineProperty","getOwnPropertyDescriptors","defineProperties","defineProperty","obj","value","configurable","writable","_objectWithoutProperties","excluded","_objectWithoutPropertiesLoose","sourceSymbolKeys","indexOf","prototype","propertyIsEnumerable","call","sourceKeys","preResolve","resolve","postResolve","getActiveItem","lastStalledId","onInput","_ref","event","_ref$nextState","nextState","props","query","refresh","store","setters","environment","clearTimeout","setCollections","setIsOpen","setQuery","setActiveItemId","setStatus","defaultActiveItemId","openOnFocus","_nextState$isOpen","getState","collections","map","collection","items","isOpen","shouldPanelOpen","state","Promise","setTimeout","stallThreshold","getSources","then","sources","all","getItems","itemsOrDescription","sourceId","responses","_nextState$isOpen2","isPanelOpen","highlightedItem","activeItemId","item","itemInputValue","itemUrl","onActive","finally"],"mappings":"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","sourcesContent":["function ownKeys(object, enumerableOnly) { var keys = Object.keys(object); if (Object.getOwnPropertySymbols) { var symbols = Object.getOwnPropertySymbols(object); if (enumerableOnly) symbols = symbols.filter(function (sym) { return Object.getOwnPropertyDescriptor(object, sym).enumerable; }); keys.push.apply(keys, symbols); } return keys; }\n\nfunction _objectSpread(target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i] != null ? arguments[i] : {}; if (i % 2) { ownKeys(Object(source), true).forEach(function (key) { _defineProperty(target, key, source[key]); }); } else if (Object.getOwnPropertyDescriptors) { Object.defineProperties(target, Object.getOwnPropertyDescriptors(source)); } else { ownKeys(Object(source)).forEach(function (key) { Object.defineProperty(target, key, Object.getOwnPropertyDescriptor(source, key)); }); } } return target; }\n\nfunction _defineProperty(obj, key, value) { if (key in obj) { Object.defineProperty(obj, key, { value: value, enumerable: true, configurable: true, writable: true }); } else { obj[key] = value; } return obj; }\n\nfunction _objectWithoutProperties(source, excluded) { if (source == null) return {}; var target = _objectWithoutPropertiesLoose(source, excluded); var key, i; if (Object.getOwnPropertySymbols) { var sourceSymbolKeys = Object.getOwnPropertySymbols(source); for (i = 0; i < sourceSymbolKeys.length; i++) { key = sourceSymbolKeys[i]; if (excluded.indexOf(key) >= 0) continue; if (!Object.prototype.propertyIsEnumerable.call(source, key)) continue; target[key] = source[key]; } } return target; }\n\nfunction _objectWithoutPropertiesLoose(source, excluded) { if (source == null) return {}; var target = {}; var sourceKeys = Object.keys(source); var key, i; for (i = 0; i < sourceKeys.length; i++) { key = sourceKeys[i]; if (excluded.indexOf(key) >= 0) continue; target[key] = source[key]; } return target; }\n\nimport { preResolve, resolve, postResolve } from './resolve';\nimport { getActiveItem } from './utils';\nvar lastStalledId = null;\nexport function onInput(_ref) {\n  var event = _ref.event,\n      _ref$nextState = _ref.nextState,\n      nextState = _ref$nextState === void 0 ? {} : _ref$nextState,\n      props = _ref.props,\n      query = _ref.query,\n      refresh = _ref.refresh,\n      store = _ref.store,\n      setters = _objectWithoutProperties(_ref, [\"event\", \"nextState\", \"props\", \"query\", \"refresh\", \"store\"]);\n\n  if (lastStalledId) {\n    props.environment.clearTimeout(lastStalledId);\n  }\n\n  var setCollections = setters.setCollections,\n      setIsOpen = setters.setIsOpen,\n      setQuery = setters.setQuery,\n      setActiveItemId = setters.setActiveItemId,\n      setStatus = setters.setStatus;\n  setQuery(query);\n  setActiveItemId(props.defaultActiveItemId);\n\n  if (!query && props.openOnFocus === false) {\n    var _nextState$isOpen;\n\n    setStatus('idle');\n    setCollections(store.getState().collections.map(function (collection) {\n      return _objectSpread(_objectSpread({}, collection), {}, {\n        items: []\n      });\n    }));\n    setIsOpen((_nextState$isOpen = nextState.isOpen) !== null && _nextState$isOpen !== void 0 ? _nextState$isOpen : props.shouldPanelOpen({\n      state: store.getState()\n    }));\n    return Promise.resolve();\n  }\n\n  setStatus('loading');\n  lastStalledId = props.environment.setTimeout(function () {\n    setStatus('stalled');\n  }, props.stallThreshold);\n  return props.getSources(_objectSpread({\n    query: query,\n    refresh: refresh,\n    state: store.getState()\n  }, setters)).then(function (sources) {\n    setStatus('loading');\n    return Promise.all(sources.map(function (source) {\n      return Promise.resolve(source.getItems(_objectSpread({\n        query: query,\n        refresh: refresh,\n        state: store.getState()\n      }, setters))).then(function (itemsOrDescription) {\n        return preResolve(itemsOrDescription, source.sourceId);\n      });\n    })).then(resolve).then(function (responses) {\n      return postResolve(responses, sources);\n    }).then(function (collections) {\n      var _nextState$isOpen2;\n\n      setStatus('idle');\n      setCollections(collections);\n      var isPanelOpen = props.shouldPanelOpen({\n        state: store.getState()\n      });\n      setIsOpen((_nextState$isOpen2 = nextState.isOpen) !== null && _nextState$isOpen2 !== void 0 ? _nextState$isOpen2 : props.openOnFocus && !query && isPanelOpen || isPanelOpen);\n      var highlightedItem = getActiveItem(store.getState());\n\n      if (store.getState().activeItemId !== null && highlightedItem) {\n        var item = highlightedItem.item,\n            itemInputValue = highlightedItem.itemInputValue,\n            itemUrl = highlightedItem.itemUrl,\n            source = highlightedItem.source;\n        source.onActive(_objectSpread({\n          event: event,\n          item: item,\n          itemInputValue: itemInputValue,\n          itemUrl: itemUrl,\n          refresh: refresh,\n          source: source,\n          state: store.getState()\n        }, setters));\n      }\n    }).finally(function () {\n      if (lastStalledId) {\n        props.environment.clearTimeout(lastStalledId);\n      }\n    });\n  });\n}"]},"metadata":{},"sourceType":"module"}