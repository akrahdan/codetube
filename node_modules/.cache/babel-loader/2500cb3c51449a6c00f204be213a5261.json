{"ast":null,"code":"function ownKeys(object, enumerableOnly) {\n  var keys = Object.keys(object);\n\n  if (Object.getOwnPropertySymbols) {\n    var symbols = Object.getOwnPropertySymbols(object);\n    if (enumerableOnly) symbols = symbols.filter(function (sym) {\n      return Object.getOwnPropertyDescriptor(object, sym).enumerable;\n    });\n    keys.push.apply(keys, symbols);\n  }\n\n  return keys;\n}\n\nfunction _objectSpread(target) {\n  for (var i = 1; i < arguments.length; i++) {\n    var source = arguments[i] != null ? arguments[i] : {};\n\n    if (i % 2) {\n      ownKeys(Object(source), true).forEach(function (key) {\n        _defineProperty(target, key, source[key]);\n      });\n    } else if (Object.getOwnPropertyDescriptors) {\n      Object.defineProperties(target, Object.getOwnPropertyDescriptors(source));\n    } else {\n      ownKeys(Object(source)).forEach(function (key) {\n        Object.defineProperty(target, key, Object.getOwnPropertyDescriptor(source, key));\n      });\n    }\n  }\n\n  return target;\n}\n\nfunction _defineProperty(obj, key, value) {\n  if (key in obj) {\n    Object.defineProperty(obj, key, {\n      value: value,\n      enumerable: true,\n      configurable: true,\n      writable: true\n    });\n  } else {\n    obj[key] = value;\n  }\n\n  return obj;\n}\n\nimport { createAutocomplete } from '@algolia/autocomplete-core';\nimport { createRef, debounce, getItemsCount } from '@algolia/autocomplete-shared';\nimport { createAutocompleteDom } from './createAutocompleteDom';\nimport { createEffectWrapper } from './createEffectWrapper';\nimport { createReactiveWrapper } from './createReactiveWrapper';\nimport { getDefaultOptions } from './getDefaultOptions';\nimport { getPanelPlacementStyle } from './getPanelPlacementStyle';\nimport { renderPanel, renderSearchBox } from './render';\nimport { mergeDeep, setProperties } from './utils';\nexport function autocomplete(options) {\n  var _createEffectWrapper = createEffectWrapper(),\n      runEffect = _createEffectWrapper.runEffect,\n      cleanupEffects = _createEffectWrapper.cleanupEffects,\n      runEffects = _createEffectWrapper.runEffects;\n\n  var _createReactiveWrappe = createReactiveWrapper(),\n      reactive = _createReactiveWrappe.reactive,\n      runReactives = _createReactiveWrappe.runReactives;\n\n  var hasNoResultsSourceTemplateRef = createRef(false);\n  var optionsRef = createRef(options);\n  var onStateChangeRef = createRef(undefined);\n  var props = reactive(function () {\n    return getDefaultOptions(optionsRef.current);\n  });\n  var isDetached = reactive(function () {\n    return props.value.core.environment.matchMedia(props.value.renderer.detachedMediaQuery).matches;\n  });\n  var autocomplete = reactive(function () {\n    return createAutocomplete(_objectSpread(_objectSpread({}, props.value.core), {}, {\n      onStateChange: function onStateChange(params) {\n        var _onStateChangeRef$cur, _props$value$core$onS, _props$value$core;\n\n        hasNoResultsSourceTemplateRef.current = params.state.collections.some(function (collection) {\n          return collection.source.templates.noResults;\n        });\n        (_onStateChangeRef$cur = onStateChangeRef.current) === null || _onStateChangeRef$cur === void 0 ? void 0 : _onStateChangeRef$cur.call(onStateChangeRef, params);\n        (_props$value$core$onS = (_props$value$core = props.value.core).onStateChange) === null || _props$value$core$onS === void 0 ? void 0 : _props$value$core$onS.call(_props$value$core, params);\n      },\n      shouldPanelOpen: optionsRef.current.shouldPanelOpen || function (_ref) {\n        var state = _ref.state;\n\n        if (isDetached.value) {\n          return true;\n        }\n\n        var hasItems = getItemsCount(state) > 0;\n\n        if (!props.value.core.openOnFocus && !state.query) {\n          return hasItems;\n        }\n\n        var hasNoResultsTemplate = Boolean(hasNoResultsSourceTemplateRef.current || props.value.renderer.renderNoResults);\n        return !hasItems && hasNoResultsTemplate || hasItems;\n      }\n    }));\n  });\n  var lastStateRef = createRef(_objectSpread({\n    collections: [],\n    completion: null,\n    context: {},\n    isOpen: false,\n    query: '',\n    activeItemId: null,\n    status: 'idle'\n  }, props.value.core.initialState));\n  var propGetters = {\n    getEnvironmentProps: props.value.renderer.getEnvironmentProps,\n    getFormProps: props.value.renderer.getFormProps,\n    getInputProps: props.value.renderer.getInputProps,\n    getItemProps: props.value.renderer.getItemProps,\n    getLabelProps: props.value.renderer.getLabelProps,\n    getListProps: props.value.renderer.getListProps,\n    getPanelProps: props.value.renderer.getPanelProps,\n    getRootProps: props.value.renderer.getRootProps\n  };\n  var autocompleteScopeApi = {\n    setActiveItemId: autocomplete.value.setActiveItemId,\n    setQuery: autocomplete.value.setQuery,\n    setCollections: autocomplete.value.setCollections,\n    setIsOpen: autocomplete.value.setIsOpen,\n    setStatus: autocomplete.value.setStatus,\n    setContext: autocomplete.value.setContext,\n    refresh: autocomplete.value.refresh\n  };\n  var dom = reactive(function () {\n    return createAutocompleteDom({\n      autocomplete: autocomplete.value,\n      autocompleteScopeApi: autocompleteScopeApi,\n      classNames: props.value.renderer.classNames,\n      environment: props.value.core.environment,\n      isDetached: isDetached.value,\n      placeholder: props.value.core.placeholder,\n      propGetters: propGetters,\n      setIsModalOpen: setIsModalOpen,\n      state: lastStateRef.current,\n      translations: props.value.renderer.translations\n    });\n  });\n\n  function setPanelPosition() {\n    setProperties(dom.value.panel, {\n      style: isDetached.value ? {} : getPanelPlacementStyle({\n        panelPlacement: props.value.renderer.panelPlacement,\n        container: dom.value.root,\n        form: dom.value.form,\n        environment: props.value.core.environment\n      })\n    });\n  }\n\n  function scheduleRender(state) {\n    lastStateRef.current = state;\n    var renderProps = {\n      autocomplete: autocomplete.value,\n      autocompleteScopeApi: autocompleteScopeApi,\n      classNames: props.value.renderer.classNames,\n      components: props.value.renderer.components,\n      container: props.value.renderer.container,\n      createElement: props.value.renderer.renderer.createElement,\n      dom: dom.value,\n      Fragment: props.value.renderer.renderer.Fragment,\n      panelContainer: isDetached.value ? dom.value.detachedContainer : props.value.renderer.panelContainer,\n      propGetters: propGetters,\n      state: lastStateRef.current\n    };\n    var render = !getItemsCount(state) && !hasNoResultsSourceTemplateRef.current && props.value.renderer.renderNoResults || props.value.renderer.render;\n    renderSearchBox(renderProps);\n    renderPanel(render, renderProps);\n  }\n\n  runEffect(function () {\n    var environmentProps = autocomplete.value.getEnvironmentProps({\n      formElement: dom.value.form,\n      panelElement: dom.value.panel,\n      inputElement: dom.value.input\n    });\n    setProperties(props.value.core.environment, environmentProps);\n    return function () {\n      setProperties(props.value.core.environment, Object.keys(environmentProps).reduce(function (acc, key) {\n        return _objectSpread(_objectSpread({}, acc), {}, _defineProperty({}, key, undefined));\n      }, {}));\n    };\n  });\n  runEffect(function () {\n    var panelContainerElement = isDetached.value ? props.value.core.environment.document.body : props.value.renderer.panelContainer;\n    var panelElement = isDetached.value ? dom.value.detachedOverlay : dom.value.panel;\n\n    if (isDetached.value && lastStateRef.current.isOpen) {\n      setIsModalOpen(true);\n    }\n\n    scheduleRender(lastStateRef.current);\n    return function () {\n      if (panelContainerElement.contains(panelElement)) {\n        panelContainerElement.removeChild(panelElement);\n      }\n    };\n  });\n  runEffect(function () {\n    var containerElement = props.value.renderer.container;\n    containerElement.appendChild(dom.value.root);\n    return function () {\n      containerElement.removeChild(dom.value.root);\n    };\n  });\n  runEffect(function () {\n    var debouncedRender = debounce(function (_ref2) {\n      var state = _ref2.state;\n      scheduleRender(state);\n    }, 0);\n\n    onStateChangeRef.current = function (_ref3) {\n      var state = _ref3.state,\n          prevState = _ref3.prevState;\n\n      if (isDetached.value && prevState.isOpen !== state.isOpen) {\n        setIsModalOpen(state.isOpen);\n      } // The outer DOM might have changed since the last time the panel was\n      // positioned. The layout might have shifted vertically for instance.\n      // It's therefore safer to re-calculate the panel position before opening\n      // it again.\n\n\n      if (!isDetached.value && state.isOpen && !prevState.isOpen) {\n        setPanelPosition();\n      } // We scroll to the top of the panel whenever the query changes (i.e. new\n      // results come in) so that users don't have to.\n\n\n      if (state.query !== prevState.query) {\n        var scrollablePanels = props.value.core.environment.document.querySelectorAll('.aa-Panel--scrollable');\n        scrollablePanels.forEach(function (scrollablePanel) {\n          if (scrollablePanel.scrollTop !== 0) {\n            scrollablePanel.scrollTop = 0;\n          }\n        });\n      }\n\n      debouncedRender({\n        state: state\n      });\n    };\n\n    return function () {\n      onStateChangeRef.current = undefined;\n    };\n  });\n  runEffect(function () {\n    var onResize = debounce(function () {\n      var previousIsDetached = isDetached.value;\n      isDetached.value = props.value.core.environment.matchMedia(props.value.renderer.detachedMediaQuery).matches;\n\n      if (previousIsDetached !== isDetached.value) {\n        update({});\n      } else {\n        requestAnimationFrame(setPanelPosition);\n      }\n    }, 20);\n    props.value.core.environment.addEventListener('resize', onResize);\n    return function () {\n      props.value.core.environment.removeEventListener('resize', onResize);\n    };\n  });\n  runEffect(function () {\n    if (!isDetached.value) {\n      return function () {};\n    }\n\n    function toggleModalClassname(isActive) {\n      dom.value.detachedContainer.classList.toggle('aa-DetachedContainer--modal', isActive);\n    }\n\n    function onChange(event) {\n      toggleModalClassname(event.matches);\n    }\n\n    var isModalDetachedMql = props.value.core.environment.matchMedia(getComputedStyle(props.value.core.environment.document.documentElement).getPropertyValue('--aa-detached-modal-media-query'));\n    toggleModalClassname(isModalDetachedMql.matches); // Prior to Safari 14, `MediaQueryList` isn't based on `EventTarget`,\n    // so we must use `addListener` and `removeListener` to observe media query lists.\n    // See https://developer.mozilla.org/en-US/docs/Web/API/MediaQueryList/addListener\n\n    var hasModernEventListener = Boolean(isModalDetachedMql.addEventListener);\n    hasModernEventListener ? isModalDetachedMql.addEventListener('change', onChange) : isModalDetachedMql.addListener(onChange);\n    return function () {\n      hasModernEventListener ? isModalDetachedMql.removeEventListener('change', onChange) : isModalDetachedMql.removeListener(onChange);\n    };\n  });\n  runEffect(function () {\n    requestAnimationFrame(setPanelPosition);\n    return function () {};\n  });\n\n  function destroy() {\n    cleanupEffects();\n  }\n\n  function update() {\n    var updatedOptions = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : {};\n    cleanupEffects();\n    optionsRef.current = mergeDeep(props.value.renderer, props.value.core, {\n      initialState: lastStateRef.current\n    }, updatedOptions);\n    runReactives();\n    runEffects();\n    autocomplete.value.refresh().then(function () {\n      scheduleRender(lastStateRef.current);\n    });\n  }\n\n  function setIsModalOpen(value) {\n    requestAnimationFrame(function () {\n      var prevValue = props.value.core.environment.document.body.contains(dom.value.detachedOverlay);\n\n      if (value === prevValue) {\n        return;\n      }\n\n      if (value) {\n        props.value.core.environment.document.body.appendChild(dom.value.detachedOverlay);\n        props.value.core.environment.document.body.classList.add('aa-Detached');\n        dom.value.input.focus();\n      } else {\n        props.value.core.environment.document.body.removeChild(dom.value.detachedOverlay);\n        props.value.core.environment.document.body.classList.remove('aa-Detached');\n        autocomplete.value.setQuery('');\n        autocomplete.value.refresh();\n      }\n    });\n  }\n\n  return _objectSpread(_objectSpread({}, autocompleteScopeApi), {}, {\n    update: update,\n    destroy: destroy\n  });\n}","map":{"version":3,"sources":["/Users/akrah/Documents/dev/readux/src/codefluent/node_modules/@algolia/autocomplete-js/dist/esm/autocomplete.js"],"names":["ownKeys","object","enumerableOnly","keys","Object","getOwnPropertySymbols","symbols","filter","sym","getOwnPropertyDescriptor","enumerable","push","apply","_objectSpread","target","i","arguments","length","source","forEach","key","_defineProperty","getOwnPropertyDescriptors","defineProperties","defineProperty","obj","value","configurable","writable","createAutocomplete","createRef","debounce","getItemsCount","createAutocompleteDom","createEffectWrapper","createReactiveWrapper","getDefaultOptions","getPanelPlacementStyle","renderPanel","renderSearchBox","mergeDeep","setProperties","autocomplete","options","_createEffectWrapper","runEffect","cleanupEffects","runEffects","_createReactiveWrappe","reactive","runReactives","hasNoResultsSourceTemplateRef","optionsRef","onStateChangeRef","undefined","props","current","isDetached","core","environment","matchMedia","renderer","detachedMediaQuery","matches","onStateChange","params","_onStateChangeRef$cur","_props$value$core$onS","_props$value$core","state","collections","some","collection","templates","noResults","call","shouldPanelOpen","_ref","hasItems","openOnFocus","query","hasNoResultsTemplate","Boolean","renderNoResults","lastStateRef","completion","context","isOpen","activeItemId","status","initialState","propGetters","getEnvironmentProps","getFormProps","getInputProps","getItemProps","getLabelProps","getListProps","getPanelProps","getRootProps","autocompleteScopeApi","setActiveItemId","setQuery","setCollections","setIsOpen","setStatus","setContext","refresh","dom","classNames","placeholder","setIsModalOpen","translations","setPanelPosition","panel","style","panelPlacement","container","root","form","scheduleRender","renderProps","components","createElement","Fragment","panelContainer","detachedContainer","render","environmentProps","formElement","panelElement","inputElement","input","reduce","acc","panelContainerElement","document","body","detachedOverlay","contains","removeChild","containerElement","appendChild","debouncedRender","_ref2","_ref3","prevState","scrollablePanels","querySelectorAll","scrollablePanel","scrollTop","onResize","previousIsDetached","update","requestAnimationFrame","addEventListener","removeEventListener","toggleModalClassname","isActive","classList","toggle","onChange","event","isModalDetachedMql","getComputedStyle","documentElement","getPropertyValue","hasModernEventListener","addListener","removeListener","destroy","updatedOptions","then","prevValue","add","focus","remove"],"mappings":"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","sourcesContent":["function ownKeys(object, enumerableOnly) { var keys = Object.keys(object); if (Object.getOwnPropertySymbols) { var symbols = Object.getOwnPropertySymbols(object); if (enumerableOnly) symbols = symbols.filter(function (sym) { return Object.getOwnPropertyDescriptor(object, sym).enumerable; }); keys.push.apply(keys, symbols); } return keys; }\n\nfunction _objectSpread(target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i] != null ? arguments[i] : {}; if (i % 2) { ownKeys(Object(source), true).forEach(function (key) { _defineProperty(target, key, source[key]); }); } else if (Object.getOwnPropertyDescriptors) { Object.defineProperties(target, Object.getOwnPropertyDescriptors(source)); } else { ownKeys(Object(source)).forEach(function (key) { Object.defineProperty(target, key, Object.getOwnPropertyDescriptor(source, key)); }); } } return target; }\n\nfunction _defineProperty(obj, key, value) { if (key in obj) { Object.defineProperty(obj, key, { value: value, enumerable: true, configurable: true, writable: true }); } else { obj[key] = value; } return obj; }\n\nimport { createAutocomplete } from '@algolia/autocomplete-core';\nimport { createRef, debounce, getItemsCount } from '@algolia/autocomplete-shared';\nimport { createAutocompleteDom } from './createAutocompleteDom';\nimport { createEffectWrapper } from './createEffectWrapper';\nimport { createReactiveWrapper } from './createReactiveWrapper';\nimport { getDefaultOptions } from './getDefaultOptions';\nimport { getPanelPlacementStyle } from './getPanelPlacementStyle';\nimport { renderPanel, renderSearchBox } from './render';\nimport { mergeDeep, setProperties } from './utils';\nexport function autocomplete(options) {\n  var _createEffectWrapper = createEffectWrapper(),\n      runEffect = _createEffectWrapper.runEffect,\n      cleanupEffects = _createEffectWrapper.cleanupEffects,\n      runEffects = _createEffectWrapper.runEffects;\n\n  var _createReactiveWrappe = createReactiveWrapper(),\n      reactive = _createReactiveWrappe.reactive,\n      runReactives = _createReactiveWrappe.runReactives;\n\n  var hasNoResultsSourceTemplateRef = createRef(false);\n  var optionsRef = createRef(options);\n  var onStateChangeRef = createRef(undefined);\n  var props = reactive(function () {\n    return getDefaultOptions(optionsRef.current);\n  });\n  var isDetached = reactive(function () {\n    return props.value.core.environment.matchMedia(props.value.renderer.detachedMediaQuery).matches;\n  });\n  var autocomplete = reactive(function () {\n    return createAutocomplete(_objectSpread(_objectSpread({}, props.value.core), {}, {\n      onStateChange: function onStateChange(params) {\n        var _onStateChangeRef$cur, _props$value$core$onS, _props$value$core;\n\n        hasNoResultsSourceTemplateRef.current = params.state.collections.some(function (collection) {\n          return collection.source.templates.noResults;\n        });\n        (_onStateChangeRef$cur = onStateChangeRef.current) === null || _onStateChangeRef$cur === void 0 ? void 0 : _onStateChangeRef$cur.call(onStateChangeRef, params);\n        (_props$value$core$onS = (_props$value$core = props.value.core).onStateChange) === null || _props$value$core$onS === void 0 ? void 0 : _props$value$core$onS.call(_props$value$core, params);\n      },\n      shouldPanelOpen: optionsRef.current.shouldPanelOpen || function (_ref) {\n        var state = _ref.state;\n\n        if (isDetached.value) {\n          return true;\n        }\n\n        var hasItems = getItemsCount(state) > 0;\n\n        if (!props.value.core.openOnFocus && !state.query) {\n          return hasItems;\n        }\n\n        var hasNoResultsTemplate = Boolean(hasNoResultsSourceTemplateRef.current || props.value.renderer.renderNoResults);\n        return !hasItems && hasNoResultsTemplate || hasItems;\n      }\n    }));\n  });\n  var lastStateRef = createRef(_objectSpread({\n    collections: [],\n    completion: null,\n    context: {},\n    isOpen: false,\n    query: '',\n    activeItemId: null,\n    status: 'idle'\n  }, props.value.core.initialState));\n  var propGetters = {\n    getEnvironmentProps: props.value.renderer.getEnvironmentProps,\n    getFormProps: props.value.renderer.getFormProps,\n    getInputProps: props.value.renderer.getInputProps,\n    getItemProps: props.value.renderer.getItemProps,\n    getLabelProps: props.value.renderer.getLabelProps,\n    getListProps: props.value.renderer.getListProps,\n    getPanelProps: props.value.renderer.getPanelProps,\n    getRootProps: props.value.renderer.getRootProps\n  };\n  var autocompleteScopeApi = {\n    setActiveItemId: autocomplete.value.setActiveItemId,\n    setQuery: autocomplete.value.setQuery,\n    setCollections: autocomplete.value.setCollections,\n    setIsOpen: autocomplete.value.setIsOpen,\n    setStatus: autocomplete.value.setStatus,\n    setContext: autocomplete.value.setContext,\n    refresh: autocomplete.value.refresh\n  };\n  var dom = reactive(function () {\n    return createAutocompleteDom({\n      autocomplete: autocomplete.value,\n      autocompleteScopeApi: autocompleteScopeApi,\n      classNames: props.value.renderer.classNames,\n      environment: props.value.core.environment,\n      isDetached: isDetached.value,\n      placeholder: props.value.core.placeholder,\n      propGetters: propGetters,\n      setIsModalOpen: setIsModalOpen,\n      state: lastStateRef.current,\n      translations: props.value.renderer.translations\n    });\n  });\n\n  function setPanelPosition() {\n    setProperties(dom.value.panel, {\n      style: isDetached.value ? {} : getPanelPlacementStyle({\n        panelPlacement: props.value.renderer.panelPlacement,\n        container: dom.value.root,\n        form: dom.value.form,\n        environment: props.value.core.environment\n      })\n    });\n  }\n\n  function scheduleRender(state) {\n    lastStateRef.current = state;\n    var renderProps = {\n      autocomplete: autocomplete.value,\n      autocompleteScopeApi: autocompleteScopeApi,\n      classNames: props.value.renderer.classNames,\n      components: props.value.renderer.components,\n      container: props.value.renderer.container,\n      createElement: props.value.renderer.renderer.createElement,\n      dom: dom.value,\n      Fragment: props.value.renderer.renderer.Fragment,\n      panelContainer: isDetached.value ? dom.value.detachedContainer : props.value.renderer.panelContainer,\n      propGetters: propGetters,\n      state: lastStateRef.current\n    };\n    var render = !getItemsCount(state) && !hasNoResultsSourceTemplateRef.current && props.value.renderer.renderNoResults || props.value.renderer.render;\n    renderSearchBox(renderProps);\n    renderPanel(render, renderProps);\n  }\n\n  runEffect(function () {\n    var environmentProps = autocomplete.value.getEnvironmentProps({\n      formElement: dom.value.form,\n      panelElement: dom.value.panel,\n      inputElement: dom.value.input\n    });\n    setProperties(props.value.core.environment, environmentProps);\n    return function () {\n      setProperties(props.value.core.environment, Object.keys(environmentProps).reduce(function (acc, key) {\n        return _objectSpread(_objectSpread({}, acc), {}, _defineProperty({}, key, undefined));\n      }, {}));\n    };\n  });\n  runEffect(function () {\n    var panelContainerElement = isDetached.value ? props.value.core.environment.document.body : props.value.renderer.panelContainer;\n    var panelElement = isDetached.value ? dom.value.detachedOverlay : dom.value.panel;\n\n    if (isDetached.value && lastStateRef.current.isOpen) {\n      setIsModalOpen(true);\n    }\n\n    scheduleRender(lastStateRef.current);\n    return function () {\n      if (panelContainerElement.contains(panelElement)) {\n        panelContainerElement.removeChild(panelElement);\n      }\n    };\n  });\n  runEffect(function () {\n    var containerElement = props.value.renderer.container;\n    containerElement.appendChild(dom.value.root);\n    return function () {\n      containerElement.removeChild(dom.value.root);\n    };\n  });\n  runEffect(function () {\n    var debouncedRender = debounce(function (_ref2) {\n      var state = _ref2.state;\n      scheduleRender(state);\n    }, 0);\n\n    onStateChangeRef.current = function (_ref3) {\n      var state = _ref3.state,\n          prevState = _ref3.prevState;\n\n      if (isDetached.value && prevState.isOpen !== state.isOpen) {\n        setIsModalOpen(state.isOpen);\n      } // The outer DOM might have changed since the last time the panel was\n      // positioned. The layout might have shifted vertically for instance.\n      // It's therefore safer to re-calculate the panel position before opening\n      // it again.\n\n\n      if (!isDetached.value && state.isOpen && !prevState.isOpen) {\n        setPanelPosition();\n      } // We scroll to the top of the panel whenever the query changes (i.e. new\n      // results come in) so that users don't have to.\n\n\n      if (state.query !== prevState.query) {\n        var scrollablePanels = props.value.core.environment.document.querySelectorAll('.aa-Panel--scrollable');\n        scrollablePanels.forEach(function (scrollablePanel) {\n          if (scrollablePanel.scrollTop !== 0) {\n            scrollablePanel.scrollTop = 0;\n          }\n        });\n      }\n\n      debouncedRender({\n        state: state\n      });\n    };\n\n    return function () {\n      onStateChangeRef.current = undefined;\n    };\n  });\n  runEffect(function () {\n    var onResize = debounce(function () {\n      var previousIsDetached = isDetached.value;\n      isDetached.value = props.value.core.environment.matchMedia(props.value.renderer.detachedMediaQuery).matches;\n\n      if (previousIsDetached !== isDetached.value) {\n        update({});\n      } else {\n        requestAnimationFrame(setPanelPosition);\n      }\n    }, 20);\n    props.value.core.environment.addEventListener('resize', onResize);\n    return function () {\n      props.value.core.environment.removeEventListener('resize', onResize);\n    };\n  });\n  runEffect(function () {\n    if (!isDetached.value) {\n      return function () {};\n    }\n\n    function toggleModalClassname(isActive) {\n      dom.value.detachedContainer.classList.toggle('aa-DetachedContainer--modal', isActive);\n    }\n\n    function onChange(event) {\n      toggleModalClassname(event.matches);\n    }\n\n    var isModalDetachedMql = props.value.core.environment.matchMedia(getComputedStyle(props.value.core.environment.document.documentElement).getPropertyValue('--aa-detached-modal-media-query'));\n    toggleModalClassname(isModalDetachedMql.matches); // Prior to Safari 14, `MediaQueryList` isn't based on `EventTarget`,\n    // so we must use `addListener` and `removeListener` to observe media query lists.\n    // See https://developer.mozilla.org/en-US/docs/Web/API/MediaQueryList/addListener\n\n    var hasModernEventListener = Boolean(isModalDetachedMql.addEventListener);\n    hasModernEventListener ? isModalDetachedMql.addEventListener('change', onChange) : isModalDetachedMql.addListener(onChange);\n    return function () {\n      hasModernEventListener ? isModalDetachedMql.removeEventListener('change', onChange) : isModalDetachedMql.removeListener(onChange);\n    };\n  });\n  runEffect(function () {\n    requestAnimationFrame(setPanelPosition);\n    return function () {};\n  });\n\n  function destroy() {\n    cleanupEffects();\n  }\n\n  function update() {\n    var updatedOptions = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : {};\n    cleanupEffects();\n    optionsRef.current = mergeDeep(props.value.renderer, props.value.core, {\n      initialState: lastStateRef.current\n    }, updatedOptions);\n    runReactives();\n    runEffects();\n    autocomplete.value.refresh().then(function () {\n      scheduleRender(lastStateRef.current);\n    });\n  }\n\n  function setIsModalOpen(value) {\n    requestAnimationFrame(function () {\n      var prevValue = props.value.core.environment.document.body.contains(dom.value.detachedOverlay);\n\n      if (value === prevValue) {\n        return;\n      }\n\n      if (value) {\n        props.value.core.environment.document.body.appendChild(dom.value.detachedOverlay);\n        props.value.core.environment.document.body.classList.add('aa-Detached');\n        dom.value.input.focus();\n      } else {\n        props.value.core.environment.document.body.removeChild(dom.value.detachedOverlay);\n        props.value.core.environment.document.body.classList.remove('aa-Detached');\n        autocomplete.value.setQuery('');\n        autocomplete.value.refresh();\n      }\n    });\n  }\n\n  return _objectSpread(_objectSpread({}, autocompleteScopeApi), {}, {\n    update: update,\n    destroy: destroy\n  });\n}"]},"metadata":{},"sourceType":"module"}