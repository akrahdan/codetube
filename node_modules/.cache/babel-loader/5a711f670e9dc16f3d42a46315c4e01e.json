{"ast":null,"code":"import { createApi, fetchBaseQuery } from \"@reduxjs/toolkit/query/react\";\nimport cookie from \"react-cookies\";\nexport const authApi = createApi({\n  baseQuery: fetchBaseQuery({\n    baseUrl: \"/\",\n    prepareHeaders: (headers, {\n      getState\n    }) => {\n      const csrfToken = cookie.load(\"csrftoken\");\n\n      if (csrfToken) {\n        headers.set(\"X-CSRFToken\", csrfToken);\n      }\n\n      const token = getState().auth.token || localStorage.getItem('token');\n\n      if (token) {\n        headers.set(\"Authorization\", `Token ${token}`);\n      }\n\n      headers.set(\"Content-Type\", \"application/json\");\n      return headers;\n    }\n  }),\n  tagTypes: [\"LoginRequest\", \"SignupRequest\", \"Logout\", \"User\", \"UserResponse\"],\n  endpoints: build => ({\n    login: build.mutation({\n      query: body => ({\n        url: \"auth/login/\",\n        method: \"POST\",\n        body,\n        responseHandler: response => response.json()\n      })\n    }),\n    signup: build.mutation({\n      query: body => ({\n        url: \"auth/signup/\",\n        method: \"POST\",\n        body,\n        responseHandler: response => response.json()\n      })\n    }),\n    logout: build.mutation({\n      query: body => ({\n        url: \"rest-auth/logout/\",\n        method: \"POST\",\n        body,\n        responseHandler: response => response.json()\n      })\n    }),\n    facebookLogin: build.query({\n      query: () => ({\n        url: \"auth/facebook/\",\n        method: \"GET\",\n        responseHandler: response => response.json()\n      })\n    }),\n    googleLogin: build.query({\n      query: () => ({\n        url: \"auth/google/\",\n        method: \"GET\",\n        responseHandler: response => response.json()\n      })\n    }),\n    getCurrentUser: build.query({\n      query: () => ({\n        url: \"rest-auth/user/\",\n        method: \"GET\",\n        responseHandler: response => response.json()\n      })\n    })\n  })\n});\nexport const {\n  getCurrentUser\n} = authApi.endpoints;\nexport const {\n  useLoginMutation,\n  useSignupMutation,\n  useLogoutMutation,\n  useGetCurrentUserQuery\n} = authApi;","map":{"version":3,"sources":["/Users/akrah/Documents/dev/readux/src/codefluent/src/services/auth.ts"],"names":["createApi","fetchBaseQuery","cookie","authApi","baseQuery","baseUrl","prepareHeaders","headers","getState","csrfToken","load","set","token","auth","localStorage","getItem","tagTypes","endpoints","build","login","mutation","query","body","url","method","responseHandler","response","json","signup","logout","facebookLogin","googleLogin","getCurrentUser","useLoginMutation","useSignupMutation","useLogoutMutation","useGetCurrentUserQuery"],"mappings":"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","sourcesContent":["\nimport { createApi, fetchBaseQuery } from \"@reduxjs/toolkit/query/react\";\nimport { head } from \"lodash\";\nimport cookie from \"react-cookies\";\nimport { RootState } from \"store\";\nimport internal from \"stream\";\n\nexport interface LoginRequest {\n  email: string;\n  password: string;\n  csrfmiddlewaretoken:string;\n}\n\nexport interface SignupRequest {\n  email: string;\n  username: string;\n  password1: string;\n  password2: string;\n  csrfmiddlewaretoken:string;\n}\n\nexport interface Token {\n  key: string;\n}\n\nexport interface User {\n  pk:number;\n  email: string;\n  username:string;\n  first_name:string;\n  last_name:string;\n  \n}\n\nexport interface UserResponse {\n  user: User,\n  token: string\n}\n\nexport interface Logout {\n \n  csrfmiddlewaretoken:string;\n}\n\nexport interface LogoutResponse {\n  detail: string;\n}\n\nexport const authApi = createApi({\n  baseQuery: fetchBaseQuery({\n    baseUrl: \"/\",\n    prepareHeaders: (headers, { getState }) => {\n      const csrfToken = cookie.load(\"csrftoken\");\n      \n      \n      if (csrfToken) {\n        headers.set(\"X-CSRFToken\", csrfToken);\n        \n      }\n      const token = (getState() as RootState).auth.token || localStorage.getItem('token');\n      if(token) {\n        headers.set(\"Authorization\", `Token ${token}`)\n      }\n      \n      headers.set(\"Content-Type\", \"application/json\");\n\n      return headers;\n    },\n  }),\n  tagTypes: [\"LoginRequest\", \"SignupRequest\", \"Logout\", \"User\", \"UserResponse\"],\n  endpoints: (build) => ({\n    login: build.mutation<UserResponse, Partial<LoginRequest>>({\n      query: (body) => ({\n        url: \"auth/login/\",\n        method: \"POST\",\n        body,\n        responseHandler: (response) => response.json(),\n      }),\n    }),\n    signup: build.mutation<UserResponse, Partial<SignupRequest>>({\n      query: (body) => ({\n        url: \"auth/signup/\",\n        method: \"POST\",\n        body,\n        responseHandler: (response) => response.json(),\n      }),\n    }),\n    logout: build.mutation<LogoutResponse, Partial<Logout>>({\n      query: (body) => ({\n        url: \"rest-auth/logout/\",\n        method: \"POST\",\n        body,\n        responseHandler: (response) => response.json(),\n      }),\n    }),\n    facebookLogin: build.query<User, void>({\n      query: () => ({\n        url: \"auth/facebook/\",\n        method: \"GET\",\n       \n        responseHandler: (response) => response.json(),\n      }),\n    }),\n\n    googleLogin: build.query<User, void>({\n      query: () => ({\n        url: \"auth/google/\",\n        method: \"GET\",\n       \n        responseHandler: (response) => response.json(),\n      }),\n    }),\n\n    getCurrentUser: build.query<User, void>({\n      query: () => ({\n        url: \"rest-auth/user/\",\n        method: \"GET\",\n       \n        responseHandler: (response) => response.json(),\n      }),\n    }),\n  }),\n});\n\nexport const { getCurrentUser } = authApi.endpoints;\n\nexport const { useLoginMutation, useSignupMutation, useLogoutMutation, useGetCurrentUserQuery,  } = authApi;\n"]},"metadata":{},"sourceType":"module"}