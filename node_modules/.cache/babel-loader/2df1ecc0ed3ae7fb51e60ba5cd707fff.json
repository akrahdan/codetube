{"ast":null,"code":"import _slicedToArray from\"/Users/akrah/Documents/dev/codefluent/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/slicedToArray\";import _taggedTemplateLiteral from\"/Users/akrah/Documents/dev/codefluent/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/taggedTemplateLiteral\";var _templateObject,_templateObject2,_templateObject3,_templateObject4,_templateObject5;import{FlexBox,FormError,Input}from'@codecademy/gamut';import{pxRem,theme}from'@codecademy/gamut-styles';import styled from'@emotion/styled';import React,{useCallback,useRef,useState}from'react';import{Avatar}from'..';import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";var baseSize=75;var smBreakpointSize=120;var StyledAvatar=styled(Avatar)(_templateObject||(_templateObject=_taggedTemplateLiteral([\"\\n  img {\\n    width: \",\";\\n    height: \",\";\\n  }\\n\\n  \",\" {\\n    img {\\n      width: \",\";\\n      height: \",\";\\n    }\\n  }\\n\"])),pxRem(baseSize),pxRem(baseSize),theme.breakpoints.sm,pxRem(smBreakpointSize),pxRem(smBreakpointSize));var ChoosePhotoLabel=styled.label(_templateObject2||(_templateObject2=_taggedTemplateLiteral([\"\\n  padding-top: \",\";\\n  \",\" {\\n    padding-top: \",\";\\n  }\\n\"])),theme.spacing[16],theme.breakpoints.sm,theme.spacing[24]);var ChoosePhotoSpan=styled.span(_templateObject3||(_templateObject3=_taggedTemplateLiteral([\"\\n  color: \",\";\\n  font-weight: \",\";\\n  cursor: pointer;\\n\"])),theme.colors.hyper,theme.fontWeight.title);var HiddenInput=styled(Input)(_templateObject4||(_templateObject4=_taggedTemplateLiteral([\"\\n  display: none;\\n\"])));var StyledFormError=styled(FormError)(_templateObject5||(_templateObject5=_taggedTemplateLiteral([\"\\n  position: initial;\\n  text-align: center;\\n\"])));export var AvatarChooser=function AvatarChooser(_ref){var existingSrc=_ref.src,onImageChanged=_ref.onImageChanged,error=_ref.error,register=_ref.register,_ref$validate=_ref.validate,validate=_ref$validate===void 0?validatePhotoUpload:_ref$validate,_ref$name=_ref.name,name=_ref$name===void 0?'Avatar Photo':_ref$name;var _useState=useState(existingSrc),_useState2=_slicedToArray(_useState,2),imageSrc=_useState2[0],setImageSrc=_useState2[1];var choosePhotoLabelRef=useRef(null);var onChange=useCallback(function(event){var target=event===null||event===void 0?void 0:event.target;var imageFilelist=target===null||target===void 0?void 0:target.files;var imageFile=imageFilelist===null||imageFilelist===void 0?void 0:imageFilelist[0];onImageChanged===null||onImageChanged===void 0?void 0:onImageChanged(imageFilelist);if(imageFile)setImageSrc(URL.createObjectURL(imageFile));},[setImageSrc,onImageChanged]);// Need to simulate Enter and Space keyboard presses to activate the\n// file uploader here since it's not a real button.\nvar onChooseUploadKeyPress=useCallback(function(event){var _choosePhotoLabelRef$;if(event.key==='Enter'||event.key===' ')(_choosePhotoLabelRef$=choosePhotoLabelRef.current)===null||_choosePhotoLabelRef$===void 0?void 0:_choosePhotoLabelRef$.click();},[choosePhotoLabelRef]);return/*#__PURE__*/_jsxs(FlexBox,{alignItems:\"center\",flexDirection:\"column\",justifyContent:\"center\",width:\"fit-content\",maxWidth:pxRem(120),children:[/*#__PURE__*/_jsx(StyledAvatar,{src:imageSrc,disableDropshadow:true,alt:\"Avatar Photo\"}),/*#__PURE__*/_jsx(ChoosePhotoLabel,{ref:choosePhotoLabelRef,htmlFor:\"avatar-chooser\",children:/*#__PURE__*/_jsx(ChoosePhotoSpan,{role:\"button\",tabIndex:0,onKeyPress:onChooseUploadKeyPress,children:\"Choose Photo\"})}),/*#__PURE__*/_jsx(HiddenInput,{type:\"file\",htmlFor:\"avatar-chooser\",name:name,onChange:onChange,ref:register===null||register===void 0?void 0:register({validate:validate,required:false}),\"aria-invalid\":Boolean(error)}),error&&/*#__PURE__*/_jsx(StyledFormError,{children:error})]});};var validatePhotoUpload=function validatePhotoUpload(files){var MAX_FILE_SIZE=5242880;var MAX_FILE_SIZE_IN_MB=5;var file=files===null||files===void 0?void 0:files.item(0);if(!file)return true;var type=file.type,size=file.size;if(!['image/jpeg','image/png'].includes(type))return'Please upload a jpeg or png file.';if(size>MAX_FILE_SIZE)return\"Sorry, we cannot accept files larger than \".concat(MAX_FILE_SIZE_IN_MB,\" MB.\");return true;};","map":{"version":3,"sources":["/Users/akrah/Documents/dev/codefluent/src/components/gamut-overrides/AvatarChooser/index.tsx"],"names":["FlexBox","FormError","Input","pxRem","theme","styled","React","useCallback","useRef","useState","Avatar","baseSize","smBreakpointSize","StyledAvatar","breakpoints","sm","ChoosePhotoLabel","label","spacing","ChoosePhotoSpan","span","colors","hyper","fontWeight","title","HiddenInput","StyledFormError","AvatarChooser","existingSrc","src","onImageChanged","error","register","validate","validatePhotoUpload","name","imageSrc","setImageSrc","choosePhotoLabelRef","onChange","event","target","imageFilelist","files","imageFile","URL","createObjectURL","onChooseUploadKeyPress","key","current","click","required","Boolean","MAX_FILE_SIZE","MAX_FILE_SIZE_IN_MB","file","item","type","size","includes"],"mappings":"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","sourcesContent":["import { FlexBox, FormError, Input } from '@codecademy/gamut';\nimport { pxRem, theme } from '@codecademy/gamut-styles';\nimport styled from '@emotion/styled';\nimport React, { useCallback, useRef, useState } from 'react';\nimport { UseFormMethods, Validate } from 'react-hook-form';\n\nimport { Avatar } from '..';\n\ntype AvatarChooserProps = {\n  src: string;\n  name?: string;\n  register?: UseFormMethods['register'];\n  onImageChanged?: (imageFileList: FileList) => void;\n  validate?: Validate | Record<string, Validate>;\n  error?: string;\n};\n\nconst baseSize = 75;\nconst smBreakpointSize = 120;\n\nconst StyledAvatar = styled(Avatar)`\n  img {\n    width: ${pxRem(baseSize)};\n    height: ${pxRem(baseSize)};\n  }\n\n  ${theme.breakpoints.sm} {\n    img {\n      width: ${pxRem(smBreakpointSize)};\n      height: ${pxRem(smBreakpointSize)};\n    }\n  }\n`;\n\nconst ChoosePhotoLabel = styled.label`\n  padding-top: ${theme.spacing[16]};\n  ${theme.breakpoints.sm} {\n    padding-top: ${theme.spacing[24]};\n  }\n`;\n\nconst ChoosePhotoSpan = styled.span`\n  color: ${theme.colors.hyper};\n  font-weight: ${theme.fontWeight.title};\n  cursor: pointer;\n`;\n\nconst HiddenInput = styled(Input)`\n  display: none;\n`;\n\nconst StyledFormError = styled(FormError)`\n  position: initial;\n  text-align: center;\n`;\n\nexport const AvatarChooser: React.FC<AvatarChooserProps> = ({\n  src: existingSrc,\n  onImageChanged,\n  error,\n  register,\n  validate = validatePhotoUpload,\n  name = 'Avatar Photo',\n}) => {\n  const [imageSrc, setImageSrc] = useState<string>(existingSrc);\n\n  const choosePhotoLabelRef = useRef<HTMLLabelElement>(null);\n\n  const onChange = useCallback(\n    (event: React.FormEvent<HTMLInputElement>) => {\n      const target = event?.target as HTMLInputElement;\n      const imageFilelist = target?.files;\n      const imageFile = imageFilelist?.[0];\n\n      onImageChanged?.(imageFilelist!);\n      if (imageFile) setImageSrc(URL.createObjectURL(imageFile));\n    },\n    [setImageSrc, onImageChanged]\n  );\n\n  // Need to simulate Enter and Space keyboard presses to activate the\n  // file uploader here since it's not a real button.\n  const onChooseUploadKeyPress = useCallback(\n    (event: React.KeyboardEvent) => {\n      if (event.key === 'Enter' || event.key === ' ')\n        choosePhotoLabelRef.current?.click();\n    },\n    [choosePhotoLabelRef]\n  );\n\n  return (\n    <FlexBox\n      alignItems=\"center\"\n      flexDirection=\"column\"\n      justifyContent=\"center\"\n      width=\"fit-content\"\n      maxWidth={pxRem(120)}\n    >\n      <StyledAvatar src={imageSrc} disableDropshadow alt=\"Avatar Photo\" />\n      <ChoosePhotoLabel ref={choosePhotoLabelRef} htmlFor=\"avatar-chooser\">\n        <ChoosePhotoSpan\n          role=\"button\"\n          tabIndex={0}\n          onKeyPress={onChooseUploadKeyPress}\n        >\n          Choose Photo\n        </ChoosePhotoSpan>\n      </ChoosePhotoLabel>\n      <HiddenInput\n        type=\"file\"\n        htmlFor=\"avatar-chooser\"\n        name={name}\n        onChange={onChange}\n        ref={register?.({\n          validate,\n          required: false,\n        })}\n        aria-invalid={Boolean(error)}\n      />\n      {error && <StyledFormError>{error}</StyledFormError>}\n    </FlexBox>\n  );\n};\n\nconst validatePhotoUpload = (files: FileList): boolean | string => {\n  const MAX_FILE_SIZE = 5242880;\n  const MAX_FILE_SIZE_IN_MB = 5;\n\n  const file = files?.item(0);\n  if (!file) return true;\n\n  const { type, size } = file;\n  if (!['image/jpeg', 'image/png'].includes(type))\n    return 'Please upload a jpeg or png file.';\n\n  if (size > MAX_FILE_SIZE)\n    return `Sorry, we cannot accept files larger than ${MAX_FILE_SIZE_IN_MB} MB.`;\n\n  return true;\n};\n"]},"metadata":{},"sourceType":"module"}