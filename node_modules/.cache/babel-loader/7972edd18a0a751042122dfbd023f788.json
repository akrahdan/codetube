{"ast":null,"code":"var _jsxFileName = \"/Users/akrah/Documents/dev/readux/src/codefluent/src/components/AppHeader/useAppHeaderProps.tsx\",\n    _s = $RefreshSig$();\n\nimport { Box } from '@codecademy/gamut';\nimport { AnimatePresence, motion } from 'framer-motion';\nimport React, { useState } from 'react';\nimport { SearchButton } from './Search/SearchButton';\nimport cookie from 'react-cookies';\nimport { store } from 'store';\nimport { useLogoutMutation } from 'services/auth';\nimport { showModal } from 'state/modals/modalSlice';\nimport { useAuth } from 'store/useAuth';\nimport { useHistory } from 'react-router';\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nconst AnimatedPopoverVariants = {\n  enter: {\n    opacity: 1,\n    transition: {\n      duration: 0.2\n    }\n  },\n  exit: {\n    opacity: 0,\n    transition: {\n      duration: 0.2\n    }\n  }\n};\nconst animatedPopoverProps = {\n  initial: 'exit',\n  animate: 'enter',\n  exit: 'exit',\n  variants: AnimatedPopoverVariants\n};\nexport const useAppHeaderProps = () => {\n  _s();\n\n  const [isSearchVisible, setSearchVisible] = useState(false); // const { data: currentUser } = useGetCurrentUserQuery()\n\n  const {\n    user: currentUser\n  } = useAuth();\n  const {\n    push\n  } = useHistory();\n  const [logout, {\n    data: logoutResponse\n  }] = useLogoutMutation();\n  console.log(\"Current: \", currentUser);\n\n  if (logoutResponse && logoutResponse.detail) {\n    localStorage.clear();\n  }\n\n  const [isMobileNotificationsOpen, setIsMobileNotificationsOpen] = useState(false);\n\n  const toggleSearch = () => {\n    setSearchVisible(!isSearchVisible);\n  };\n\n  const toggleMobileNotifications = () => {\n    setIsMobileNotificationsOpen(!isMobileNotificationsOpen);\n  };\n\n  const handleClick = async (event, item) => {\n    if (item.id === \"instructor\") {\n      if (currentUser && currentUser.email) {\n        push();\n      }\n\n      store.dispatch(showModal('login'));\n    }\n\n    if (item.id == \"login\" || item.id == \"signup\") {\n      store.dispatch(showModal(item.id));\n    }\n\n    if (item.id == \"log-out\") {\n      const obj = {\n        csrfmiddlewaretoken: cookie.load('csrftoken')\n      };\n      const result = await logout(obj).unwrap();\n    }\n  };\n\n  const headerProps = currentUser ? {\n    type: 'pro',\n    action: handleClick,\n    user: {\n      avatar: '',\n      displayName: currentUser.first_name ? `${currentUser.first_name} ${currentUser.last_name}` : currentUser.email,\n      isAccountManager: false,\n      isAdmin: false,\n      isCustomerSupport: false,\n      isPaused: false,\n      showProUpgrade: false\n    },\n    search: {\n      onEnable: () => console.log(),\n      onSearch: query => /*#__PURE__*/_jsxDEV(SearchButton, {\n        toggleSearch: toggleSearch\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 104,\n        columnNumber: 36\n      }, this),\n      onTrackingClick: target => console.log()\n    }\n  } : {\n    type: 'anon',\n    action: handleClick,\n    search: {\n      onEnable: () => console.log(),\n      onSearch: query => /*#__PURE__*/_jsxDEV(SearchButton, {\n        toggleSearch: toggleSearch\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 116,\n        columnNumber: 36\n      }, this),\n      onTrackingClick: target => console.log()\n    }\n  };\n\n  const search = /*#__PURE__*/_jsxDEV(Box, {\n    position: \"relative\",\n    zIndex: 15,\n    children: [isSearchVisible && /*#__PURE__*/_jsxDEV(AnimatePresence, {\n      children: [/*#__PURE__*/_jsxDEV(motion.div, { ...animatedPopoverProps\n      }, \"search\", false, {\n        fileName: _jsxFileName,\n        lineNumber: 128,\n        columnNumber: 11\n      }, this), \")\"]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 127,\n      columnNumber: 9\n    }, this), isMobileNotificationsOpen && /*#__PURE__*/_jsxDEV(Box, {\n      display: {\n        _: 'block',\n        md: 'none'\n      },\n      children: /*#__PURE__*/_jsxDEV(AnimatePresence, {\n        children: /*#__PURE__*/_jsxDEV(motion.div, { ...animatedPopoverProps,\n          \"data-testid\": \"header-mobile-notifications-dropdown\"\n        }, \"mobile notifications\", false, {\n          fileName: _jsxFileName,\n          lineNumber: 137,\n          columnNumber: 13\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 136,\n        columnNumber: 11\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 135,\n      columnNumber: 9\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 125,\n    columnNumber: 5\n  }, this);\n\n  return [headerProps, search];\n};\n\n_s(useAppHeaderProps, \"E1N0mMoUYp1kgs0IBI4ESxXSWxs=\", false, function () {\n  return [useAuth, useHistory, useLogoutMutation];\n});","map":{"version":3,"sources":["/Users/akrah/Documents/dev/readux/src/codefluent/src/components/AppHeader/useAppHeaderProps.tsx"],"names":["Box","AnimatePresence","motion","React","useState","SearchButton","cookie","store","useLogoutMutation","showModal","useAuth","useHistory","AnimatedPopoverVariants","enter","opacity","transition","duration","exit","animatedPopoverProps","initial","animate","variants","useAppHeaderProps","isSearchVisible","setSearchVisible","user","currentUser","push","logout","data","logoutResponse","console","log","detail","localStorage","clear","isMobileNotificationsOpen","setIsMobileNotificationsOpen","toggleSearch","toggleMobileNotifications","handleClick","event","item","id","email","dispatch","obj","csrfmiddlewaretoken","load","result","unwrap","headerProps","type","action","avatar","displayName","first_name","last_name","isAccountManager","isAdmin","isCustomerSupport","isPaused","showProUpgrade","search","onEnable","onSearch","query","onTrackingClick","target","_","md"],"mappings":"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","sourcesContent":["import { Box } from '@codecademy/gamut';\nimport type {\n\n  AppHeaderClickHandler,\n  GlobalHeaderProps,\n} from 'components/gamut-overrides';\nimport { AnimatePresence, motion, MotionProps, Variants } from 'framer-motion';\nimport React, { useState } from 'react';\nimport { useSelector } from 'react-redux';\nimport { Search } from './Search';\nimport { MobileSearchBar } from './Search/MobileSearchBar';\nimport { SearchButton } from './Search/SearchButton';\nimport cookie from 'react-cookies';\nimport { store } from 'store';\nimport { setCredentials } from 'state/auth/authSlice';\nimport { Logout, useGetCurrentUserQuery, useLogoutMutation } from 'services/auth';\nimport { showModal, hideModal, hideCurrentModal, signupModal } from 'state/modals/modalSlice';\nimport { useAppDispatch, useAppSelector } from 'store/hooks';\nimport { useAuth } from 'store/useAuth';\nimport { useHistory } from 'react-router';\n\nconst AnimatedPopoverVariants: Variants = {\n  enter: { opacity: 1, transition: { duration: 0.2 } },\n  exit: { opacity: 0, transition: { duration: 0.2 } },\n};\n\nconst animatedPopoverProps: MotionProps = {\n  initial: 'exit',\n  animate: 'enter',\n  exit: 'exit',\n  variants: AnimatedPopoverVariants,\n};\n\nexport const useAppHeaderProps = () => {\n\n\n\n\n  const [isSearchVisible, setSearchVisible] = useState(false);\n  // const { data: currentUser } = useGetCurrentUserQuery()\n  const { user: currentUser } = useAuth()\n  const { push } = useHistory();\n  const [logout, { data: logoutResponse }] = useLogoutMutation()\n  console.log(\"Current: \", currentUser)\n  if (logoutResponse && logoutResponse.detail) {\n    localStorage.clear()\n  }\n\n  const [isMobileNotificationsOpen, setIsMobileNotificationsOpen] = useState(\n    false\n  );\n\n  const toggleSearch = () => {\n\n    setSearchVisible(!isSearchVisible);\n  };\n\n  const toggleMobileNotifications = () => {\n\n    setIsMobileNotificationsOpen(!isMobileNotificationsOpen);\n  };\n\n  const handleClick: AppHeaderClickHandler = async (event, item) => {\n   \n    if(item.id === \"instructor\") {\n      if (currentUser && currentUser.email) {\n        push()\n      }\n      store.dispatch(showModal('login'))\n    }\n    \n    if (item.id == \"login\" || item.id == \"signup\") {\n      store.dispatch(showModal(item.id))\n    }\n    if (item.id == \"log-out\") {\n      const obj: Logout = {\n        csrfmiddlewaretoken: cookie.load('csrftoken')\n      };\n\n     const result = await logout(obj).unwrap();\n    \n    }\n\n  };\n\n\n\n  const headerProps: GlobalHeaderProps = currentUser ? {\n    type: 'pro',\n    action: handleClick,\n    user: {\n      avatar: '',\n      displayName: currentUser.first_name ? `${currentUser.first_name} ${currentUser.last_name}`  : currentUser.email,\n      isAccountManager: false,\n      isAdmin: false,\n      isCustomerSupport: false,\n      isPaused: false,\n      showProUpgrade: false,\n\n\n    },\n    search: {\n      onEnable: () => console.log(),\n      onSearch: (query: string) => <SearchButton toggleSearch={toggleSearch} />,\n      onTrackingClick: (target: string) => console.log()\n\n    }\n\n  } : {\n    type: 'anon',\n\n\n    action: handleClick,\n    search: {\n      onEnable: () => console.log(),\n      onSearch: (query: string) => <SearchButton toggleSearch={toggleSearch} />,\n      onTrackingClick: (target: string) => console.log()\n\n    }\n  };\n\n\n\n  const search = (\n    <Box position=\"relative\" zIndex={15}>\n      {isSearchVisible && (\n        <AnimatePresence>\n          <motion.div key=\"search\" {...animatedPopoverProps}>\n\n          </motion.div>\n          )\n        </AnimatePresence>\n      )}\n      {isMobileNotificationsOpen && (\n        <Box display={{ _: 'block', md: 'none' }}>\n          <AnimatePresence>\n            <motion.div\n              key=\"mobile notifications\"\n              {...animatedPopoverProps}\n              data-testid=\"header-mobile-notifications-dropdown\"\n            >\n\n            </motion.div>\n          </AnimatePresence>\n        </Box>\n      )}\n    </Box>\n  );\n\n  return [headerProps, search] as const;\n};\n"]},"metadata":{},"sourceType":"module"}