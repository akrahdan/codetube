"use strict";
var __importDefault = (this && this.__importDefault) || function (mod) {
    return (mod && mod.__esModule) ? mod : { "default": mod };
};
Object.defineProperty(exports, "__esModule", { value: true });
exports.useMatches = exports.useMatchMedia = void 0;
var react_1 = __importDefault(require("react"));
var exenv_1 = __importDefault(require("exenv"));
var can_use_dom_1 = require("./can-use-dom");
var use_has_mounted_1 = require("./use-has-mounted");
var canUseEventListeners = exenv_1.default.canUseEventListeners;
var noopQueryList = {
    matches: false,
    media: ''
};
function useMatchMedia(query) {
    var hasMounted = use_has_mounted_1.useHasMounted();
    var matcher = react_1.default.useCallback(function () { return (can_use_dom_1.canUseDOM() ? window.matchMedia(query) : noopQueryList); }, [query]);
    var _a = react_1.default.useState(matcher), queryList = _a[0], setQueryList = _a[1];
    var matches = useMatches(queryList);
    react_1.default.useEffect(function () {
        if (!hasMounted)
            return;
        var nextQueryList = matcher();
        setQueryList(nextQueryList);
    }, [hasMounted, matcher]);
    return matches;
}
exports.useMatchMedia = useMatchMedia;
function useMatches(queryList) {
    var _a = react_1.default.useState(queryList.matches), matches = _a[0], setMatches = _a[1];
    react_1.default.useEffect(function () {
        var updateMatches = function () {
            setMatches(queryList.matches);
        };
        if (canUseEventListeners)
            queryList.addListener(updateMatches);
        updateMatches();
        return function () {
            if (canUseEventListeners)
                queryList.removeListener(updateMatches);
        };
    }, [queryList]);
    return matches;
}
exports.useMatches = useMatches;
//# sourceMappingURL=use-match-media.js.map