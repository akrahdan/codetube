import { canUseEventListeners, canUseDOM } from 'exenv';
import React from 'react';
import { usePrevious } from '@pluralsight/ps-design-system-util';
export default function useOnInnerFocus(ref, _a) {
    var onEnter = _a.onEnter, onLeave = _a.onLeave;
    var refContainsActiveElement = React.useCallback(function () {
        if (!canUseDOM || !ref.current)
            return false;
        return ref.current.contains(document.activeElement);
    }, [ref]);
    var _b = React.useState(refContainsActiveElement), activeElInRef = _b[0], setActiveElInRef = _b[1];
    var prevActiveElInRef = usePrevious(activeElInRef);
    var handleFocus = React.useCallback(function () {
        var nextActive = refContainsActiveElement();
        setActiveElInRef(nextActive);
    }, [refContainsActiveElement, setActiveElInRef]);
    React.useEffect(function () {
        if (!exists(activeElInRef) || !exists(prevActiveElInRef))
            return;
        if (prevActiveElInRef === activeElInRef)
            return;
        var entering = !prevActiveElInRef && activeElInRef;
        var leaving = prevActiveElInRef && !activeElInRef;
        if (entering)
            onEnter();
        else if (leaving)
            onLeave();
    }, [activeElInRef, prevActiveElInRef, onEnter, onLeave]);
    React.useEffect(function () {
        if (!canUseEventListeners)
            return;
        document.addEventListener('focus', handleFocus, true);
        return function () {
            document.removeEventListener('focus', handleFocus, true);
        };
    }, [handleFocus]);
}
var exists = function (val) { return typeof val !== 'undefined'; };
//# sourceMappingURL=use-on-inner-focus.js.map