{"version":3,"file":"index.js","sources":["src/browser.js"],"sourcesContent":["export default function focusWithin(document, opts) {\n\tconst className = Object(opts).className;\n\tconst attr = Object(opts).attr || 'focus-within';\n\tconst force = Object(opts).force;\n\tconst lastElements = [];\n\n\ttry {\n\t\tdocument.querySelector(':focus-within');\n\n\t\tif (!force) {\n\t\t\treturn initialize;\n\t\t}\n\t} catch (ignoredError) { /* do nothing and continue */ }\n\n\tfunction onfocuschange() {\n\t\tlet lastElement;\n\n\t\twhile (lastElement = lastElements.pop()) {\n\t\t\tif (attr) {\n\t\t\t\tlastElement.removeAttribute(attr);\n\t\t\t}\n\n\t\t\tif (className) {\n\t\t\t\tlastElement.classList.remove(className);\n\t\t\t}\n\t\t}\n\n\t\tlet activeElement = document.activeElement;\n\n\t\t// only add focus if it has not been added and is not the document element\n\t\tif (!/^(#document|HTML|BODY)$/.test(Object(activeElement).nodeName)) {\n\t\t\twhile (activeElement && activeElement.nodeType === 1) {\n\t\t\t\tif (attr) {\n\t\t\t\t\tactiveElement.setAttribute(attr, '');\n\t\t\t\t}\n\n\t\t\t\tif (className) {\n\t\t\t\t\tactiveElement.classList.add(className);\n\t\t\t\t}\n\n\t\t\t\tlastElements.push(activeElement);\n\n\t\t\t\tactiveElement = activeElement.parentNode;\n\t\t\t}\n\t\t}\n\t}\n\n\tfunction initialize() {\n\t\tdocument.addEventListener('focus', onfocuschange, true);\n\t\tdocument.addEventListener('blur', onfocuschange, true);\n\t}\n\n\t/**\n\t* Callback wrapper for check loaded state\n\t*/\n\t/* eslint-disable */\n\t!function load() {\n\t\tif (/m/.test(document.readyState)) {\n\t\t\tdocument.removeEventListener('readystatechange', load) | initialize();\n\t\t} else {\n\t\t\tdocument.addEventListener('readystatechange', load);\n\t\t}\n\t}()\n\t/* eslint-enable */\n\n\treturn initialize;\n}\n"],"names":["focusWithin","document","opts","className","Object","attr","force","lastElements","querySelector","initialize","ignoredError","onfocuschange","lastElement","pop","removeAttribute","classList","remove","activeElement","test","nodeName","nodeType","setAttribute","add","push","parentNode","addEventListener","load","readyState","removeEventListener"],"mappings":";;AAAe,SAASA,WAAT,CAAqBC,QAArB,EAA+BC,IAA/B,EAAqC;QAC7CC,SAAS,GAAGC,MAAM,CAACF,IAAD,CAAN,CAAaC,SAA/B;QACME,IAAI,GAAGD,MAAM,CAACF,IAAD,CAAN,CAAaG,IAAb,IAAqB,cAAlC;QACMC,KAAK,GAAGF,MAAM,CAACF,IAAD,CAAN,CAAaI,KAA3B;QACMC,YAAY,GAAG,EAArB;;MAEI;IACHN,QAAQ,CAACO,aAAT,CAAuB,eAAvB;;QAEI,CAACF,KAAL,EAAY;aACJG,UAAP;;GAJF,CAME,OAAOC,YAAP,EAAqB;;;;WAEdC,aAAT,GAAyB;QACpBC,WAAJ;;WAEOA,WAAW,GAAGL,YAAY,CAACM,GAAb,EAArB,EAAyC;UACpCR,IAAJ,EAAU;QACTO,WAAW,CAACE,eAAZ,CAA4BT,IAA5B;;;UAGGF,SAAJ,EAAe;QACdS,WAAW,CAACG,SAAZ,CAAsBC,MAAtB,CAA6Bb,SAA7B;;;;QAIEc,aAAa,GAAGhB,QAAQ,CAACgB,aAA7B,CAbwB;;QAgBpB,CAAC,0BAA0BC,IAA1B,CAA+Bd,MAAM,CAACa,aAAD,CAAN,CAAsBE,QAArD,CAAL,EAAqE;aAC7DF,aAAa,IAAIA,aAAa,CAACG,QAAd,KAA2B,CAAnD,EAAsD;YACjDf,IAAJ,EAAU;UACTY,aAAa,CAACI,YAAd,CAA2BhB,IAA3B,EAAiC,EAAjC;;;YAGGF,SAAJ,EAAe;UACdc,aAAa,CAACF,SAAd,CAAwBO,GAAxB,CAA4BnB,SAA5B;;;QAGDI,YAAY,CAACgB,IAAb,CAAkBN,aAAlB;QAEAA,aAAa,GAAGA,aAAa,CAACO,UAA9B;;;;;WAKMf,UAAT,GAAsB;IACrBR,QAAQ,CAACwB,gBAAT,CAA0B,OAA1B,EAAmCd,aAAnC,EAAkD,IAAlD;IACAV,QAAQ,CAACwB,gBAAT,CAA0B,MAA1B,EAAkCd,aAAlC,EAAiD,IAAjD;;;;;;;;;GAOA,SAASe,IAAT,GAAgB;QACZ,IAAIR,IAAJ,CAASjB,QAAQ,CAAC0B,UAAlB,CAAJ,EAAmC;MAClC1B,QAAQ,CAAC2B,mBAAT,CAA6B,kBAA7B,EAAiDF,IAAjD,IAAyDjB,UAAU,EAAnE;KADD,MAEO;MACNR,QAAQ,CAACwB,gBAAT,CAA0B,kBAA1B,EAA8CC,IAA9C;;GAJD,EAAD;;;SASOjB,UAAP;;;;;"}